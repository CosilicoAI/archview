{
  "generated": "2025-12-28T19:57:45.347Z",
  "count": 239,
  "documents": [
    {
      "citation": "20 USC 1070a",
      "title": "Expected Family Contribution (EFC) Calculation",
      "text": "The amount of the Federal Pell Grant for a student...shall be—\n(A) the cost of attendance..., minus\n(B) the expected family contribution...",
      "code": "variable efc:\n  imports:\n    - 26/62/a#adjusted_gross_income\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Expected Family Contribution\"\n  description: \"Family's expected contribution toward education costs per EFC formula\"\n  syntax: python\n  formula: |\n    formula_type = pell_grant_formula\n    # Check for automatic zero EFC\n    qualifies_auto_zero = adjusted_gross_income <= efc_params.automatic_zero\n    # Apply automatic zero if eligible (Formula B never gets auto-zero)\n    if qualifies_auto_zero and (formula_type != B):\n        result = 0\n    elif formula_type == A:\n        result = max(0, head_contribution + dependent_contribution)\n    else:\n        result = max(0, head_contribution)\n    return result\n  default: 0\n\n\n\n# ---- Merged from award.rac ----\n\n# 20 USC 1070a - Pell Grant Award Calculation\n#\n\ntext: \"\"\"\nThe amount of the Federal Pell Grant for a student...shall be—\n(A) the cost of attendance..., minus\n(B) the expected family contribution...\n\"\"\"\nvariable award:\n  imports:\n    - 20/1070a/eligibility#pell_grant_eligible\n    - 20/1070a/efc#pell_grant_efc\n    - 20/1070a/sai#pell_grant_sai\n    - 20/1070a/eligibility#pell_grant_eligibility_type\n    - 20/1070a/calculation_method#uses_efc\n    - 20/1070a/calculation_method#uses_sai\n    - 20/1070a/inputs#cost_of_attendance\n    - 20/1070a/inputs#months_in_school\n    - 20/1070a/parameters#amount as amount_params\n    - 20/1070a/parameters#enrollment as enrollment_params\n    - 20/1070a/efc#head_contribution\n    - 20/1070a/efc#dependent_contribution\n    - 20/1070a/eligibility#pell_grant_formula\n    - 20/1070a/eligibility#pell_grant_eligibility_type\n    - 20/1070a/parameters#sai.limits#sai_limits\n    - 20/1070a/award#calculation_method\n    - 20/1070a/award#calculation_method\n    - 20/1070a/parameters#enrollment.months_in_school_year#months_in_year\n  entity: Person\n  period: Year\n  dtype: Integer\n  unit: \"months\"\n  label: \"Months Enrolled in School Year\"\n  description: \"Number of months student is enrolled during the academic year\"\n  syntax: python\n  formula: |\n    coa = cost_of_attendance\n    months = months_in_school\n    efc = pell_grant_efc\n    sai = pell_grant_sai\n    eligibility_type = pell_grant_eligibility_type\n    # Determine which contribution methodology applies\n    use_efc = uses_efc\n    use_sai = uses_sai\n    # Select applicable contribution\n    if use_efc:\n        contribution = efc\n    else:\n        contribution = sai\n    # Calculate raw award (COA minus contribution)\n    raw_award = coa - contribution\n    # Apply minimum threshold: if below min, no award\n    min_award = amount_params.min\n    max_award = amount_params.max\n    months_in_year = enrollment_params.months_in_school_year\n    # Award must be at least minimum to be disbursed\n    above_minimum = raw_award >= min_award\n    # EFC methodology: prorate by months and cap\n    if above_minimum:\n        efc_award = raw_award * (months / months_in_year)\n    else:\n        efc_award = 0\n    # SAI methodology: Use eligibility type\n    if eligibility_type == INELIGIBLE:\n        sai_award = 0\n    elif eligibility_type == MAXIMUM:\n        sai_award = max_award\n    elif above_minimum:\n        sai_award = raw_award\n    else:\n        sai_award = 0\n    # Select final award based on methodology\n    if use_efc:\n        uncapped_award = efc_award\n    else:\n        uncapped_award = sai_award\n    # Cap at maximum and COA\n    final_cap = min(coa, max_award)\n    return min(final_cap, max(0, uncapped_award))\n  default: 9\n\n\n# ---- Merged from dependent_contribution.rac ----\n\n# Dependent Student Contribution\n#\nvariable dependent_contribution:\n  imports:\n    - 20/1091/student_income#student_income\n    - 20/1091/student_assets#student_assets\n    - 20/1070a/formula_type#pell_grant_formula\n    - 20/1070a/simplified_applies#simplified_formula_applies\n    - 20/1070a/head_contribution#head_available_income\n    - 20/1070a/dependent_other_allowances#dependent_other_allowances\n    - 20/1070a/parameters#dependent as dependent_params\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Dependent Student Contribution\"\n  description: \"Dependent student's contribution from income and assets for Formula A\"\n  syntax: python\n  formula: |\n    formula_type = pell_grant_formula\n    # Only applies to Formula A (dependent students)\n    if formula_type != A: return 0\n    # Income Protection Allowance\n    ipa = dependent_params.ipa\n    # Additional allowance from negative parent available income\n    parent_income_allowance = max(0, -head_available_income)\n    # Total allowances\n    total_allowances = ipa + parent_income_allowance + dependent_other_allowances\n    # Available income calculation\n    income = student_income\n    available_income = (income - total_allowances) * dependent_params.income_assessment_rate\n    # Asset contribution (zero if simplified formula applies)\n    assets = student_assets\n    use_assets = not simplified_formula_applies\n    asset_contribution = assets * dependent_params.asset_assessment_rate * use_assets\n    # Total contribution\n    return available_income + asset_contribution\n  default: 0\n\n\n# ---- Merged from eligibility.rac ----\n\n# 20 USC 1070a & 1091 - Pell Grant Eligibility\n#\n\ntext: \"\"\"\nA student shall be eligible to receive a Federal Pell Grant for an\nacademic year if the student-\n(1) has a high school diploma or equivalent...\n(2) is enrolled or accepted for enrollment...\n(3) is maintaining satisfactory academic progress...\n(4) is not in default on a Federal student loan...\n(5) is a citizen, national, or eligible noncitizen...\n\"\"\"\nvariable eligibility:\n  imports:\n    - 20/1091/enrollment_status#is_enrolled_in_higher_education\n    - 20/1091/high_school_diploma#has_high_school_credential\n    - 20/1091/citizenship#is_citizen_or_eligible_noncitizen\n    - 20/1091/satisfactory_progress#maintains_satisfactory_progress\n    - 20/1091/default_status#is_not_in_default\n    - 20/1091/social_security#has_valid_ssn\n    - 20/1070a/sai#pell_grant_sai\n    - 20/1070a/efc#pell_grant_efc\n    - 20/1070a/parameters#sai.limits#sai_limits\n    - 20/1070a/parameters#amount\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Pell Grant Eligible\"\n  description: \"Whether person meets all eligibility requirements for Federal Pell Grant per 20 USC 1070a and 1091\"\n  syntax: python\n  formula: |\n    # Basic statutory requirements per 20 USC 1091\n    meets_enrollment = is_enrolled_in_higher_education\n    meets_credential = has_high_school_credential\n    meets_citizenship = is_citizen_or_eligible_noncitizen\n    meets_progress = maintains_satisfactory_progress\n    meets_default = is_not_in_default\n    meets_ssn = has_valid_ssn\n    # All basic eligibility requirements must be met\n    basic_eligible = (\n    meets_enrollment &\n    meets_credential &\n    meets_citizenship &\n    meets_progress &\n    meets_default &\n    meets_ssn\n    )\n    # Income-based eligibility: EFC or SAI must result in non-zero award\n    # Under SAI: ineligible if SAI > cost_of_attendance - min_award\n    # Simplified: Check if any Pell would be awarded\n    income_eligible = (pell_grant_efc >= 0) | (pell_grant_sai <= sai_limits.max_sai)\n    return basic_eligible & income_eligible\n  default: false\n\n\n# ---- Merged from eligibility_type.rac ----\n\n# 20 USC 1070a - Pell Grant Eligibility Type (SAI Methodology)\n#\nvariable eligibility_type:\n  imports:\n    - 26/62/a#adjusted_gross_income\n    - 42/9902/fpg#federal_poverty_guidelines as fpg\n    - 20/1070a/parameters#sai.fpg_fraction#fpg_fraction\n    - 26/1#is_tax_unit_head\n    - 26/1#filing_status\n    - 20/1070a/dependent_status#is_dependent_student\n  entity: Person\n  period: Year\n  dtype: Enum[\"INELIGIBLE\",\n  label: \"Pell Grant Eligibility Type\"\n  description: \"Eligibility category under SAI methodology determining maximum, minimum, or calculated award\"\n  syntax: python\n  formula: |\n    agi = adjusted_gross_income\n    poverty_line = fpg\n    # Determine household type for threshold lookup\n    is_dependent = is_dependent_student\n    is_single = (filing_status == SINGLE) | (filing_status == HEAD_OF_HOUSEHOLD)\n    # Get applicable FPG fraction thresholds\n    if is_dependent and is_single:\n    max_threshold = fpg_fraction.max_pell_limits.DEPENDENT_SINGLE\n    min_threshold = fpg_fraction.min_pell_limits.DEPENDENT_SINGLE\n    else if is_dependent and (not is_single):\n    max_threshold = fpg_fraction.max_pell_limits.DEPENDENT_NOT_SINGLE\n    min_threshold = fpg_fraction.min_pell_limits.DEPENDENT_NOT_SINGLE\n    else if (not is_dependent) and is_single:\n    max_threshold = fpg_fraction.max_pell_limits.INDEPENDENT_SINGLE\n    min_threshold = fpg_fraction.min_pell_limits.INDEPENDENT_SINGLE\n    else:\n    max_threshold = fpg_fraction.max_pell_limits.INDEPENDENT_NOT_SINGLE\n    min_threshold = fpg_fraction.min_pell_limits.INDEPENDENT_NOT_SINGLE\n    # Calculate AGI as fraction of FPG\n    agi_to_fpg = agi / poverty_line\n    # Determine eligibility type\n    if agi_to_fpg > min_threshold: return INELIGIBLE\n    if agi_to_fpg <= max_threshold: return MAXIMUM\n    if agi_to_fpg <= min_threshold: return MINIMUM\n    return CALCULATED\n  default: INELIGIBLE\n\n\n# ---- Merged from formula_type.rac ----\n\n# 20 USC 1070a - Pell Grant Formula Type\n#\nvariable formula_type:\n  imports:\n    - 26/152/dependent_status#is_tax_unit_dependent\n    - 26/151/has_dependents#has_dependents\n    - 26/1#is_tax_unit_head\n    - 26/1#is_tax_unit_spouse\n  entity: Person\n  period: Year\n  dtype: Enum[\"A\",\n  label: \"Pell Grant Formula Type\"\n  description: \"EFC formula type based on dependency status per THE EFC FORMULA guide\"\n  syntax: python\n  formula: |\n    # For Pell purposes:\n    # A = Dependent student (uses parent financials)\n    # B = Independent without dependents (single independent)\n    # C = Independent with dependents (independent parent/supporting family)\n    is_head_or_spouse = is_tax_unit_head | is_tax_unit_spouse\n    unit_has_dependents = has_dependents\n    # Determine formula type\n    if unit_has_dependents and (not is_head_or_spouse): return A\n    if (not unit_has_dependents) and is_head_or_spouse: return B\n    # Independent with dependents = Formula C\n    return C\n  default: A\n\n\n# ---- Merged from head_contribution.rac ----\n\n# Parent or Independent Student Contribution\n#\nvariable head_contribution:\n  imports:\n    - 26/62/a#adjusted_gross_income\n    - 20/1091/head_assets#total_assets\n    - 20/1070a/head_allowances#head_allowances\n    - 20/1070a/formula_type#pell_grant_formula\n    - 20/1070a/simplified_applies#simplified_formula_applies\n    - 20/1091/dependents_in_college#dependents_in_college\n    - 20/1070a/parameters#head as head_params\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Head Contribution to EFC\"\n  description: \"Parent or independent student contribution based on income and assets\"\n  syntax: python\n  formula: |\n    formula_type = pell_grant_formula\n    income = adjusted_gross_income\n    assets = total_assets\n    allowances = head_allowances\n    in_college = max(1, dependents_in_college)\n    # Step 1: Calculate available income\n    income_rate = head_params.income_assessment_rate[formula_type]\n    available_income = (income - allowances) * income_rate\n    # Step 2: Calculate asset contribution (zero if simplified formula applies)\n    asset_rate = head_params.asset_assessment_rate[formula_type]\n    use_assets = not simplified_formula_applies\n    asset_contribution = assets * asset_rate * use_assets\n    # Step 3: Adjusted Available Income (AAI)\n    aai = available_income + asset_contribution\n    # Step 4: Calculate contribution using marginal rate schedule\n    positive_contribution = head_params.marginal_rate.calc(aai)\n    # Step 5: Handle negative AAI\n    negative_contribution = max(aai * head_params.negative_rate, head_params.min_contribution)\n    # Step 6: Select based on AAI sign (use multiplication by boolean)\n    is_positive = aai >= 0\n    total_contribution = positive_contribution * is_positive + negative_contribution * (not is_positive)\n    # Step 7: For Formula B return AAI directly, others divide by number in college\n    if formula_type == B: return aai\n    return total_contribution / in_college\n  default: 0\n\n\n# ---- Merged from simplified_applies.rac ----\n\n# Simplified EFC Formula Eligibility\n#\nvariable simplified_applies:\n  imports:\n    - 26/62/a#adjusted_gross_income\n    - 42/1382/receives_ssi#receives_ssi\n    - 7/2013/receives_snap#receives_snap\n    - 42/601/receives_tanf#receives_tanf\n    - 42/1758/receives_free_lunch#receives_free_lunch\n    - 42/1396/receives_medicaid#receives_medicaid\n    - 20/1070a/parameters#efc.simplified#simplified_params\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Simplified EFC Formula Applies\"\n  description: \"Whether family qualifies for simplified EFC formula (assets excluded)\"\n  syntax: python\n  formula: |\n    # Income eligibility\n    income_eligible = adjusted_gross_income < simplified_params.income_limit\n    # Benefit receipt (any qualifying benefit)\n    receives_benefits = (\n    receives_ssi |\n    receives_snap |\n    receives_tanf |\n    receives_free_lunch |\n    receives_medicaid\n    )\n    # Formula availability (phased out 2024+)\n    formula_available = simplified_params.applies\n    return income_eligible & receives_benefits & formula_available\n  default: false",
      "path": "cosilico-us/statute/20/1070a/efc.rac"
    },
    {
      "citation": "24 CFR 5.609 & 5.611 - Annual Income and Deductions",
      "title": "Annual Income and Deductions",
      "text": "",
      "code": "variable hcv_annual_income:\n  entity: Household\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Annual Income\"\n  description: \"Total annual gross income from all counted sources per 24 CFR 5.609(b)\"\n  syntax: python\n  formula: |\n    # Sum of all counted income sources for all family members\n    # Major categories per 24 CFR 5.609(b)\n    total = employment_income + self_employment_income\n    total = total + social_security_benefits + ssi_benefits\n    total = total + pension_income + annuity_income\n    total = total + alimony_received + child_support_received\n    total = total + regular_gifts_received + unemployment_benefits\n    total = total + disability_benefits + workers_compensation\n    total = total + welfare_assistance + interest_income\n    total = total + dividend_income + net_rental_income\n    return total\n  default: 0\n\nvariable hcv_dependent_deduction:\n  entity: Household\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Dependent Deduction\"\n  description: \"Deduction of $480 per dependent family member\"\n  syntax: python\n  formula: |\n    # Dependent = family member (other than head, spouse, or co-head) who is:\n    # - Under 18 years old, OR\n    # - A person with a disability, OR\n    # - A full-time student\n    deduction_per_dependent = parameter(gov.hud.hcv.deductions.dependent)\n    return num_dependents * deduction_per_dependent\n  default: 0\n\nvariable hcv_elderly_disabled_deduction:\n  entity: Household\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Elderly/Disabled Deduction\"\n  description: \"Deduction of $400 for elderly (62+) or disabled head/spouse\"\n  syntax: python\n  formula: |\n    # Elderly family: head, spouse, or sole member is 62 years or older\n    # Disabled family: head, spouse, or sole member has a disability\n    deduction_amount = parameter(gov.hud.hcv.deductions.elderly_disabled)\n    if has_elderly_disabled:\n        return deduction_amount\n    else:\n        return 0\n  default: 0\n\nvariable hcv_childcare_deduction:\n  entity: Household\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Child Care Deduction\"\n  description: \"Deduction for child care expenses enabling work or education\"\n  syntax: python\n  formula: |\n    # Deduction cannot exceed:\n    # (1) Amount earned by family member enabled to work, OR\n    # (2) Cost of care for children under 13 (or disabled children)\n    # For modeling, we take the lesser of:\n    # - Actual childcare expenses\n    # - Employment income of the person enabled to work\n    max_deduction = employment_income  # Cannot exceed income earned\n    return min(childcare_expense, max_deduction)\n  default: 0\n\nvariable hcv_medical_deduction:\n  entity: Household\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Medical Expense Deduction\"\n  description: \"Deduction for medical expenses over 3% of income (elderly/disabled only)\"\n  syntax: python\n  formula: |\n    # Only available to elderly or disabled families\n    if not has_elderly_disabled:\n        return 0\n    # Threshold = 3% of annual gross income\n    threshold_rate = parameter(gov.hud.hcv.deductions.medical.threshold_rate)\n    threshold = hcv_annual_income * threshold_rate\n    # Deduction = expenses over threshold\n    excess = medical_expense - threshold\n    return max(0, excess)\n  default: 0\n\nvariable hcv_disability_assistance_deduction:\n  entity: Household\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Disability Assistance Deduction\"\n  description: \"Deduction for disability assistance expenses enabling work\"\n  syntax: python\n  formula: |\n    # Only available if:\n    # (1) Expense is for attendant care or auxiliary apparatus\n    # (2) Expense enables a family member to work\n    # (3) Cannot exceed income earned by person enabled to work\n    if not has_disability_expense:\n        return 0\n    # Deduction limited to income earned\n    return min(disability_assistance_expense, employment_income)\n  default: 0\n\nvariable hcv_total_deductions:\n  entity: Household\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Total Deductions\"\n  description: \"Sum of all allowable deductions from annual income\"\n  syntax: python\n  formula: |\n    total = hcv_dependent_deduction + hcv_elderly_disabled_deduction\n    total = total + hcv_childcare_deduction + hcv_medical_deduction\n    total = total + hcv_disability_assistance_deduction\n    return total\n  default: 0\n\nvariable hcv_annual_adjusted_income:\n  entity: Household\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Annual Adjusted Income\"\n  description: \"Annual income minus all allowable deductions\"\n  syntax: python\n  formula: |\n    adjusted = hcv_annual_income - hcv_total_deductions\n    return max(0, adjusted)\n  default: 0\n\nvariable hcv_monthly_adjusted_income:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Monthly Adjusted Income\"\n  description: \"Monthly adjusted income for TTP calculation\"\n  formula: return hcv_annual_adjusted_income / months_per_year\n  default: 0",
      "path": "cosilico-us/statute/42/1437f/b.rac"
    },
    {
      "citation": "26 USC § 1402(a) - Net Earnings from Self-Employment",
      "title": "Net Earnings from Self-Employment",
      "text": "The term 'net earnings from self-employment' means the gross income derived\nby an individual from any trade or business carried on by such individual,\nless the deductions allowed by this subtitle which are attributable to such\ntrade or business...",
      "code": "variable net_earnings_self_employment:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net Earnings from Self-Employment\"\n  description: \"Gross self-employment income less attributable business deductions\"",
      "path": "cosilico-us/statute/26/1402/a.rac"
    },
    {
      "citation": "26 USC § 164(a) - Deduction for Taxes",
      "title": "Deduction for Taxes",
      "text": "There shall be allowed as a deduction taxes paid or accrued within the\ntaxable year...",
      "code": "variable deductible_taxes:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Local Benefit Assessments\"\n  description: \"Special assessments for streets, sidewalks, etc. - NOT deductible under § 164(a)(5)\"\n  syntax: python\n  formula: |\n    # Total real property minus foreign portion\n    return real_property_tax - foreign_real_property_tax\n  default: false",
      "path": "cosilico-us/statute/26/164/a.rac"
    },
    {
      "citation": "26 USC § 164(b)(6) - SALT Deduction Cap Parameters",
      "title": "SALT Deduction Cap Parameters",
      "text": "(A) IN GENERAL.—In the case of an individual, the aggregate amount of taxes\ntaken into account under subsection (a) for any taxable year shall not exceed\n$10,000 ($5,000 in the case of a married individual filing a separate return).",
      "code": "# 26 USC § 164(b)(6) - SALT Deduction Cap Parameters\n#\n# Reference: Tax Cuts and Jobs Act of 2017 (P.L. 115-97)\n# Effective: Tax years 2018-2025\n\ntext: \"\"\"\n(A) IN GENERAL.—In the case of an individual, the aggregate amount of taxes\ntaken into account under subsection (a) for any taxable year shall not exceed\n$10,000 ($5,000 in the case of a married individual filing a separate return).\n\"\"\"\n\nparameter salt_cap:\n  description: \"SALT deduction cap for most filing statuses\"\n  unit: USD\n  values:\n    2026-01-01: .inf\n    2018-01-01: 10000\n    1900-01-01: .inf\n\nparameter salt_cap_married_separate:\n  description: \"SALT deduction cap for married filing separately\"\n  unit: USD\n  values:\n    2026-01-01: .inf\n    2018-01-01: 5000\n    1900-01-01: .inf",
      "path": "cosilico-us/statute/26/164/b/6.rac"
    },
    {
      "citation": "26 USC § 199A(a) - Qualified Business Income Deduction",
      "title": "Qualified Business Income Deduction",
      "text": "(a) ALLOWANCE OF DEDUCTION.—In the case of a taxpayer other than a corporation,\nthere shall be allowed as a deduction for any taxable year an amount equal\nto the lesser of—\n(1) the combined qualified business income amount of the taxpayer, or\n(2) an amount equal to 20 percent of the excess (if any) of—\n(A) the taxable income of the taxpayer for the taxable year, over\n(B) the sum of any net capital gain (as defined in section 1(h)), plus the\naggregate amount of the qualified cooperative dividends, of the taxpayer\nfor the taxable year.",
      "code": "variable qbi_deduction:\n  imports:\n    - 26/1#filing_status\n    - 26/199A/c#net_qualified_business_income\n    - 26/199A/d#is_sstb\n    - 26/199A/d#sstb_qbi\n    - 26/199A/d#sstb_w2_wages\n    - 26/199A/d#sstb_ubia\n    - 26/199A/d#qbi_applicable_percentage\n    - 26/199A/b#qbi_w2_wages\n    - 26/199A/b#qbi_ubia\n    - 26/199A/b#qbi_w2_wage_limit\n    - 26/199A/b#is_above_qbi_threshold\n    - 26/199A/b#is_in_qbi_phaseout\n    - 26/199A/b#is_above_qbi_phaseout\n    - 26/199A/b#qbi_reduction_ratio\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Qualified Business Income Deduction\"\n  description: \"Section 199A deduction for pass-through income per 26 USC § 199A(a)\"\n  syntax: python\n  formula: |\n    # § 199A(a)(2): 20% of (taxable income - net capital gain - qualified coop dividends)\n    ordinary_income = taxable_income - net_capital_gain - qualified_coop_dividends\n    return max(0, ordinary_income * qbi_deduction_rate)\n  default: 0",
      "path": "cosilico-us/statute/26/199A/a.rac"
    },
    {
      "citation": "26 USC § 199A(b) - W-2 Wage and Property Limitations",
      "title": "W-2 Wage and Property Limitations",
      "text": "(b) COMBINED QUALIFIED BUSINESS INCOME AMOUNT.—For purposes of this section—\n(1) IN GENERAL.—The term 'combined qualified business income amount' means,\nwith respect to any taxable year, an amount equal to—\n(A) the sum of the amounts determined under paragraph (2) for each qualified\ntrade or business carried on by the taxpayer, plus\n(B) 20 percent of the aggregate amount of the qualified REIT dividends and\nqualified publicly traded partnership income of the taxpayer for the\ntaxable year.\n(2) DETERMINATION OF DEDUCTIBLE AMOUNT FOR EACH TRADE OR BUSINESS.—The amount\ndetermined under this paragraph with respect to any qualified trade or\nbusiness is the lesser of—\n(A) 20 percent of the taxpayer's qualified business income with respect to\nthe qualified trade or business, or\n(B) the greater of—\n(i) 50 percent of the W-2 wages with respect to the qualified trade or\nbusiness, or\n(ii) the sum of 25 percent of the W-2 wages with respect to the qualified\ntrade or business, plus 2.5 percent of the unadjusted basis immediately\nafter acquisition of all qualified property...",
      "code": "variable w2_wage_limitation:\n  imports:\n    - 26/1#filing_status\n    - 26/199A/c#net_qualified_business_income\n    - 26/199A/d#is_sstb\n    - 26/199A/d#sstb_qbi\n    - 26/199A/d#qbi_applicable_percentage\n  entity: TaxUnit\n  period: Year\n  dtype: Rate\n  unit: \"USD\"\n  label: \"QBI W-2 Limitation Reduction Ratio\"\n  description: \"Ratio for phasing in W-2 wage limitation per 26 USC § 199A(b)(3)(B)\"\n  syntax: python\n  formula: |\n    # Greater of:\n    # (i) 50% of W-2 wages, OR\n    # (ii) 25% of W-2 wages + 2.5% of UBIA\n    wages_only = qbi_w2_wages * w2_wage_limit_rate\n    wages_plus_property = (qbi_w2_wages * w2_wage_property_rate) + (qbi_ubia * ubia_rate)\n    return max(wages_only, wages_plus_property)\n  default: 0",
      "path": "cosilico-us/statute/26/199A/b.rac"
    },
    {
      "citation": "26 USC § 199A(c) - Qualified Business Income",
      "title": "Qualified Business Income",
      "text": "(c) QUALIFIED BUSINESS INCOME.—For purposes of this section—\n(1) IN GENERAL.—The term 'qualified business income' means, for any taxable\nyear, the net amount of qualified items of income, gain, deduction, and\nloss with respect to any qualified trade or business of the taxpayer.\n(2) CARRYOVER OF LOSSES.—If the net amount of qualified business income from\nall qualified trades or businesses during any taxable year is less than\nzero, such amount shall be treated as a loss from a qualified trade or\nbusiness in the succeeding taxable year.\n(3) QUALIFIED ITEMS OF INCOME, GAIN, DEDUCTION, AND LOSS.—For purposes of this\nsubsection—\n(A) IN GENERAL.—The term 'qualified items of income, gain, deduction, and loss'\nmeans items of income, gain, deduction, and loss to the extent such items\nare—\n(i) effectively connected with the conduct of a trade or business within the\nUnited States (within the meaning of section 864(c), determined by\nsubstituting 'qualified trade or business (within the meaning of section\n199A)' for 'nonresident alien individual or a foreign corporation')...\n(4) TREATMENT OF REASONABLE COMPENSATION AND GUARANTEED PAYMENTS.—Qualified\nbusiness income shall not include—\n(A) reasonable compensation paid to the taxpayer by any qualified trade or\nbusiness of the taxpayer for services rendered with respect to the trade\nor business,\n(B) any guaranteed payment described in section 707(c) paid to a partner for\nservices rendered with respect to the trade or business...",
      "code": "variable qualified_business_income:\n  imports: [26/1402/a/self_employment_income#self_employment_income]\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net Qualified Business Income\"\n  description: \"QBI after loss carryforward adjustment\"\n  formula: return max(0, qualified_business_income - qualified_business_income_loss_carryforward)\n  default: 0",
      "path": "cosilico-us/statute/26/199A/c.rac"
    },
    {
      "citation": "26 USC § 199A(d) - Specified Service Trade or Business (SSTB)",
      "title": "Specified Service Trade or Business (SSTB)",
      "text": "(d) QUALIFIED TRADE OR BUSINESS.—For purposes of this section—\n(1) IN GENERAL.—The term 'qualified trade or business' means any trade or\nbusiness other than—\n(A) a specified service trade or business, or\n(B) the trade or business of performing services as an employee.\n(2) SPECIFIED SERVICE TRADE OR BUSINESS.—The term 'specified service trade or\nbusiness' means any trade or business—\n(A) which is described in section 1202(e)(3)(A) (applied without regard to\nthe words 'engineering, architecture,') or which would be so described\nif the term 'employees or owners' were substituted for 'employees' therein, or\n(B) which involves the performance of services that consist of investing and\ninvestment management, trading, or dealing in securities (as defined in\nsection 475(c)(2)), partnership interests, or commodities (as defined in\nsection 475(e)(2)).\n(3) EXCEPTION FOR SPECIFIED SERVICE BUSINESSES FOR TAXPAYERS WITH TAXABLE INCOME\nNOT EXCEEDING THRESHOLD AMOUNT.—\n(A) IN GENERAL.—If, for any taxable year, the taxable income of any taxpayer is\nless than the sum of the threshold amount plus $50,000 ($100,000 in the case\nof a joint return), then—\n(i) any specified service trade or business of the taxpayer shall not fail to\nbe treated as a qualified trade or business due to paragraph (1)(A), but\n(ii) only the applicable percentage of qualified items of income, gain,\ndeduction, or loss, and the W-2 wages and the unadjusted basis immediately\nafter acquisition of qualified property, of the taxpayer allocable to such\nspecified service trade or business shall be taken into account...",
      "code": "variable sstb:\n  imports:\n    - 26/1#filing_status\n  entity: TaxUnit\n  period: Year\n  dtype: Rate\n  unit: \"percent\"\n  label: \"QBI Applicable Percentage\"\n  description: \"Phase-in percentage for SSTB income per 26 USC § 199A(d)(3)\"\n  syntax: python\n  formula: |\n    # Get threshold based on filing status\n    is_joint_or_surviving = filing_status == JOINT or filing_status == SURVIVING_SPOUSE\n    threshold = threshold_joint if is_joint_or_surviving else threshold_single\n    phaseout_range = phaseout_range_joint if is_joint_or_surviving else phaseout_range_single\n    # If below threshold, 100% applies\n    if taxable_income <= threshold:\n        return 1.0\n    # If above threshold + phaseout range, 0% applies (SSTB gets no deduction)\n    phaseout_end = threshold + phaseout_range\n    if taxable_income >= phaseout_end:\n        return 0.0\n    # Within phaseout range: linear reduction\n    # Applicable % = 1 - (taxable_income - threshold) / phaseout_range\n    excess = taxable_income - threshold\n    return 1.0 - (excess / phaseout_range)\n  default: 0",
      "path": "cosilico-us/statute/26/199A/d.rac"
    },
    {
      "citation": "26 USC § 2(b) - Head of Household",
      "title": "Head of Household",
      "text": "",
      "code": "variable is_head_of_household:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Head of Household Filing Status\"\n  description: |\n    Determines if taxpayer qualifies for head of household filing status\n    per 26 USC § 2(b). Requires being unmarried and maintaining a household\n    for a qualifying person for more than half the taxable year.\n  syntax: python\n  formula: |\n    # Per § 2(b)(1): Must not be married at close of taxable year\n    if is_married:\n      return False\n\n    # Per § 2(b)(1)(A): Must maintain household as home for qualifying person\n    # Qualifying person is either:\n    # - A qualifying child per § 152(c), or\n    # - A qualifying relative per § 152(d) who is related by blood\n    #\n    # Simplified: Has at least one dependent who lived in household\n    has_qualifying_person = num_dependents > 0\n\n    # Per § 2(b)(1): Must pay more than half the cost of maintaining household\n    # Simplified: Assumed true if has qualifying person\n    maintains_household = has_qualifying_person\n\n    return maintains_household\n  default: False\n\nvariable filing_status:\n  imports: [26/2/b#is_head_of_household]\n  entity: TaxUnit\n  period: Year\n  dtype: String\n  label: \"Filing Status\"\n  description: |\n    Taxpayer filing status per 26 USC § 1 and § 2.\n    One of: SINGLE, JOINT, HEAD_OF_HOUSEHOLD, SEPARATE, WIDOW\n  syntax: python\n  formula: |\n    # Check statuses in order of precedence\n    if is_married and files_jointly:\n      return JOINT\n    if is_married and not files_jointly:\n      return SEPARATE\n    # Per § 2(a): Surviving spouse status for 2 years after death\n    if is_surviving_spouse:\n      return WIDOW\n    # Per § 2(b): Head of household\n    if is_head_of_household:\n      return HEAD_OF_HOUSEHOLD\n    # Default: single\n    return SINGLE\n  default: SINGLE\n\n# Tests per § 2(b) requirements\ntests:\n  - name: \"Single with child qualifies as HOH\"\n    inputs:\n      is_married: False\n      num_dependents: 1\n    expect:\n      is_head_of_household: True\n      filing_status: HEAD_OF_HOUSEHOLD\n\n  - name: \"Single without dependents is SINGLE\"\n    inputs:\n      is_married: False\n      num_dependents: 0\n    expect:\n      is_head_of_household: False\n      filing_status: SINGLE\n\n  - name: \"Married with children is not HOH\"\n    inputs:\n      is_married: True\n      files_jointly: True\n      num_dependents: 2\n    expect:\n      is_head_of_household: False\n      filing_status: JOINT\n\n  - name: \"Single with multiple dependents is HOH\"\n    inputs:\n      is_married: False\n      num_dependents: 3\n    expect:\n      is_head_of_household: True\n      filing_status: HEAD_OF_HOUSEHOLD",
      "path": "cosilico-us/statute/26/2/b.rac"
    },
    {
      "citation": "26 USC § 25A - Education Credits (Validation Version)",
      "title": "Education Credits (Validation Version)",
      "text": "",
      "code": "variable education_credits_validation:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Education Credit\"\n  description: \"Total education credit claimed per 26 USC § 25A\"\n  syntax: python\n  formula: |\n    # 100% of first $2,000 + 25% of next $2,000 = max $2,500\n    expenses = aoc_qualified_expenses\n    first_tier = min(expenses, aoc_first_tier_limit) * aoc_first_tier_rate\n    second_tier_expenses = max(0, min(expenses, aoc_second_tier_limit) - aoc_first_tier_limit)\n    second_tier = second_tier_expenses * aoc_second_tier_rate\n    return first_tier + second_tier",
      "path": "cosilico-us/statute/26/25A.rac"
    },
    {
      "citation": "26 USC § 25A(a) - Allowance of Credit",
      "title": "Allowance of Credit",
      "text": "In the case of an individual, there shall be allowed as a credit against\nthe tax imposed by this chapter for the taxable year the amount equal to\nthe sum of—\n(1) the American Opportunity Tax Credit, plus\n(2) the Lifetime Learning Credit.",
      "code": "variable education_credits:\n  imports:\n    - 26/62/a#adjusted_gross_income\n    - 26/1#tax_liability_before_credits\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Education Credit\"\n  description: \"Total education credit claimed (nonrefundable + refundable) per 26 USC § 25A\"\n  formula: return american_opportunity_credit + lifetime_learning_credit\n  default: 0",
      "path": "cosilico-us/statute/26/25A/a.rac"
    },
    {
      "citation": "26 USC § 25A(b) - American Opportunity Credit",
      "title": "American Opportunity Credit",
      "text": "(1) Per student credit - A credit... equal to the sum of—\n(A) 100 percent of so much of the qualified tuition and related expenses\npaid by the taxpayer during the taxable year (for education furnished\nto the eligible student during any academic period beginning in such\ntaxable year) as does not exceed $2,000, plus\n(B) 25 percent of such expenses so paid as exceeds $2,000 but does not\nexceed $4,000.",
      "code": "variable aoc:\n  imports:\n    - 26/1#filing_status\n    - 26/62/a#adjusted_gross_income\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Nonrefundable AOC\"\n  description: \"60% nonrefundable portion of AOC\"\n  syntax: python\n  formula: |\n    # Step 1: Calculate credit based on qualified expenses\n    # 100% of first $2,000 + 25% of next $2,000\n    first_tier = min(aoc_qualified_expenses, first_tier_limit) * first_tier_rate\n    second_tier_expenses = max(0, min(aoc_qualified_expenses, second_tier_limit) - first_tier_limit)\n    second_tier = second_tier_expenses * second_tier_rate\n    return first_tier + second_tier\n  default: 0",
      "path": "cosilico-us/statute/26/25A/b/aoc.rac"
    },
    {
      "citation": "26 USC § 25A(c) - Lifetime Learning Credit",
      "title": "Lifetime Learning Credit",
      "text": "(1) Per taxpayer credit - ... an amount equal to 20 percent of so much\nof the qualified tuition and related expenses paid by the taxpayer\nduring the taxable year (for education furnished during any academic\nperiod beginning in such taxable year) as does not exceed $10,000.",
      "code": "variable llc:\n  imports:\n    - 26/1#filing_status\n    - 26/62/a#adjusted_gross_income\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Lifetime Learning Credit\"\n  description: \"Lifetime Learning Credit after phaseout per 26 USC § 25A(c)\"\n  syntax: python\n  formula: |\n    # Sum all qualified expenses for students not claiming AOC\n    # Note: Cannot claim both AOC and LLC for same student\n    # Filter to non-AOC students, then sum their expenses\n    non_aoc_expenses = members.llc_qualified_expenses * (not members.is_aoc_eligible_student)\n    return sum(members, non_aoc_expenses)\n  default: 0",
      "path": "cosilico-us/statute/26/25A/c/llc.rac"
    },
    {
      "citation": "26 USC § 55(b)(1) - AMT Tax Rates",
      "title": "AMT Tax Rates",
      "text": "(b) Tentative minimum tax\n(1) Amount of tentative tax\n(A) In general\nThe tentative minimum tax for the taxable year is the sum of—\n(i) 26 percent of so much of the taxable excess as does not exceed $232,600, plus\n(ii) 28 percent of so much of the taxable excess as exceeds $232,600.",
      "code": "# 26 USC § 55(b)(1) - AMT Tax Rates\n#\n# Reference: IRC Section 55(b)(1)\n\ntext: \"\"\"\n(b) Tentative minimum tax\n(1) Amount of tentative tax\n(A) In general\nThe tentative minimum tax for the taxable year is the sum of—\n(i) 26 percent of so much of the taxable excess as does not exceed $232,600, plus\n(ii) 28 percent of so much of the taxable excess as exceeds $232,600.\n\"\"\"\n\nparameter amt_rate_low:\n  description: \"AMT rate for income up to bracket threshold\"\n  unit: rate\n  values:\n    2018-01-01: 0.26\n\nparameter amt_rate_high:\n  description: \"AMT rate for income above bracket threshold\"\n  unit: rate\n  values:\n    2018-01-01: 0.28",
      "path": "cosilico-us/statute/26/55/b/1.rac"
    },
    {
      "citation": "26 USC § 55(b)(3) - AMT Bracket Threshold",
      "title": "AMT Bracket Threshold",
      "text": "The threshold amount for the 28% rate bracket, adjusted for inflation.\nFor 2024: $232,600 for joint filers, $116,300 for single and MFS.",
      "code": "# 26 USC § 55(b)(3) - AMT Bracket Threshold\n#\n# Reference: IRC Section 55(b)(1)(A)\n# Threshold adjusted annually for inflation\n\ntext: \"\"\"\nThe threshold amount for the 28% rate bracket, adjusted for inflation.\nFor 2024: $232,600 for joint filers, $116,300 for single and MFS.\n\"\"\"\n\n# Base TCJA values (2018) - indexed annually\n# Current values in IRS guidance files\n\nparameter amt_bracket_joint:\n  description: \"AMT 28% bracket threshold for married filing jointly\"\n  unit: \"USD\"\n  indexed_by: statute/26/55/d/4\n  values:\n    2018-01-01: 191100\n\nparameter amt_bracket_single:\n  description: \"AMT 28% bracket threshold for single filers\"\n  unit: \"USD\"\n  indexed_by: statute/26/55/d/4\n  values:\n    2018-01-01: 95550\n\nparameter amt_bracket_married_separate:\n  description: \"AMT 28% bracket threshold for married filing separately\"\n  unit: \"USD\"\n  indexed_by: statute/26/55/d/4\n  values:\n    2018-01-01: 95550",
      "path": "cosilico-us/statute/26/55/b/3.rac"
    },
    {
      "citation": "26 USC § 55(d)(1) - AMT Exemption Amounts",
      "title": "AMT Exemption Amounts",
      "text": "(d) Exemption amount\n(1) In general\nThe term \"exemption amount\" means—\n(A) in the case of a joint return or a surviving spouse, $133,300,\n(B) in the case of an individual who is not a married individual, $85,700, and\n(C) in the case of a married individual filing a separate return, $66,650.",
      "code": "# 26 USC § 55(d)(1) - AMT Exemption Amounts\n#\n# Reference: IRC Section 55(d)\n# Adjusted annually for inflation\n\ntext: \"\"\"\n(d) Exemption amount\n(1) In general\nThe term \"exemption amount\" means—\n(A) in the case of a joint return or a surviving spouse, $133,300,\n(B) in the case of an individual who is not a married individual, $85,700, and\n(C) in the case of a married individual filing a separate return, $66,650.\n\"\"\"\n\n# Base TCJA values (2018) - indexed annually\n# Current values in IRS guidance files\nparameter exemption_joint:\n  description: \"AMT exemption for married filing jointly\"\n  unit: \"USD\"\n  indexed_by: statute/26/55/d/4\n  values:\n    2018-01-01: 109400\n\nparameter exemption_single:\n  description: \"AMT exemption for single filers\"\n  unit: \"USD\"\n  indexed_by: statute/26/55/d/4\n  values:\n    2018-01-01: 70300\n\nparameter exemption_married_separate:\n  description: \"AMT exemption for married filing separately\"\n  unit: \"USD\"\n  indexed_by: statute/26/55/d/4\n  values:\n    2018-01-01: 54700",
      "path": "cosilico-us/statute/26/55/d/1.rac"
    },
    {
      "citation": "26 USC § 55(d)(2) - AMT Phaseout",
      "title": "AMT Phaseout",
      "text": "(2) Phase-out of exemption amount\nThe exemption amount of any taxpayer shall be reduced (but not below zero)\nby an amount equal to 25 percent of the amount by which the alternative\nminimum taxable income of the taxpayer exceeds the threshold amount.",
      "code": "# 26 USC § 55(d)(2) - AMT Phaseout\n#\n# Reference: IRC Section 55(d)(2)\n# Phaseout threshold adjusted annually for inflation\n\ntext: \"\"\"\n(2) Phase-out of exemption amount\nThe exemption amount of any taxpayer shall be reduced (but not below zero)\nby an amount equal to 25 percent of the amount by which the alternative\nminimum taxable income of the taxpayer exceeds the threshold amount.\n\"\"\"\n\n# Base TCJA values (2018) - indexed annually\n# Current values in IRS guidance files\n\nparameter phaseout_threshold_joint:\n  description: \"AMT phaseout threshold for married filing jointly\"\n  unit: \"USD\"\n  indexed_by: statute/26/55/d/4\n  values:\n    2018-01-01: 1000000\n\nparameter phaseout_threshold_single:\n  description: \"AMT phaseout threshold for single filers\"\n  unit: \"USD\"\n  indexed_by: statute/26/55/d/4\n  values:\n    2018-01-01: 500000\n\nparameter phaseout_threshold_married_separate:\n  description: \"AMT phaseout threshold for married filing separately\"\n  unit: \"USD\"\n  indexed_by: statute/26/55/d/4\n  values:\n    2018-01-01: 500000\n\n# Statutory rate - not indexed\nparameter phaseout_rate:\n  description: \"AMT exemption phaseout rate\"\n  unit: rate\n  values:\n    2018-01-01: 0.25",
      "path": "cosilico-us/statute/26/55/d/2.rac"
    },
    {
      "citation": "26 USC § 61(a)(1) - Compensation for Services",
      "title": "Compensation for Services",
      "text": "",
      "code": "variable wages:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: USD\n  label: Wages\n  description: Compensation for services as an employee\n\nvariable salaries:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: USD\n  label: Salaries\n  description: Fixed periodic compensation for services as an employee\n\nvariable tips:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: USD\n  label: Tips\n  description: Gratuities received for services",
      "path": "cosilico-us/statute/26/61/a/1.rac"
    },
    {
      "citation": "26 USC § 61(a)(10) - Pensions",
      "title": "Pensions",
      "text": "",
      "code": "variable pension_income:\n  imports:\n    - 26/402/a#taxable_401k_distribution\n    - 26/402/a#net_taxable_distribution\n    - 26/408/d#taxable_ira_distribution\n    - 26/408A/d#taxable_roth_distribution\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: USD\n  label: Gross Pension Distributions\n  description: Gross distributions before rollover exclusions\n  syntax: python\n  formula: |\n    # Employer plans (401k, 403b, pension) - net of rollovers\n    employer_plan_income = net_taxable_distribution\n    # Traditional IRA distributions\n    traditional_ira_income = taxable_ira_distribution\n    # Roth IRA non-qualified earnings (contributions come out tax-free)\n    roth_ira_income = taxable_roth_distribution\n    return employer_plan_income + traditional_ira_income + roth_ira_income",
      "path": "cosilico-us/statute/26/61/a/10.rac"
    },
    {
      "citation": "26 USC § 61(a)(3) - Gains Derived from Dealings in Property",
      "title": "Gains Derived from Dealings in Property",
      "text": "",
      "code": "variable gains_from_property:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: USD\n  label: Gains from Property\n  description: Gains derived from dealings in property including capital gains",
      "path": "cosilico-us/statute/26/61/a/3.rac"
    },
    {
      "citation": "26 USC § 61(a)(4) - Interest",
      "title": "Interest",
      "text": "",
      "code": "variable interest_income:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: USD\n  label: Interest Income\n  description: Taxable interest income",
      "path": "cosilico-us/statute/26/61/a/4.rac"
    },
    {
      "citation": "26 USC § 61(a)(7) - Dividends",
      "title": "Dividends",
      "text": "",
      "code": "variable dividend_income:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: USD\n  label: Dividend Income\n  description: Dividend income including qualified and ordinary dividends",
      "path": "cosilico-us/statute/26/61/a/7.rac"
    },
    {
      "citation": "26 USC § 63(c) - Standard Deduction",
      "title": "Standard Deduction",
      "text": "",
      "code": "variable standard_deduction_standalone:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Standard Deduction\"\n  description: \"Total standard deduction including basic and additional amounts per 26 USC 63\"\n  syntax: python\n  formula: |\n    # 63(c)(2): Basic standard deduction based on filing status\n    # Use JOINT since that's what the validation passes in for married couples\n    if filing_status == JOINT:\n        basic = basic_joint\n    elif filing_status == HEAD_OF_HOUSEHOLD:\n        basic = basic_head_of_household\n    else:\n        basic = basic_single\n    # 63(c)(5): Dependents get limited deduction (compute unconditionally)\n    dep_deduction = min(dependent_minimum + earned_income + dependent_earned_addon, basic)\n    dep_deduction = max(dependent_minimum, dep_deduction)\n    # Select basic based on dependent status (vectorized)\n    basic_final = basic * (1 - is_dependent) + dep_deduction * is_dependent\n    # 63(f): Additional amounts - simplified using JOINT = married\n    # JOINT filers use married amounts, others use unmarried\n    aged_married = additional_aged_married * (max_age >= aged_threshold)\n    aged_unmarried = additional_aged_unmarried * (max_age >= aged_threshold)\n    blind_married = additional_blind_married * any_blind\n    blind_unmarried = additional_blind_unmarried * any_blind\n    # Select additional based on filing status\n    is_joint = (filing_status == JOINT)\n    additional = (aged_married + blind_married) * is_joint + (aged_unmarried + blind_unmarried) * (1 - is_joint)\n    # 63(c)(6): Ineligible filers get zero\n    total = (basic_final + additional) * (1 - is_ineligible_for_standard_deduction)\n    return total\n  default: 0\n\nvariable standard_deduction:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  syntax: python\n  formula: |\n    # Section 63(c)(5): Use dependent limitation if applicable\n    if is_dependent:\n        basic = dependent_standard_deduction\n    else:\n        basic = basic_standard_deduction\n    # Section 63(c)(6): Ineligible filers get 0, others get basic + additional\n    if is_ineligible_for_standard_deduction:\n        result = 0\n    else:\n        result = basic + additional_standard_deduction\n    return result",
      "path": "cosilico-us/statute/26/63/c.rac"
    },
    {
      "citation": "26 USC §103 - Interest on State and Local Bonds",
      "title": "Interest on State and Local Bonds",
      "text": "(a) Exclusion.—Gross income does not include interest on any State or\nlocal bond.\n§32(i)(2)(B): \"tax-exempt interest received or accrued during the taxable\nyear\".",
      "code": "variable tax_exempt_interest:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Tax-Exempt Interest Income\"\n  description: \"Interest from state and local bonds excluded from gross income under 26 USC §103, but counted for EITC investment income test\"",
      "path": "cosilico-us/statute/26/103.rac"
    },
    {
      "citation": "26 USC §1222(11) - Capital Gain Net Income",
      "title": "Capital Gain Net Income",
      "text": "The term 'capital gain net income' means the excess of the gains from\nsales or exchanges of capital assets over the losses from such sales\nor exchanges.",
      "code": "variable capital_gain_net_income:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Capital Gain Net Income\"\n  description: \"Net capital gains (gains minus losses) per 26 USC §1222(11), counted for EITC investment income test\"",
      "path": "cosilico-us/statute/26/1222/11.rac"
    },
    {
      "citation": "26 USC §152(c) - Qualifying Child",
      "title": "Qualifying Child",
      "text": "(c) Qualifying child.—For purposes of this section—\n(1) In general.—The term 'qualifying child' means, with respect to any\ntaxpayer for any taxable year, an individual—\n(A) who bears a relationship to the taxpayer described in paragraph (2),\n(B) who has the same principal place of abode as the taxpayer for more\nthan one-half of such taxable year,\n(C) who meets the age requirements of paragraph (3), and\n(D) who has not provided over one-half of such individual's own support\nfor the calendar year in which the taxable year of the taxpayer begins.",
      "code": "variable is_qualifying_child:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Is Qualifying Child under §152(c)\"\n  description: \"Meets all requirements of 26 USC §152(c)\"\n  syntax: python\n  formula: |\n    # (A) has not attained the age of 19 as of the close of the calendar year\n    under_19 = age < age_limit_general\n    # (B) is a student who has not attained the age of 24\n    student_under_24 = is_student and age < age_limit_student\n    # (C) is permanently and totally disabled at any time during such calendar year\n    disabled = is_permanently_disabled\n    return under_19 or student_under_24 or disabled",
      "path": "cosilico-us/statute/26/152/c.rac"
    },
    {
      "citation": "26 USC §32(a)(2)(A) - Initial Credit Amount (Phase-In)",
      "title": "Initial Credit Amount (Phase-In)",
      "text": "The amount determined under paragraph (1) for any taxable year is the\ncredit percentage of so much of the taxpayer's earned income for such\ntaxable year as does not exceed the earned income amount.",
      "code": "variable initial_credit_amount:\n  imports:\n    - 26/32/c/2/A#earned_income\n    - 26/32/b/1#credit_percentage\n    - 26/32/c/3/A#num_qualifying_children\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"EITC Phase-In Amount\"\n  description: \"Credit percentage of earned income up to the earned income amount per 26 USC §32(a)(2)(A)\"\n  syntax: python\n  formula: |\n    # Get parameters indexed by number of qualifying children\n    rate = credit_percentage[num_qualifying_children]\n    cap = earned_income_amount[num_qualifying_children]\n    # Credit = rate × min(earned_income, cap)\n    return rate * min(earned_income, cap)",
      "path": "cosilico-us/statute/26/32/a/2/A.rac"
    },
    {
      "citation": "26 USC §32(a)(2)(B) - Credit Reduction Amount (Phase-Out)",
      "title": "Credit Reduction Amount (Phase-Out)",
      "text": "The amount determined under subparagraph (A) shall be reduced (but not\nbelow zero) by the phaseout percentage of so much of the greater of—\n(i) the adjusted gross income, or\n(ii) the earned income,\nof the taxpayer for the taxable year as exceeds the phaseout amount.",
      "code": "variable credit_reduction_amount:\n  imports:\n    - 26/32/c/2/A#earned_income\n    - 26/62/a#adjusted_gross_income\n    - 26/1#filing_status\n    - 26/32/b/1#phaseout_percentage\n    - 26/32/c/3/A#num_qualifying_children\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"EITC Phase-Out Reduction\"\n  description: \"Reduction of credit based on income exceeding phaseout threshold per 26 USC §32(a)(2)(B)\"\n  syntax: python\n  formula: |\n    # Use the greater of AGI or earned income\n    income = max(adjusted_gross_income, earned_income)\n    # Get parameters indexed by number of qualifying children\n    rate = phaseout_percentage[num_qualifying_children]\n    threshold = phaseout_amount[num_qualifying_children]\n    # Joint filers get higher threshold per 32(b)(2)(B)\n    if filing_status == JOINT:\n        adjusted_threshold = threshold + joint_return_adjustment\n    else:\n        adjusted_threshold = threshold\n    # Reduction = rate × (income - threshold), but not below zero\n    return max(0, rate * (income - adjusted_threshold))",
      "path": "cosilico-us/statute/26/32/a/2/B.rac"
    },
    {
      "citation": "26 USC §32(b)(1) - Credit Percentage",
      "title": "Credit Percentage",
      "text": "",
      "code": "variable credit_percentage:\n  entity: TaxUnit\n  period: Year\n  dtype: Rate\n\n# 26 USC §32(b)(1) - Phaseout Percentage\nvariable phaseout_percentage:\n  entity: TaxUnit\n  period: Year\n  dtype: Rate",
      "path": "cosilico-us/statute/26/32/b/1.rac"
    },
    {
      "citation": "26 USC §32(b)(2)(A) - AGI Limit",
      "title": "AGI Limit",
      "text": "",
      "code": "variable agi_limit:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n\n# 26 USC §32(b)(2)(A) - Earned Income Amount\nvariable earned_income_amount:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n\n# 26 USC §32(b)(2)(A) - Phaseout Amount\nvariable phaseout_amount:\n  entity: TaxUnit\n  period: Year\n  dtype: Money",
      "path": "cosilico-us/statute/26/32/b/2/A.rac"
    },
    {
      "citation": "26 USC §32(b)(2)(B) - Joint Return Adjustment",
      "title": "Joint Return Adjustment",
      "text": "",
      "code": "variable joint_return_adjustment:\n  entity: TaxUnit\n  period: Year\n  dtype: Money",
      "path": "cosilico-us/statute/26/32/b/2/B.rac"
    },
    {
      "citation": "26 USC §32(c)(1)(A)(ii) - Eligible Individual Without Qualifying Children",
      "title": "Eligible Individual Without Qualifying Children",
      "text": "The term 'eligible individual' means—\n(ii) in the case of an individual who has no qualifying children, an\nindividual who—\n(I) has attained age 25 but not attained age 65 before the close\nof the taxable year,\n(II) was not a dependent of another taxpayer for any taxable year\nbeginning in the same calendar year, and\n(III) has a principal place of abode in the United States for more\nthan one-half of such taxable year.",
      "code": "variable meets_no_child_requirements:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Meets Childless EITC Requirements\"\n  description: \"Whether individual meets age, dependency, and abode requirements for childless EITC per 26 USC §32(c)(1)(A)(ii)\"\n  syntax: python\n  formula: |\n    # (I) Age requirement: at least 25 but under 65\n    meets_age = (age >= min_age) and (age < max_age)\n    # (II) Not a dependent of another taxpayer\n    not_dependent = not is_dependent_of_another\n    # (III) Principal place of abode in US for more than half the year\n    us_abode = has_us_principal_abode\n    return meets_age and not_dependent and us_abode",
      "path": "cosilico-us/statute/26/32/c/1/A/ii.rac"
    },
    {
      "citation": "26 USC §32(c)(1)(B) - Ineligibility as Qualifying Child",
      "title": "Ineligibility as Qualifying Child",
      "text": "An individual shall not be treated as an eligible individual for a taxable\nyear if such individual is a qualifying child of another taxpayer for such\ntaxable year.",
      "code": "variable is_qualifying_child_of_other:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Is Qualifying Child of Another Taxpayer\"\n  description: \"Whether taxpayer could be claimed as qualifying child of another, disqualifying them from EITC per 26 USC §32(c)(1)(B)\"",
      "path": "cosilico-us/statute/26/32/c/1/B.rac"
    },
    {
      "citation": "26 USC §32(c)(1)(C) - Foreign Earned Income Disqualification",
      "title": "Foreign Earned Income Disqualification",
      "text": "No credit shall be allowed under this section to an individual who has\nelected to exclude any amount from gross income under section 911.",
      "code": "variable has_foreign_earned_income:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Has Form 2555 Foreign Earned Income Exclusion\"\n  description: \"Whether taxpayer has elected foreign earned income exclusion under 26 USC §911, disqualifying from EITC per 26 USC §32(c)(1)(C)\"",
      "path": "cosilico-us/statute/26/32/c/1/C.rac"
    },
    {
      "citation": "26 USC §32(c)(1)(D) - Nonresident Alien Disqualification",
      "title": "Nonresident Alien Disqualification",
      "text": "No credit shall be allowed under this section to—\n(i) any nonresident alien individual for any portion of the taxable year\nduring which such individual is a nonresident alien, or\n(ii) any individual who is a nonresident alien at any time during the\ntaxable year, unless such individual elects to be treated as a\nresident of the United States for purposes of this chapter for\nsuch taxable year.",
      "code": "variable is_nonresident_alien:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Is Nonresident Alien\"\n  description: \"Whether taxpayer is a nonresident alien not electing US tax treatment, disqualifying from EITC per 26 USC §32(c)(1)(D)\"",
      "path": "cosilico-us/statute/26/32/c/1/D.rac"
    },
    {
      "citation": "26 USC §32(c)(1)(E)(i) - Identification Requirement for Taxpayer",
      "title": "Identification Requirement for Taxpayer",
      "text": "No credit shall be allowed under this section unless the taxpayer\n(and, if the taxpayer is married, the taxpayer's spouse) includes a\nvalid identification number on the return of tax for the taxable year.",
      "code": "variable missing_taxpayer_tin:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Missing Taxpayer SSN for EITC\"\n  description: \"Whether taxpayer lacks a valid SSN for work, disqualifying from EITC per 26 USC §32(c)(1)(E)(i) and §32(m)\"",
      "path": "cosilico-us/statute/26/32/c/1/E/i.rac"
    },
    {
      "citation": "26 USC §32(c)(1)(E)(ii) - Identification Requirement for Spouse",
      "title": "Identification Requirement for Spouse",
      "text": "No credit shall be allowed under this section unless the taxpayer\n(and, if the taxpayer is married, the taxpayer's spouse) includes a\nvalid identification number on the return of tax for the taxable year.",
      "code": "variable missing_spouse_tin:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Missing Spouse SSN for EITC\"\n  description: \"Whether taxpayer's spouse lacks a valid SSN for work when filing jointly, disqualifying from EITC per 26 USC §32(c)(1)(E)(ii) and §32(m)\"",
      "path": "cosilico-us/statute/26/32/c/1/E/ii.rac"
    },
    {
      "citation": "26 USC §32(c)(2)(A) - Earned Income Definition",
      "title": "Earned Income Definition",
      "text": "The term 'earned income' means—\n(i) wages, salaries, tips, and other employee compensation, but only\nif such amounts are includible in gross income for the taxable year, plus\n(ii) the amount of the taxpayer's net earnings from self-employment for\nthe taxable year (within the meaning of section 1402(a)), but such\nnet earnings shall be determined with regard to the deduction allowed\nto the taxpayer by section 164(f).",
      "code": "variable earned_income:\n  imports:\n    - 26/1402/a#net_earnings_self_employment\n    - 26/164/f#se_tax_deduction\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Earned Income\"\n  description: \"Wages, salaries, tips, and net self-employment income per 26 USC §32(c)(2)(A)\"\n  syntax: python\n  formula: |\n    # Employee compensation\n    employee_compensation = wages + salaries + tips\n    # Self-employment income (with §164(f) deduction applied)\n    self_employment = net_earnings_self_employment - se_tax_deduction\n    return employee_compensation + max(0, self_employment)",
      "path": "cosilico-us/statute/26/32/c/2/A.rac"
    },
    {
      "citation": "26 USC §32(c)(3)(A) - Qualifying Child",
      "title": "Qualifying Child",
      "text": "The term 'qualifying child' means a qualifying child of the taxpayer\n(as defined in section 152(c), determined without regard to paragraph\n(1)(D) thereof and section 152(e)).",
      "code": "variable num_qualifying_children:\n  imports:\n    - 26/152/c#is_qualifying_child\n    - 26/32/c/3/B#child_is_married_filing_joint\n    - 26/32/c/3/C#child_meets_place_of_abode\n    - 26/32/c/3/D/i#child_has_valid_tin\n  entity: TaxUnit\n  period: Year\n  dtype: Count\n  label: \"Number of Qualifying Children (uncapped)\"\n  description: \"Actual count of qualifying children, not capped at 3\"\n  syntax: python\n  formula: |\n    # Count children who meet all EITC-specific requirements\n    count = person.count(\n        is_qualifying_child\n        and not child_is_married_filing_joint\n        and child_meets_place_of_abode\n        and child_has_valid_tin\n    )\n    # For EITC parameter lookup, 3+ children use the same rates\n    return min(count, 3)",
      "path": "cosilico-us/statute/26/32/c/3/A.rac"
    },
    {
      "citation": "26 USC §32(c)(3)(B) - Married child filing joint return",
      "title": "Married child filing joint return",
      "text": "",
      "code": "variable child_is_married_filing_joint:\n  entity: Person\n  period: Year\n  dtype: Boolean",
      "path": "cosilico-us/statute/26/32/c/3/B.rac"
    },
    {
      "citation": "26 USC §32(c)(3)(C) - Place of abode requirement",
      "title": "Place of abode requirement",
      "text": "",
      "code": "variable child_meets_place_of_abode:\n  entity: Person\n  period: Year\n  dtype: Boolean",
      "path": "cosilico-us/statute/26/32/c/3/C.rac"
    },
    {
      "citation": "26 USC §32(c)(3)(D)(i) - TIN requirement for qualifying child",
      "title": "TIN requirement for qualifying child",
      "text": "",
      "code": "variable child_has_valid_tin:\n  entity: Person\n  period: Year\n  dtype: Boolean",
      "path": "cosilico-us/statute/26/32/c/3/D/i.rac"
    },
    {
      "citation": "26 USC §32(i)(1) - Disqualified Income Limit",
      "title": "Disqualified Income Limit",
      "text": "No credit shall be allowed under subsection (a) for the taxable year if\nthe aggregate amount of disqualified income of the taxpayer for the taxable\nyear exceeds $10,000.",
      "code": "variable disqualified_income_limit:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n\n# 26 USC §32(i)(1) - Denial of Credit for Excessive Investment Income\n#\n\ntext: \"\"\"\nNo credit shall be allowed under subsection (a) for the taxable year if\nthe aggregate amount of disqualified income of the taxpayer for the taxable\nyear exceeds $10,000.\n\"\"\"\nvariable has_excessive_investment_income:\n  imports:\n    - 26/103#tax_exempt_interest\n    - 26/32/i/2/C#net_rent_royalty_income\n    - 26/1222/11#capital_gain_net_income\n    - 26/32/i/2/E#net_passive_income\n    - 26/32/i/1#disqualified_income_limit\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  unit: \"USD\"\n  label: \"Disqualified by Investment Income\"\n  description: \"Whether investment income exceeds the limit per 26 USC §32(i)(1)\"\n  syntax: python\n  formula: |\n    disqualified_income = (\n        interest_income                # §32(i)(2)(A)\n        + dividend_income              # §32(i)(2)(A)\n        + tax_exempt_interest          # §32(i)(2)(B)\n        + net_rent_royalty_income      # §32(i)(2)(C)\n        + capital_gain_net_income      # §32(i)(2)(D)\n        + net_passive_income           # §32(i)(2)(E)\n    )\n    return disqualified_income > disqualified_income_limit",
      "path": "cosilico-us/statute/26/32/i/1.rac"
    },
    {
      "citation": "26 USC §32(i)(2)(C) - Net Rent and Royalty Income",
      "title": "Net Rent and Royalty Income",
      "text": "The term 'disqualified income' means—\n(C) the net income or loss from rents or royalties which is not derived\nin the ordinary course of a trade or business",
      "code": "variable net_rent_royalty_income:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net Rent and Royalty Income\"\n  description: \"Passive rental and royalty income not from trade or business, counted for EITC investment income test per 26 USC §32(i)(2)(C)\"",
      "path": "cosilico-us/statute/26/32/i/2/C.rac"
    },
    {
      "citation": "26 USC §32(i)(2)(E) - Net Passive Income",
      "title": "Net Passive Income",
      "text": "The term 'disqualified income' means—\n(E) the net income or loss from a passive activity (within the meaning\nof section 469).",
      "code": "variable net_passive_income:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net Passive Activity Income\"\n  description: \"Income from passive activities under 26 USC §469, counted for EITC investment income test per 26 USC §32(i)(2)(E)\"",
      "path": "cosilico-us/statute/26/32/i/2/E.rac"
    },
    {
      "citation": "26 USC §62 - Adjusted Gross Income Defined",
      "title": "Adjusted Gross Income Defined",
      "text": "(a) General Rule.—For purposes of this subtitle, the term 'adjusted\ngross income' means, in the case of an individual, gross income minus\nthe deductions specified in subsection (a).",
      "code": "variable adjusted_gross_income:\n  imports:\n    # Gross income components (26 USC §61)\n    - 26/61/a/1#wages\n    - 26/61/a/1#salaries\n    - 26/61/a/1#tips\n    - 26/1402/a#self_employment_income\n    - 26/701#partnership_s_corp_income\n    - 26/61/a/6#farm_income\n    - 26/61/a/4#interest_income\n    - 26/61/a/7#dividend_income\n    - 26/61/a/3#capital_gains\n    - 26/61/a/5#rental_income\n    - 26/86#taxable_social_security\n    - 26/61/a/11#pension_income\n    - 26/85/a#taxable_unemployment\n    - 26/402#retirement_distributions\n    - 26/61/a#miscellaneous_income\n    # Above-the-line deductions (26 USC §62(a))\n    - 26/62/a/1#self_employment_tax_deduction\n    - 26/62/a/1#self_employed_health_insurance_deduction\n    - 26/62/a/2/D#educator_expense_deduction\n    - 26/62/a/4#loss_deduction\n    - 26/62/a/6#self_employed_pension_deduction\n    - 26/62/a/7#ira_deduction\n    - 26/62/a/12#hsa_deduction\n    - 26/62/a/17#student_loan_interest_deduction\n    - 26/62/a/23#tip_income_deduction\n    - 26/225/a#qualified_overtime_deduction\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Adjusted Gross Income\"\n  description: \"Gross income minus above-the-line deductions per 26 USC §62(a)\"\n  syntax: python\n  formula: |\n    # Step 1: Calculate gross income per 26 USC §61\n    # Includes all items listed in Section 61(a)(1)-(15)\n    employee_income = wages + salaries + tips\n    business_income = self_employment_income + partnership_s_corp_income + farm_income\n    investment_income = interest_income + dividend_income + capital_gains + rental_income\n    transfer_income = taxable_social_security + pension_income + taxable_unemployment + retirement_distributions\n    gross_income = employee_income + business_income + investment_income + transfer_income + miscellaneous_income\n    # Step 2: Sum above-the-line deductions (Section 62(a))\n    above_the_line_deductions = (\n    self_employment_tax_deduction +           # §62(a)(1) - 50% of SE tax\n    self_employed_health_insurance_deduction + # §62(a)(1) - health insurance for self-employed\n    educator_expense_deduction +               # §62(a)(2)(D) - up to $300\n    loss_deduction +                           # §62(a)(4) - losses from property sales\n    self_employed_pension_deduction +          # §62(a)(6) - SEP, SIMPLE, qualified plans\n    ira_deduction +                            # §62(a)(7) via §219\n    hsa_deduction +                            # §62(a)(12) via §223\n    student_loan_interest_deduction +          # §62(a)(17) via §221\n    tip_income_deduction +                     # §62(a)(23) via §74A (OBBBA temporary)\n    qualified_overtime_deduction               # §62(a)(24) via §225 (OBBBA temporary)\n    )\n    # Step 3: AGI = Gross Income - Above-the-Line Deductions\n    return gross_income - above_the_line_deductions",
      "path": "cosilico-us/statute/26/62/a.rac"
    },
    {
      "citation": "26 USC §62(a)(1) - Trade and Business Deductions",
      "title": "Trade and Business Deductions",
      "text": "(1) Trade and business deductions.—The deductions allowed by part VI\n(sec. 161 and following) which consist of expenses paid or incurred by\nthe taxpayer in connection with the performance by him of services as\nan employee.",
      "code": "variable self_employment_tax_deduction:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: USD\n  label: \"Self-Employment Tax Deduction\"\n  description: \"Deductible portion (50%) of self-employment tax per 26 USC 164(f)\"\n\n# Self-employed health insurance deduction\n# Reference: 26 USC 162(l)\nvariable self_employed_health_insurance_deduction:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: USD\n  label: \"Self-Employed Health Insurance Deduction\"\n  description: \"Health insurance premiums for self-employed individuals per 26 USC 162(l)\"",
      "path": "cosilico-us/statute/26/62/a/1.rac"
    },
    {
      "citation": "26 USC §62(a)(4) - Losses from Sale or Exchange of Property",
      "title": "Losses from Sale or Exchange of Property",
      "text": "(4) Losses from sale or exchange of property.—The deductions allowed\nby part VI (sec. 161 and following) as losses from the sale or exchange\nof property.",
      "code": "variable loss_deduction:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: USD\n  label: \"Loss Deduction\"\n  description: \"Above-the-line deduction for losses from property sales per 26 USC 62(a)(4)\"",
      "path": "cosilico-us/statute/26/62/a/4.rac"
    },
    {
      "citation": "26 USC §62(a)(6) - Pension Contributions of Self-Employed",
      "title": "Pension Contributions of Self-Employed",
      "text": "(6) Pension, profit-sharing, and annuity plans of self-employed\nindividuals.—In the case of an individual who is an employee within\nthe meaning of section 401(c)(1), the deduction allowed by section 404.",
      "code": "variable self_employed_pension_deduction:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: USD\n  label: \"Self-Employed Pension Deduction\"\n  description: \"Contributions to SEP, SIMPLE, or qualified plans by self-employed per 26 USC 62(a)(6)\"",
      "path": "cosilico-us/statute/26/62/a/6.rac"
    },
    {
      "citation": "26 USC 129",
      "title": "Dependent Care Assistance Programs",
      "text": "(a) EXCLUSION. --\n(1) IN GENERAL. -- Gross income of an employee does not include amounts paid\nor incurred by the employer for dependent care assistance provided to such\nemployee if the assistance is furnished pursuant to a program which is\ndescribed in subsection (d).\n(2) LIMITATION. -- The amount which may be excluded under paragraph (1) for\ndependent care assistance with respect to dependent care services provided\nduring a taxable year shall not exceed $5,000 ($2,500 in the case of a\nseparate return by a married individual).",
      "code": "variable exclusion:\n  imports:\n    - 26/21/e#num_cdcc_qualifying_individuals\n    - 26/129/b#dcap_earned_income_limit\n    - 26/1#filing_status\n    - 26/129/a#dcap_benefits_received\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"DCAP Taxable Amount\"\n  description: \"Dependent care assistance benefits that exceed the exclusion and are taxable\"\n  syntax: python\n  formula: |\n    # No qualifying individuals = no exclusion\n    if num_cdcc_qualifying_individuals == 0:\n        return 0\n    # MFS gets half the limit\n    if filing_status == MARRIED_FILING_SEPARATELY:\n        return exclusion_limit_mfs\n    # All other statuses get the full limit\n    return exclusion_limit\n  default: 0\n\nvariable inputs:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"DCAP Benefits Received\"\n  description: \"Employer-provided dependent care assistance received during the year\"\n  default: 0",
      "path": "cosilico-us/statute/26/129/a.rac"
    },
    {
      "citation": "26 USC 129(b)",
      "title": "Earned Income Limitation",
      "text": "(b) EARNED INCOME LIMITATION. --\n(1) IN GENERAL. -- The amount excluded from the gross income of an employee\nunder subsection (a) for any taxable year shall not exceed --\n(A) in the case of an employee who is not married at the close of such\ntaxable year, the earned income of such employee for such taxable year, or\n(B) in the case of an employee who is married at the close of such taxable\nyear, the lesser of --\n(i) the earned income of such employee for such taxable year, or\n(ii) the earned income of the spouse of such employee for such taxable year.\n(2) SPECIAL RULE FOR CERTAIN SPOUSES. -- For purposes of paragraph (1), in\nthe case of a spouse who is a student or is incapable of caring for himself,\nthe spouse is deemed to have earned income of not less than --\n(A) $250 per month during which such spouse is a full-time student..., or\n(B) $500 per month during which such spouse is incapable of caring for himself",
      "code": "variable earned_income_limit:\n  imports:\n    - 26/1#filing_status\n    - 26/32/c/2/A#earned_income\n    - 26/21/e#num_cdcc_qualifying_individuals\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"DCAP Earned Income Limit\"\n  description: \"Earned income limitation on dependent care assistance exclusion per 26 USC 129(b)\"\n  syntax: python\n  formula: |\n    # Calculate earned income for head and spouse\n    # Filter earned income by role, then sum\n    head_income = members.earned_income * members.is_tax_unit_head\n    spouse_income = members.earned_income * members.is_tax_unit_spouse\n    head_earned = sum(members, head_income)\n    spouse_actual_earned = sum(members, spouse_income)\n    # For single/HoH filers: use the head's earned income\n    if filing_status == SINGLE or filing_status == HEAD_OF_HOUSEHOLD:\n        return head_earned\n    # For married filers: use lesser of two spouses' earned income\n    # But first apply the special rule for student/disabled spouse\n    # Check if spouse is student or disabled\n    # Filter by spouse status, then check any\n    spouse_student_flag = members.is_full_time_student * members.is_tax_unit_spouse\n    spouse_disabled_flag = members.is_disabled * members.is_tax_unit_spouse\n    spouse_is_student = any(members, spouse_student_flag)\n    spouse_is_disabled = any(members, spouse_disabled_flag)\n    # Determine imputed income for student/disabled spouse\n    # Imputed for 12 months (annual amount)\n    imputed_monthly = imputed_monthly_two if num_cdcc_qualifying_individuals >= qualifying_individuals_higher_imputed_threshold else imputed_monthly_one\n    imputed_annual = imputed_monthly * months_per_year\n    # If spouse is student or disabled, use higher of actual or imputed income\n    spouse_earned = max(spouse_actual_earned, imputed_annual) if (spouse_is_student or spouse_is_disabled) else spouse_actual_earned\n    return min(head_earned, spouse_earned)",
      "path": "cosilico-us/statute/26/129/b.rac"
    },
    {
      "citation": "26 USC 129(d)",
      "title": "Dependent Care Assistance Program Definition",
      "text": "(d) DEPENDENT CARE ASSISTANCE PROGRAM. --\n(1) IN GENERAL. -- For purposes of this section a dependent care assistance\nprogram is a separate written plan of an employer for the exclusive\nbenefit of his employees to provide such employees with dependent care\nassistance which meets the requirements of paragraphs (2) through (8)\nof this subsection.\n(2) DISCRIMINATION. -- The contributions or benefits provided under the\nplan shall not discriminate in favor of employees who are highly\ncompensated employees (within the meaning of section 414(q)) or their\ndependents.\n(3) ELIGIBILITY. -- The program shall benefit employees who qualify under\na classification set up by the employer and found by the Secretary\nnot to be discriminatory in favor of employees described in paragraph (2),\nor their dependents.\n(4) PRINCIPAL SHAREHOLDERS OR OWNERS. -- Not more than 25 percent of the\namounts paid or incurred by the employer for dependent care assistance\nduring the year may be provided for the class of individuals who are\nshareholders or owners (or their spouses or dependents), each of whom\n(on any day of the year) owns more than 5 percent of the stock or of\nthe capital or profits interest in the employer.\n(5) NO FUNDING REQUIRED. -- A program referred to in paragraph (1) is not\nrequired to be funded.\n(6) NOTIFICATION OF ELIGIBLE EMPLOYEES. -- Reasonable notification of the\navailability and terms of the program shall be provided to eligible employees.\n(7) STATEMENT OF EXPENSES. -- The plan shall furnish to an employee, on or\nbefore January 31, a written statement showing the amounts paid or\nexpenses incurred by the employer in providing dependent care assistance\nto such employee during the previous calendar year.\n(8) BENEFITS. -- --\n(A) IN GENERAL. -- The term 'dependent care assistance' means the\npayment of, or provision of, those services which if paid for by\nthe employee would be considered employment-related expenses under\nsection 21(b)(2).\nNote: The definition of \"dependent care assistance\" in 129(e)(1) references\nsection 21(b)(1) for the definition of \"qualifying individual\":\n(e) DEFINITIONS AND SPECIAL RULES. --\n(1) DEPENDENT CARE ASSISTANCE. -- The term 'dependent care assistance'\nmeans the payment of, or provision of, those services which if paid\nfor by the employee would be considered employment-related expenses\nunder section 21(b)(2) (relating to expenses for household and\ndependent care services necessary for gainful employment).",
      "code": "# 26 USC 129(d) - Dependent Care Assistance Program Definition\n#\n\ntext: \"\"\"\n(d) DEPENDENT CARE ASSISTANCE PROGRAM. --\n(1) IN GENERAL. -- For purposes of this section a dependent care assistance\nprogram is a separate written plan of an employer for the exclusive\nbenefit of his employees to provide such employees with dependent care\nassistance which meets the requirements of paragraphs (2) through (8)\nof this subsection.\n(2) DISCRIMINATION. -- The contributions or benefits provided under the\nplan shall not discriminate in favor of employees who are highly\ncompensated employees (within the meaning of section 414(q)) or their\ndependents.\n(3) ELIGIBILITY. -- The program shall benefit employees who qualify under\na classification set up by the employer and found by the Secretary\nnot to be discriminatory in favor of employees described in paragraph (2),\nor their dependents.\n(4) PRINCIPAL SHAREHOLDERS OR OWNERS. -- Not more than 25 percent of the\namounts paid or incurred by the employer for dependent care assistance\nduring the year may be provided for the class of individuals who are\nshareholders or owners (or their spouses or dependents), each of whom\n(on any day of the year) owns more than 5 percent of the stock or of\nthe capital or profits interest in the employer.\n(5) NO FUNDING REQUIRED. -- A program referred to in paragraph (1) is not\nrequired to be funded.\n(6) NOTIFICATION OF ELIGIBLE EMPLOYEES. -- Reasonable notification of the\navailability and terms of the program shall be provided to eligible employees.\n(7) STATEMENT OF EXPENSES. -- The plan shall furnish to an employee, on or\nbefore January 31, a written statement showing the amounts paid or\nexpenses incurred by the employer in providing dependent care assistance\nto such employee during the previous calendar year.\n(8) BENEFITS. -- --\n(A) IN GENERAL. -- The term 'dependent care assistance' means the\npayment of, or provision of, those services which if paid for by\nthe employee would be considered employment-related expenses under\nsection 21(b)(2).\nNote: The definition of \"dependent care assistance\" in 129(e)(1) references\nsection 21(b)(1) for the definition of \"qualifying individual\":\n(e) DEFINITIONS AND SPECIAL RULES. --\n(1) DEPENDENT CARE ASSISTANCE. -- The term 'dependent care assistance'\nmeans the payment of, or provision of, those services which if paid\nfor by the employee would be considered employment-related expenses\nunder section 21(b)(2) (relating to expenses for household and\ndependent care services necessary for gainful employment).\n\"\"\"",
      "path": "cosilico-us/statute/26/129/d.rac"
    },
    {
      "citation": "26 USC 1401",
      "title": "--- Merged from self_employment_tax.rac ----",
      "text": "",
      "code": "variable self_employment_tax:\n  imports:\n    - 26/1401/b/2#self_employment_additional_medicare_tax\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Self-Employment Medicare Tax\"\n  description: \"Hospital Insurance tax on self-employment earnings per 1401(b)\"\n  syntax: python\n  formula: |\n    # taxable_self_employment_income from PE is already gross * 0.9235\n    result = max(0, taxable_self_employment_income)\n    return result\n\nvariable base_self_employment_tax:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Base Self-Employment Tax\"\n  description: \"OASDI + base HI taxes on self-employment income per 1401(a) and 1401(b)(1)\"\n  formula: return self_employment_social_security_tax + self_employment_medicare_tax\n\nvariable self_employment_tax:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Self-Employment Tax\"\n  description: \"Combined OASDI, HI, and Additional Medicare taxes per 1401\"\n  syntax: python\n  formula: |\n    # Base SE tax (OASDI + Medicare at 2.9%)\n    # Note: Additional Medicare Tax (0.9% above threshold) is calculated\n    # separately at TaxUnit level and added in final tax computation\n    return base_self_employment_tax",
      "path": "cosilico-us/statute/26/1401/a.rac"
    },
    {
      "citation": "26 USC 1401(b)(2)",
      "title": "Additional Medicare Tax on Self-Employment Income",
      "text": "(2) Additional tax -\nIn addition to the tax imposed by paragraph (1), there shall be imposed for\neach taxable year, on the self-employment income of every individual, a tax\nequal to 0.9 percent of so much of the self-employment income (as defined\nin section 1402(b)) as exceeds -\n(A) in the case of a joint return, $250,000,\n(B) in the case of a married individual (as defined in section 7703)\nfiling a separate return, $125,000, and\n(C) in any other case, $200,000.",
      "code": "variable additional_medicare_tax:\n  imports:\n    - 26/1#filing_status\n\nvariable combined_medicare_income:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Combined Medicare Income\"\n  description: \"Combined wages and SE income for Additional Medicare Tax threshold\"\n  syntax: python\n  formula: |\n    total_wages = sum(members, irs_employment_income)\n    total_se = sum(members, net_self_employment_earnings)\n    return total_wages + total_se\n\nvariable additional_medicare_tax_threshold:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Additional Medicare Tax Threshold\"\n  description: \"Income threshold for Additional Medicare Tax based on filing status\"\n  syntax: python\n  formula: |\n    # (A) Joint return = $250k\n    # (B) Married filing separately = $125k\n    # (C) Any other case = $200k (Single, HOH, Surviving Spouse)\n    if filing_status == JOINT:\n        return threshold_joint\n    elif filing_status == SEPARATE:\n        return threshold_separate\n    else:\n        return threshold_single\n\nvariable se_income_subject_to_additional_medicare_tax:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"SE Income Subject to Additional Medicare Tax\"\n  description: \"Self-employment income subject to 0.9% additional tax per 1401(b)(2)\"\n  syntax: python\n  formula: |\n    total_se = sum(members, net_self_employment_earnings)\n    total_wages = sum(members, irs_employment_income)\n    threshold = additional_medicare_tax_threshold\n    # Case 1: Wages already exceed threshold - all SE income is subject\n    # Case 2: Wages below threshold - only SE income above (threshold - wages) is subject\n    wages_under_threshold = max(0, threshold - total_wages)\n    se_above_remaining_threshold = max(0, total_se - wages_under_threshold)\n    return se_above_remaining_threshold\n\nvariable self_employment_additional_medicare_tax:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Additional Medicare Tax (Self-Employment)\"\n  description: \"0.9% additional Medicare tax on SE income above threshold per 26 USC 1401(b)(2)\"\n  formula: return additional_rate * se_income_subject_to_additional_medicare_tax",
      "path": "cosilico-us/statute/26/1401/b/2.rac"
    },
    {
      "citation": "26 USC 1411",
      "title": "Net Investment Income Tax (Standalone Validation Version)",
      "text": "",
      "code": "variable niit_standalone:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net Investment Income Tax\"\n  description: \"3.8% surtax on investment income for high-income taxpayers per Section 1411(a)\"\n  syntax: python\n  formula: |\n    # Section 1411(d): Modified AGI = AGI + foreign earned income exclusion\n    magi = adjusted_gross_income + foreign_earned_income_exclusion\n    # Section 1411(b): Determine threshold based on filing status\n    # (1) Joint return or surviving spouse: $250,000\n    # (2) Married filing separately: $125,000 (half of joint)\n    # (3) Any other case (single, HOH): $200,000\n    if filing_status == JOINT:\n        threshold = threshold_joint\n    elif filing_status == SURVIVING_SPOUSE:\n        threshold = threshold_joint\n    elif filing_status == SEPARATE:\n        threshold = threshold_separate\n    else:\n        threshold = threshold_other\n    # Section 1411(a)(1)(B): Excess of MAGI over threshold\n    excess_magi = max(0, magi - threshold)\n    # Section 1411(a)(1): Tax is rate (3.8%) times lesser of:\n    # (A) net investment income, or\n    # (B) excess of MAGI over threshold\n    taxable_amount = min(net_investment_income, excess_magi)\n    return niit_rate * taxable_amount\n  default: 0",
      "path": "cosilico-us/statute/26/1411.rac"
    },
    {
      "citation": "26 USC 163(a)",
      "title": "Interest Deduction",
      "text": "(a) General rule.-- There shall be allowed as a deduction all interest\npaid or accrued within the taxable year on indebtedness.",
      "code": "variable interest_deduction:\n  imports:\n    - 26/163/h#qualified_residence_interest\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Interest Deduction\"\n  description: \"Total deductible interest for itemized deductions per 26 USC 163\"\n  syntax: python\n  formula: |\n    # Deductible interest consists of:\n    # 1. Qualified residence interest (mortgage interest within limits)\n    # 2. Investment interest (limited to net investment income)\n    # 3. Mortgage points (if meeting requirements)\n    total = qualified_residence_interest + deductible_investment_interest + mortgage_points\n    return total\n  default: 0",
      "path": "cosilico-us/statute/26/163/a.rac"
    },
    {
      "citation": "26 USC 163(d)",
      "title": "Investment Interest Limitation",
      "text": "(1) In general.-- In the case of a taxpayer other than a corporation,\nthe amount allowed as a deduction under this chapter for investment\ninterest for any taxable year shall not exceed the net investment\nincome of the taxpayer for the taxable year.\n(2) Carryforward of disallowed interest.-- The amount not allowed as a\ndeduction for any taxable year by reason of paragraph (1) shall be\ntreated as investment interest paid or accrued by the taxpayer in\nthe succeeding taxable year.\n(3) Investment interest.-- For purposes of this subsection--\n(A) In general.-- The term 'investment interest' means any interest\nallowable as a deduction under this chapter... which is paid or\naccrued on indebtedness properly allocable to property held for\ninvestment.\n(4) Net investment income.-- For purposes of this subsection--\n(A) In general.-- The term 'net investment income' means the excess\nof--\n(i) investment income, over\n(ii) investment expenses.",
      "code": "variable investment_interest:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Investment Interest Carryforward\"\n  description: \"Disallowed investment interest carried to succeeding year per 26 USC 163(d)(2)\"\n  formula: return max(0, investment_income - investment_expenses)\n  default: 0",
      "path": "cosilico-us/statute/26/163/d.rac"
    },
    {
      "citation": "26 USC 163(h)",
      "title": "Qualified Residence Interest",
      "text": "(3) Qualified residence interest.-- For purposes of this subsection--\n(A) In general.-- The term 'qualified residence interest' means any\ninterest which is paid or accrued during the taxable year on--\n(i) acquisition indebtedness with respect to any qualified residence\nof the taxpayer, or\n(ii) home equity indebtedness with respect to any qualified residence\nof the taxpayer.\n(B) Acquisition indebtedness.--\n(ii) Limitation.-- The aggregate amount treated as acquisition\nindebtedness for any period shall not exceed $1,000,000\n($500,000 in the case of a married individual filing a\nseparate return).",
      "code": "variable qualified_residence_interest:\n  imports: [26/1#filing_status]\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Qualified Residence Interest Deduction\"\n  description: \"Deductible interest on qualified residence per 26 USC 163(h)\"\n  syntax: python\n  formula: |\n    # Determine applicable acquisition debt limit based on when debt was incurred\n    is_mfs = filing_status == \"married_separate\"\n    # Parameter lookup uses debt_incurred_date to get correct limit\n    if is_mfs:\n        applicable_limit = acquisition_debt_limit_mfs\n    else:\n        applicable_limit = acquisition_debt_limit\n    # Calculate deductible acquisition interest\n    acquisition_ratio = min(1, applicable_limit / max(1, acquisition_debt))\n    acquisition_interest = mortgage_interest_paid * acquisition_ratio\n    # Home equity interest: only deductible if used for home improvement (TCJA)\n    if is_mfs:\n        home_equity_limit = p.home_equity_debt_limit_mfs\n    else:\n        home_equity_limit = p.home_equity_debt_limit\n    he_deductible = home_equity_used_for_improvement and home_equity_limit > 0\n    if he_deductible:\n        home_equity_ratio = min(1, home_equity_limit / max(1, home_equity_debt))\n    else:\n        home_equity_ratio = 0\n    home_equity_interest = mortgage_interest_paid * home_equity_ratio\n    # Note: In practice, mortgage interest is usually just acquisition debt\n    # Home equity is tracked separately\n    return acquisition_interest\n  default: 0",
      "path": "cosilico-us/statute/26/163/h.rac"
    },
    {
      "citation": "26 USC 164(f)",
      "title": "Deduction for One-Half of Self-Employment Taxes",
      "text": "In the case of an individual, there shall be allowed as a deduction for\nthe taxable year an amount equal to one-half of the taxes imposed by\nsection 1401 for such taxable year.",
      "code": "variable se_tax_deduction:\n  imports: [26/1401/self_employment_tax#self_employment_tax]\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Self-Employment Tax Deduction\"\n  description: \"Deduction for one-half of self-employment taxes per 164(f)\"\n  syntax: python\n  formula: |\n    # Exactly one-half of the self-employment tax per statute\n    return se_tax_deduction_rate * self_employment_tax",
      "path": "cosilico-us/statute/26/164/f.rac"
    },
    {
      "citation": "26 USC 170(a)",
      "title": "Allowance of Deduction",
      "text": "(1) General rule.-- There shall be allowed as a deduction any charitable\ncontribution (as defined in subsection (c)) payment of which is made\nwithin the taxable year. A charitable contribution shall be allowable\nas a deduction only if verified under regulations prescribed by the\nSecretary.",
      "code": "variable charitable_deduction:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Charitable Contribution Deduction\"\n  description: \"Total deductible charitable contributions for itemized deductions per 26 USC 170(a)\"\n  syntax: python\n  formula: |\n    # Total deduction = current year + carryforward used\n    return charitable_deduction_before_carryforward + charitable_carryforward_used\n  default: 0",
      "path": "cosilico-us/statute/26/170/a.rac"
    },
    {
      "citation": "26 USC 170(b)",
      "title": "Percentage Limitations",
      "text": "(1) Individuals.-- In the case of an individual, the deduction provided\nin subsection (a) shall be limited as provided in the succeeding\nsubparagraphs.\n(A) General rule.-- Any charitable contribution to--\n(i) a church or a convention or association of churches,\n(ii) an educational organization...\n[public charities, 50%/60% limit organizations]\nshall be allowed to the extent that the aggregate of such contributions\ndoes not exceed 50 percent [60% under TCJA] of the taxpayer's\ncontribution base for the taxable year.\n(B) [30% organizations - private non-operating foundations]\n(C) Special limitation with respect to contributions... of certain\ncapital gain property.-- [30% limit for property to 50% orgs]\n(D) Special limitation with respect to contributions of capital gain\nproperty to organizations not described in subparagraph (A).--\n[20% limit for property to 30% orgs]",
      "code": "variable percentage_limitations:\n  imports: [26/62/a#adjusted_gross_income]\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Charitable Contribution Carryforward\"\n  description: \"Excess contributions to carry forward per 26 USC 170(d)(1)\"\n  syntax: python\n  formula: |\n    # Contribution base is generally AGI for individuals\n    agi = adjusted_gross_income\n    # Calculate limits for each category\n    cash_public_limit = agi * p.cash_to_public_charity\n    property_public_limit = agi * p.property_to_public_charity\n    cash_private_limit = agi * p.cash_to_private_foundation\n    property_private_limit = agi * p.property_to_private_foundation\n    # Overall limit\n    overall = agi * p.overall_limit\n    return overall\n  default: 0",
      "path": "cosilico-us/statute/26/170/b.rac"
    },
    {
      "citation": "26 USC 21",
      "title": "Child and Dependent Care Credit",
      "text": "(a) ALLOWANCE OF CREDIT. --\n(1) IN GENERAL. -- In the case of an individual who maintains a household which\nincludes as a member one or more qualifying individuals (as defined in\nsubsection (b)(1)), there shall be allowed as a credit against the tax\nimposed by this chapter for the taxable year an amount equal to the\napplicable percentage of the employment-related expenses (as defined in\nsubsection (b)(2)) paid by such individual during the taxable year.",
      "code": "variable child_dependent_care_credit:\n  imports:\n    - 26/21/e#num_cdcc_qualifying_individuals\n    - 26/21/b#cdcc_applicable_percentage\n    - 26/21/c#cdcc_maximum_expense_limit\n    - 26/21/d#cdcc_earned_income_limit\n    - 26/21/a#cdcc_expenses_paid\n    - 26/26/a#tax_liability_before_credits\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Child and Dependent Care Credit\"\n  description: \"Credit for employment-related expenses for care of qualifying individuals per 26 USC 21\"\n  syntax: python\n  formula: |\n    # Apply all limitations: actual expenses, statutory limit, earned income limit\n    limited_expenses = min(cdcc_expenses_paid, cdcc_maximum_expense_limit, cdcc_earned_income_limit)\n    # No qualifying individuals = no credit\n    if num_cdcc_qualifying_individuals == 0:\n        result = 0\n    else:\n        result = limited_expenses\n    return result\n  default: 0\n\nvariable inputs:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CDCC Expenses Paid\"\n  description: \"Employment-related child/dependent care expenses paid during the year\"\n  default: 0\n\n# Standalone validation version - all logic inline (no imports)\nvariable cdcc_standalone:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Child and Dependent Care Credit\"\n  description: \"Credit for employment-related expenses for care of qualifying individuals per 26 USC 21\"\n  syntax: python\n  formula: |\n    # 26 USC 21(c): Maximum expense limits per qualifying individual\n    if num_cdcc_qualifying_individuals == 0:\n        expense_limit = 0\n    elif num_cdcc_qualifying_individuals == 1:\n        expense_limit = one_qualifying_individual\n    else:\n        expense_limit = two_or_more_qualifying_individuals\n    # 26 USC 21(d)(1): Earned income limitation\n    # Credit limited to lesser of spouse's earned income for married couples\n    earned_income_limit = earned_income\n    # 26 USC 21(b)(2): Qualified expenses = actual expenses capped by limits\n    qualified_expenses = min(cdcc_expenses_paid, expense_limit, earned_income_limit)\n    # 26 USC 21(a)(2): Applicable percentage\n    # Starts at 35%, decreases by 1% per $2,000 of AGI above threshold, floor of 20%\n    agi_above_threshold = max(0, adjusted_gross_income - phase_down_threshold)\n    percentage_reduction = (agi_above_threshold // phase_down_increment) * phase_down_rate\n    applicable_rate = max(minimum_rate, maximum_rate - percentage_reduction)\n    # Final credit = applicable percentage * qualified expenses\n    # Note: non-refundable (limited to tax liability) under permanent law\n    return applicable_rate * qualified_expenses\n  default: 0",
      "path": "cosilico-us/statute/26/21/a.rac"
    },
    {
      "citation": "26 USC 21(b)",
      "title": "Applicable Percentage",
      "text": "(b) APPLICABLE PERCENTAGE DEFINED. -- For purposes of subsection (a), the term\n'applicable percentage' means 35 percent reduced (but not below 20 percent) by\n1 percentage point for each $2,000 (or fraction thereof) by which the taxpayer's\nadjusted gross income for the taxable year exceeds $15,000.",
      "code": "variable applicable_percentage:\n  imports:\n    - 26/62/a#adjusted_gross_income\n  entity: TaxUnit\n  period: Year\n  dtype: Rate\n  label: \"CDCC Applicable Percentage\"\n  description: \"Credit rate for Child and Dependent Care Credit per 26 USC 21(b)\"\n  syntax: python\n  formula: |\n    agi = adjusted_gross_income\n    # For ARPA 2021 complete phaseout above $400,000\n    # Note: This applies only when arpa_complete_phaseout_threshold is finite\n    if agi > arpa_complete_phaseout_threshold:\n        # Secondary phase-out from 20% to 0%\n        # AGI $400,000 to $438,000 (phasing out $50 per $1,000)\n        excess_over_phaseout = agi - arpa_complete_phaseout_threshold\n        phaseout_increments = ceil(excess_over_phaseout / phase_down_increment)\n        secondary_reduction = phaseout_increments * phase_down_rate\n        return max(0, minimum_rate - secondary_reduction)\n    # Calculate excess AGI over threshold\n    excess_agi = max(0, agi - phase_down_threshold)\n    # Number of $2,000 increments (or fraction thereof) using ceiling\n    increments = ceil(excess_agi / phase_down_increment)\n    # Total rate reduction (1 percentage point per increment)\n    rate_reduction = increments * phase_down_rate\n    # Apply reduction but floor at minimum rate\n    return max(minimum_rate, maximum_rate - rate_reduction)",
      "path": "cosilico-us/statute/26/21/b.rac"
    },
    {
      "citation": "26 USC 21(b)",
      "title": "Qualifying Individual",
      "text": "(b) QUALIFYING INDIVIDUAL. -- The term 'qualifying individual' means --\n(1) a dependent of the taxpayer... who has not attained age 13,\n(2) a dependent of the taxpayer... who is physically or mentally incapable\nof caring for himself or herself and who has the same principal place\nof abode as the taxpayer for more than one-half of such taxable year, or\n(3) the spouse of the taxpayer, if the spouse is physically or mentally\nincapable of caring for himself or herself...",
      "code": "variable is_qualifying_individual:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Is CDCC Qualifying Individual\"\n  description: \"Whether person qualifies for purposes of Child and Dependent Care Credit per 26 USC 21(b)\"\n  syntax: python\n  formula: |\n    # Category 1: Dependent child under age 13\n    is_qualifying_child = is_dependent and age < child_age_limit\n    # Category 2: Disabled dependent\n    is_qualifying_disabled_dependent = is_dependent and is_disabled\n    # Category 3: Disabled spouse\n    is_qualifying_disabled_spouse = is_tax_unit_spouse and is_disabled\n    return is_qualifying_child or is_qualifying_disabled_dependent or is_qualifying_disabled_spouse\n\nvariable num_qualifying_individuals:\n  imports: [26/21/e#is_cdcc_qualifying_individual]\n  entity: TaxUnit\n  period: Year\n  dtype: Count\n  label: \"Number of CDCC Qualifying Individuals\"\n  description: \"Count of qualifying individuals for Child and Dependent Care Credit per 26 USC 21(b)\"\n  syntax: python\n  formula: |\n    return tax_unit.members.count(is_cdcc_qualifying_individual)",
      "path": "cosilico-us/statute/26/21/e.rac"
    },
    {
      "citation": "26 USC 21(c)",
      "title": "Dollar Limit on Amount Creditable",
      "text": "(c) DOLLAR LIMIT ON AMOUNT CREDITABLE. -- The amount of the employment-related\nexpenses incurred during any taxable year which may be taken into account under\nsubsection (a) shall not exceed --\n(1) $3,000 if there is 1 qualifying individual...\n(2) $6,000 if there are 2 or more qualifying individuals...",
      "code": "variable expense_limit:\n  imports:\n    - 26/21/e#num_cdcc_qualifying_individuals\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CDCC Maximum Expense Limit\"\n  description: \"Dollar limit on creditable expenses based on number of qualifying individuals per 26 USC 21(c)\"\n  syntax: python\n  formula: |\n    # No qualifying individuals = no credit\n    if num_cdcc_qualifying_individuals == 0:\n        return 0\n    # 1 qualifying individual\n    if num_cdcc_qualifying_individuals == 1:\n        return one_qualifying_limit\n    # 2 or more qualifying individuals\n    return two_or_more_limit",
      "path": "cosilico-us/statute/26/21/c.rac"
    },
    {
      "citation": "26 USC 21(d)",
      "title": "Earned Income Limitation",
      "text": "(d) EARNED INCOME LIMITATION. --\n(1) IN GENERAL. -- Except as otherwise provided in this subsection, the amount of\nthe employment-related expenses incurred during any taxable year which may be\ntaken into account under subsection (a) shall not exceed --\n(A) in the case of an individual who is not married at the close of such year,\nsuch individual's earned income for such year, or\n(B) in the case of an individual who is married at the close of such year,\nthe lesser of such individual's earned income or the earned income of\nhis spouse for such year.",
      "code": "variable earned_income_limit:\n  imports:\n    - 26/1#filing_status\n    - 26/32/c/2/A#earned_income\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CDCC Earned Income Limit\"\n  description: \"Earned income limitation on creditable expenses per 26 USC 21(d)\"\n  syntax: python\n  formula: |\n    # For single/HoH filers: use the head's earned income\n    # Filter earned income by role, then sum\n    head_income = members.earned_income * members.is_tax_unit_head\n    spouse_income = members.earned_income * members.is_tax_unit_spouse\n    head_earned = sum(members, head_income)\n    spouse_earned = sum(members, spouse_income)\n    if filing_status == SINGLE or filing_status == HEAD_OF_HOUSEHOLD:\n        return head_earned\n    # For married filers: use lesser of two spouses' earned income\n    # This incentivizes work for both spouses\n    return min(head_earned, spouse_earned)",
      "path": "cosilico-us/statute/26/21/d.rac"
    },
    {
      "citation": "26 USC 213(a)",
      "title": "Allowance of Deduction for Medical Expenses",
      "text": "(a) Allowance of deduction.-- There shall be allowed as a deduction the\nexpenses paid during the taxable year, not compensated for by insurance\nor otherwise, for medical care of the taxpayer, his spouse, or a\ndependent (as defined in section 152, determined without regard to\nsubsections (b)(1), (b)(2), and (d)(1)(B) thereof), to the extent that\nsuch expenses exceed 7.5 percent of adjusted gross income.",
      "code": "variable medical_expense_deduction:\n  imports:\n    - 26/62/a#adjusted_gross_income\n    - 26/213/d#qualifying_medical_expenses\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Medical Expense Deduction\"\n  description: \"Itemized deduction for medical expenses exceeding 7.5% of AGI per 26 USC 213(a)\"\n  syntax: python\n  formula: |\n    agi = adjusted_gross_income\n    expenses = qualifying_medical_expenses\n    # Calculate floor: 7.5% of AGI (permanent after CAA 2021)\n    # Negative AGI treated as $0 floor\n    floor = max(0, agi) * p.rate\n    # Deduction is expenses exceeding the floor\n    return max(0, expenses - floor)\n  default: 0",
      "path": "cosilico-us/statute/26/213/a.rac"
    },
    {
      "citation": "26 USC 213(d)",
      "title": "Definition of Medical Care",
      "text": "(d) Definitions.—For purposes of this section—\n(1) The term 'medical care' means amounts paid—\n(A) for the diagnosis, cure, mitigation, treatment, or prevention\nof disease, or for the purpose of affecting any structure or\nfunction of the body,\n(B) for transportation primarily for and essential to medical care\nreferred to in subparagraph (A),\n(C) for qualified long-term care services (as defined in section 7702B(c)),\n(D) for insurance (including amounts paid as premiums under part B of\ntitle XVIII of the Social Security Act) covering medical care\nreferred to in subparagraphs (A) and (B) or for any qualified\nlong-term care insurance contract (as defined in section 7702B(b)).\nPer 213(a), qualifying expenses must be:\n- Not compensated by insurance or otherwise\n- For taxpayer, spouse, or dependent (per Section 152)",
      "code": "variable qualified_medical_expenses:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Qualifying Medical Expenses\"\n  description: \"Medical expenses eligible for deduction per 26 USC 213(d), net of insurance reimbursement\"\n  syntax: python\n  formula: |\n    # Step 1: Start with gross medical expenses paid during taxable year\n    gross_medical = medical_expenses_paid\n    # Step 2: Subtract insurance reimbursements per 213(a)\n    # \"not compensated for by insurance or otherwise\"\n    unreimbursed = max(0, gross_medical - insurance_reimbursements)\n    # Step 3: Add qualified long-term care premiums per 213(d)(1)(D)\n    # Note: Premium limits by age apply per 213(d)(10)\n    # Full implementation would cap LTC premiums based on taxpayer age:\n    #   Age 40 or under: $480 (2023), $470 (2024)\n    #   Age 41-50: $890 (2023), $880 (2024)\n    #   Age 51-60: $1,790 (2023), $1,760 (2024)\n    #   Age 61-70: $4,770 (2023), $4,710 (2024)\n    #   Over 70: $5,960 (2023), $5,880 (2024)\n    ltc_allowed = long_term_care_premiums\n    # Total qualifying expenses\n    return unreimbursed + ltc_allowed\n  default: 0",
      "path": "cosilico-us/statute/26/213/d.rac"
    },
    {
      "citation": "26 USC 22",
      "title": "Credit for the Elderly and the Disabled",
      "text": "(a) GENERAL RULE. -- In the case of a qualified individual, there shall be\nallowed as a credit against the tax imposed by this chapter for the taxable\nyear an amount equal to 15 percent of such individual's section 22 amount\nfor such taxable year.",
      "code": "variable elderly_disabled_credit:\n  imports:\n    - 26/22/d#adjusted_sec22_amount\n    - 26/22/e#num_sec22_qualified_individuals\n    - 26/26/a#tax_liability_before_credits\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Credit for the Elderly or Disabled\"\n  description: \"Final credit for the elderly or disabled per 26 USC 22 (nonrefundable)\"\n  syntax: python\n  formula: |\n    # No credit if no qualified individuals\n    if num_sec22_qualified_individuals == 0: return 0\n    # Credit is 15% of the adjusted section 22 amount\n    return adjusted_sec22_amount * applicable_percentage\n  default: 0\n\nvariable inputs:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Taxable Pension and Annuity Income\"\n  description: \"Pension and annuity income included in gross income (excludes Social Security)\"\n  default: 0",
      "path": "cosilico-us/statute/26/22/a.rac"
    },
    {
      "citation": "26 USC 22(c)",
      "title": "Section 22 Amount (Initial Amount)",
      "text": "(1) IN GENERAL. -- Except as provided in paragraph (2), the section 22 amount is--\n(A) $5,000 in the case of--\n(i) a joint return where only one spouse is a qualified individual,\n(ii) a return of a surviving spouse, or\n(iii) a return of a head of household or an individual who is not married,\n(B) $7,500 in the case of a joint return where both spouses are qualified individuals, or\n(C) $3,750 in the case of a married individual filing a separate return.\n(2) DISABILITY INCOME LIMIT. -- In the case of a qualified individual who has not\nattained age 65 before the close of the taxable year, the section 22 amount...\nshall not exceed the disability income received.",
      "code": "variable initial_amount:\n  imports:\n    - 26/22/c#initial_amount_single\n    - 26/22/c#initial_amount_joint_both\n    - 26/22/c#initial_amount_separate\n    - 26/22/c#qualified_individuals_joint_both_threshold\n    - 26/22/e#num_sec22_qualified_individuals\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Section 22 Initial Amount\"\n  description: \"Initial section 22 amount before reductions per 26 USC 22(c)(1)\"\n  syntax: python\n  formula: |\n    # No credit if no qualified individuals\n    if num_sec22_qualified_individuals == 0: return 0\n    # Married filing separately: $3,750\n    if filing_status == SEPARATE: return initial_amount_separate\n    # Joint return with both spouses qualified: $7,500\n    if filing_status == JOINT and num_sec22_qualified_individuals >= qualified_individuals_joint_both_threshold: return initial_amount_joint_both\n    # All other cases (single, HoH, surviving spouse, or joint with one qualified): $5,000\n    return initial_amount_single\n  default: 0",
      "path": "cosilico-us/statute/26/22/c.rac"
    },
    {
      "citation": "26 USC 22(d)",
      "title": "Adjusted Section 22 Amount",
      "text": "If the adjusted gross income of the taxpayer exceeds [threshold]...\nthe section 22 amount shall be reduced by one-half of the excess.",
      "code": "variable adjusted_section_22_amount:\n  imports:\n    - 26/22/c#sec22_initial_amount\n    - 26/22/d#sec22_nontaxable_reduction\n    - 26/22/d#sec22_agi_reduction\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Adjusted Section 22 Amount\"\n  description: \"Section 22 amount after all reductions per 26 USC 22(d)\"\n  syntax: python\n  formula: |\n    # Start with initial amount\n    initial = sec22_initial_amount\n    # Subtract nontaxable income reduction (d)(1)\n    after_nontaxable = max(0, initial - sec22_nontaxable_reduction)\n    # Subtract AGI reduction (d)(2)\n    # Note: Both reductions apply - the total reduction is the sum\n    after_agi = max(0, after_nontaxable - sec22_agi_reduction)\n    return after_agi\n  default: 0\n\n# 26 USC 22(d)(2) - AGI Reduction\n#\n\ntext: \"\"\"\nIf the adjusted gross income of the taxpayer exceeds [threshold]...\nthe section 22 amount shall be reduced by one-half of the excess.\n\"\"\"\nvariable agi_reduction:\n  imports:\n    - 26/22/d/reduction#agi_reduction_rate\n    - 26/22/d#sec22_agi_threshold\n    - 26/62/a#adjusted_gross_income\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Section 22 AGI Reduction\"\n  description: \"Reduction to section 22 amount based on excess AGI per 26 USC 22(d)(2)\"\n  syntax: python\n  formula: |\n    # Calculate excess AGI over threshold\n    excess_agi = max(0, adjusted_gross_income - sec22_agi_threshold)\n    # Reduction is 50% of excess\n    return excess_agi * agi_reduction_rate\n  default: 0\n\n\nvariable agi_threshold:\n  imports:\n    - 26/22/d/reduction#agi_threshold_single\n    - 26/22/d/reduction#agi_threshold_joint\n    - 26/22/d/reduction#agi_threshold_separate\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Section 22 AGI Threshold\"\n  description: \"AGI threshold for section 22 reduction based on filing status per 26 USC 22(d)(2)\"\n  syntax: python\n  formula: |\n    if filing_status == JOINT: return agi_threshold_joint\n    if filing_status == SEPARATE: return agi_threshold_separate\n    # Single, head of household, surviving spouse\n    return agi_threshold_single\n  default: 7500\n\n\nvariable nontaxable_reduction:\n  imports:\n    - 26/22/a#nontaxable_social_security\n    - 26/22/a#nontaxable_railroad_retirement\n    - 26/22/a#taxable_pension_annuity\n    - 26/22/a#taxable_disability_income\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Section 22 Nontaxable Income Reduction\"\n  description: \"Reduction to section 22 amount for nontaxable pensions, Social Security, and disability income per 26 USC 22(d)(1)\"\n  syntax: python\n  formula: |\n    # Sum all amounts that reduce the section 22 amount\n    # Per statute: Social Security (nontaxable) + pensions/annuities (taxable) + disability\n    social_security_reduction = nontaxable_social_security + nontaxable_railroad_retirement\n    pension_reduction = taxable_pension_annuity\n    disability_reduction = taxable_disability_income\n    return social_security_reduction + pension_reduction + disability_reduction\n  default: 0",
      "path": "cosilico-us/statute/26/22/d.rac"
    },
    {
      "citation": "26 USC 22(e)(1)",
      "title": "Qualified Individual",
      "text": "(1) QUALIFIED INDIVIDUAL. -- The term 'qualified individual' means any individual--\n(A) who has attained age 65 before the close of the taxable year, or\n(B) who retired on disability before the close of the taxable year and who,\nwhen he retired, was permanently and totally disabled.",
      "code": "variable is_qualified_individual:\n  imports: [26/22/e/qualified_individual#elderly_age_threshold]\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Is Section 22 Qualified Individual\"\n  description: \"Whether the person qualifies for the credit for the elderly or disabled per 26 USC 22(e)(1)\"\n  syntax: python\n  formula: |\n    # Age at end of tax year\n    taxpayer_age = age\n    # Qualifies if 65+ at end of tax year\n    is_elderly = taxpayer_age >= elderly_age_threshold\n    # Qualifies if permanently and totally disabled (under 65)\n    # is_permanently_disabled is assumed to be an input indicating permanent/total disability\n    is_disabled_and_under_65 = is_permanently_disabled and taxpayer_age < elderly_age_threshold\n    return is_elderly or is_disabled_and_under_65\n  default: False\n\nvariable num_qualified_individuals:\n  imports: [26/22/e#is_sec22_qualified_individual]\n  entity: TaxUnit\n  period: Year\n  dtype: Integer\n  label: \"Number of Section 22 Qualified Individuals\"\n  description: \"Count of qualified individuals (elderly or disabled) in the tax unit\"\n  syntax: python\n  formula: |\n    # Sum the boolean values of is_qualified for head and spouse\n    return sum(is_sec22_qualified_individual)\n  default: 0",
      "path": "cosilico-us/statute/26/22/e.rac"
    },
    {
      "citation": "26 USC 25B(a)",
      "title": "Allowance of Credit",
      "text": "(a) ALLOWANCE OF CREDIT.--In the case of an eligible individual, there shall\nbe allowed as a credit against the tax imposed by this subtitle for the\ntaxable year an amount equal to the applicable percentage of so much of\nthe qualified retirement savings contributions of the eligible individual\nfor the taxable year as do not exceed $2,000.",
      "code": "variable savers_credit:\n  imports:\n    - 26/25B/c#is_savers_credit_eligible\n    - 26/25B/b#savers_credit_applicable_percentage\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Saver's Credit\"\n  description: \"Credit for qualified retirement savings contributions per 26 USC 25B (nonrefundable)\"\n  syntax: python\n  formula: |\n    # Sum of all qualified retirement savings contributions per 25B(d)(1)\n    return (\n    traditional_ira_contributions +\n    traditional_401k_contributions +\n    traditional_403b_contributions +\n    roth_ira_contributions +\n    roth_401k_contributions +\n    roth_403b_contributions +\n    self_employed_pension_contributions +\n    able_contributions_person\n    )\n  default: 0",
      "path": "cosilico-us/statute/26/25B/a.rac"
    },
    {
      "citation": "26 USC 25B(b)",
      "title": "Applicable Percentage",
      "text": "(b) APPLICABLE PERCENTAGE.--For purposes of this section--\n(1) JOINT RETURNS.--In the case of a joint return, the applicable percentage\nis determined in accordance with the following table:\nOver $0   but not over $43,500 . . . . . . . . . 50 percent\nOver $43,500 but not over $47,500 . . . . . . . 20 percent\nOver $47,500 but not over $73,000 . . . . . . . 10 percent\nOver $73,000 . . . . . . . . . . . . . . . . .  0 percent\n(2) HEAD OF HOUSEHOLD.--In the case of an individual who is a head of\nhousehold (as defined in section 2(b)), the applicable percentage...\n(3) OTHER INDIVIDUALS.--In any other case, the applicable percentage...",
      "code": "variable applicable_percentage:\n  imports:\n    - 26/1#filing_status\n    - 26/62/a#adjusted_gross_income\n  entity: TaxUnit\n  period: Year\n  dtype: Rate\n  label: \"Saver's Credit Applicable Percentage\"\n  description: \"Credit rate for Saver's Credit based on AGI and filing status per 26 USC 25B(b)\"\n  syntax: python\n  formula: |\n    agi = adjusted_gross_income\n    # Get threshold adjustment factor based on filing status\n    # Joint is the base (1.0), other statuses adjust down\n    threshold_adjustment = threshold_adjustments[filing_status]\n    # Adjust AGI to compare against joint thresholds\n    # This is equivalent to adjusting thresholds down, but more efficient\n    adjusted_agi = agi / threshold_adjustment\n    # Apply rate based on adjusted AGI against joint thresholds\n    # 50% rate: AGI at or below first threshold\n    if adjusted_agi <= joint_threshold_50:\n        return savers_credit_rate_tier1\n    # 20% rate: AGI above first but at or below second threshold\n    if adjusted_agi <= joint_threshold_20:\n        return savers_credit_rate_tier2\n    # 10% rate: AGI above second but at or below third threshold\n    if adjusted_agi <= joint_threshold_10:\n        return savers_credit_rate_tier3\n    # 0% rate: AGI above third threshold - no credit\n    return 0\n  default: 0",
      "path": "cosilico-us/statute/26/25B/b.rac"
    },
    {
      "citation": "26 USC 25B(c)",
      "title": "Eligible Individual",
      "text": "(c) ELIGIBLE INDIVIDUAL.--For purposes of this section--\n(1) IN GENERAL.--The term 'eligible individual' means any individual if such\nindividual has attained the age of 18 as of the close of the taxable year.\n(2) DEPENDENTS AND FULL-TIME STUDENTS NOT ELIGIBLE.--The term 'eligible\nindividual' shall not include--\n(A) any individual with respect to whom a deduction under section 151 is\nallowed to another taxpayer for a taxable year beginning in the\ncalendar year in which such individual's taxable year begins, and\n(B) any individual who is a student (as defined in section 152(f)(2)).\nNote: The statute says \"with respect to whom a deduction under section 151\nis allowed to another taxpayer\" - this means the person cannot be claimed",
      "code": "variable eligible_individual:\n  imports: [26/1/is_tax_unit_head_or_spouse#is_tax_unit_head_or_spouse]\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Eligible for Saver's Credit\"\n  description: \"Whether individual is an eligible individual for the Saver's Credit per 26 USC 25B(c)\"\n  syntax: python\n  formula: |\n    # 25B(c)(1): Must be at least 18 at end of tax year\n    meets_age_requirement = age >= minimum_age\n    # Only head of household or spouse can claim (they are the filers)\n    is_filer = is_tax_unit_head_or_spouse\n    # 25B(c)(2)(A): Not claimed as dependent on ANOTHER taxpayer's return\n    not_dependent_elsewhere = not claimed_as_dependent_on_another_return\n    # 25B(c)(2)(B): Not a full-time student (as defined in 152(f)(2))\n    not_a_student = not is_full_time_student\n    # All conditions must be met\n    return meets_age_requirement and is_filer and not_dependent_elsewhere and not_a_student\n  default: False",
      "path": "cosilico-us/statute/26/25B/c.rac"
    },
    {
      "citation": "26 USC 25E",
      "title": "Previously-Owned Clean Vehicles Credit",
      "text": "(a) ALLOWANCE OF CREDIT. -- In the case of a qualified buyer who during a\ntaxable year places in service a previously-owned clean vehicle, there shall\nbe allowed as a credit against the tax imposed by this chapter for the\ntaxable year an amount equal to the lesser of--\n(1) $4,000, or\n(2) the amount equal to 30 percent of the sale price with respect to\nsuch vehicle.",
      "code": "variable used_vehicle_credit:\n  imports:\n    - 26/1#filing_status\n    - 26/62/a#adjusted_gross_income\n    - 26/1#income_tax_before_credits\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Used Clean Vehicle Credit\"\n  description: \"Credit for previously-owned clean vehicles per 26 USC 25E\"\n  syntax: python\n  formula: |\n    # Note: Law specifies lesser of current or prior year MAGI\n    # For simplicity, using current year AGI\n    agi = adjusted_gross_income\n    limit = p.eligibility.income_limit[filing_status]\n    return agi <= limit\n  default: 0",
      "path": "cosilico-us/statute/26/25E.rac"
    },
    {
      "citation": "26 USC 30D",
      "title": "New Clean Vehicle Credit",
      "text": "(a) ALLOWANCE OF CREDIT. -- There shall be allowed as a credit against the\ntax imposed by this chapter for the taxable year an amount equal to the sum\nof the credit amounts determined under subsection (b) with respect to each\nnew clean vehicle placed in service by the taxpayer during the taxable year.",
      "code": "variable new_vehicle_credit:\n  imports:\n    - 26/1#filing_status\n    - 26/62/a#adjusted_gross_income\n    - 26/1#income_tax_before_credits\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"New Clean Vehicle Credit\"\n  description: \"Credit for new clean vehicles per 26 USC 30D\"\n  syntax: python\n  formula: |\n    capacity = new_clean_vehicle_battery_capacity_kwh\n    min_capacity = p.eligibility.min_battery_capacity_kwh\n    return capacity >= min_capacity\n  default: 0",
      "path": "cosilico-us/statute/26/30D.rac"
    },
    {
      "citation": "26 USC 3101(a)",
      "title": "Employee Social Security (OASDI) Tax",
      "text": "(a) Old-age, survivors, and disability insurance -\nIn addition to other taxes, there is hereby imposed on the income of every\nindividual a tax equal to 6.2 percent of the wages (as defined in section\n3121(a)) received by him with respect to employment (as defined in section\n3121(b)).",
      "code": "variable employee_social_security_tax:\n  imports: [26/3121/a/irs_employment_income#irs_employment_income]\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Employee Social Security Tax\"\n  description: \"Employee share of Social Security (OASDI) tax at 6.2% of wages up to wage base per 26 USC 3101(a)\"\n  syntax: python\n  formula: |\n    # Social Security tax applies only up to the wage base cap\n    taxable_wages = min(irs_employment_income, wage_base)\n    return taxable_wages * employee_rate\n\n\n\n# ---- Merged from employee_fica_tax.rac ----\n\n# 26 USC 3101 - Employee FICA Tax (Combined Social Security + Medicare)\n#\nvariable employee_fica_tax:\n  imports:\n    - 26/3101/a#employee_social_security_tax\n    - 26/3101/b#employee_medicare_tax\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Employee FICA Tax\"\n  description: \"Combined employee Social Security and Medicare taxes per 26 USC 3101\"\n  syntax: python\n  formula: |\n    # Sum of Social Security (6.2%) and Medicare (1.45%) employee taxes\n    # Note: Additional Medicare Tax (0.9%) is computed separately in 3101(b)(2)\n    return employee_social_security_tax + employee_medicare_tax",
      "path": "cosilico-us/statute/26/3101/a.rac"
    },
    {
      "citation": "26 USC 3101(b)(1)",
      "title": "Employee Medicare (Hospital Insurance) Tax",
      "text": "(b) Hospital insurance -\n(1) In general - In addition to the tax imposed by subsection (a), there is\nhereby imposed on the income of every individual a tax equal to 1.45 percent\nof the wages (as defined in section 3121(a)) received by him with respect to\nemployment (as defined in section 3121(b)).",
      "code": "variable medicare_tax:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Medicare Tax Withheld\"\n  description: \"Total Medicare tax withheld from wages (employee share) per 26 USC 3101(b)\"\n  syntax: python\n  formula: |\n    # Medicare tax applies to ALL wages - no cap unlike Social Security\n    return irs_employment_income * employee_rate",
      "path": "cosilico-us/statute/26/3101/b.rac"
    },
    {
      "citation": "26 USC 3101(b)(2)",
      "title": "Additional Medicare Tax",
      "text": "(2) Additional tax -\nIn addition to the tax imposed by paragraph (1), there is hereby imposed\non the income of every individual a tax equal to 0.9 percent of so much\nof the wages (as defined in section 3121(a)) received by him with respect\nto employment (as defined in section 3121(b)) during any calendar year as\nexceeds -\n(A) in the case of a joint return, $250,000,\n(B) in the case of a married individual (as defined in section 7703)\nfiling a separate return, $125,000, and\n(C) in any other case, $200,000.",
      "code": "variable additional_medicare_tax:\n  imports:\n    - 26/1#filing_status\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Additional Medicare Tax\"\n  description: \"0.9% additional Medicare tax on wages above threshold per 26 USC 3101(b)(2)\"\n  syntax: python\n  formula: |\n    # Both wages and self-employment income are subject to the tax\n    total_wages = sum(members, irs_employment_income)\n    total_se = sum(members, taxable_self_employment_income)\n    return total_wages + total_se",
      "path": "cosilico-us/statute/26/3101/b/2.rac"
    },
    {
      "citation": "26 USC 3111(a)",
      "title": "Employer Social Security (OASDI) Tax",
      "text": "(a) Old-age, survivors, and disability insurance -\nIn addition to other taxes, there is hereby imposed on every employer an excise\ntax, with respect to having individuals in his employ, equal to 6.2 percent of\nthe wages (as defined in section 3121(a)) paid by him with respect to employment\n(as defined in section 3121(b)).",
      "code": "variable employer_social_security_tax:\n  imports: [26/3121/a/irs_employment_income#irs_employment_income]\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Employer Social Security Tax\"\n  description: \"Employer share of Social Security (OASDI) tax at 6.2% of wages up to wage base per 26 USC 3111(a)\"\n  syntax: python\n  formula: |\n    # Social Security tax applies only up to the wage base cap\n    # Employer rate matches employee rate\n    taxable_wages = min(irs_employment_income, wage_base)\n    return taxable_wages * employer_rate\n\n\n\n# ---- Merged from employer_fica_tax.rac ----\n\n# 26 USC 3111 - Employer FICA Tax (Combined)\n#\nvariable employer_fica_tax:\n  imports:\n    - 26/3111/a#employer_social_security_tax\n    - 26/3111/b#employer_medicare_tax\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Employer FICA Tax\"\n  description: \"Combined employer Social Security and Medicare tax per 26 USC 3111\"\n  syntax: python\n  formula: |\n    # Total employer FICA = Social Security (capped) + Medicare (uncapped)\n    return employer_social_security_tax + employer_medicare_tax",
      "path": "cosilico-us/statute/26/3111/a.rac"
    },
    {
      "citation": "26 USC 3111(b)",
      "title": "Employer Medicare (Hospital Insurance) Tax",
      "text": "(b) Hospital insurance -\nIn addition to the tax imposed by subsection (a), there is hereby imposed\non every employer an excise tax, with respect to having individuals in his\nemploy, equal to 1.45 percent of the wages (as defined in section 3121(a))\npaid by him with respect to employment (as defined in section 3121(b)).",
      "code": "variable employer_medicare_tax:\n  imports: [26/3121/a/irs_employment_income#irs_employment_income]\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total Medicare Tax\"\n  description: \"Combined employer and employee Medicare tax (2.9% of wages)\"\n  syntax: python\n  formula: |\n    # Medicare tax applies to ALL wages - no cap unlike Social Security\n    # Employer rate matches employee rate\n    return irs_employment_income * employer_medicare_rate",
      "path": "cosilico-us/statute/26/3111/b.rac"
    },
    {
      "citation": "26 USC 32",
      "title": "Earned Income Credit (Standalone Validation Version)",
      "text": "",
      "code": "variable eitc_standalone:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Earned Income Tax Credit\"\n  description: \"Refundable credit for low-to-moderate income working individuals per 26 USC 32(a)(1)\"\n  syntax: python\n  formula: |\n    # Cap children at 3 for credit calculation\n    n_children = min(num_qualifying_children, 3)\n    # Get credit rate based on number of children - 32(a)(2)(A)\n    if n_children == 0:\n        credit_rate = credit_rate_0\n    elif n_children == 1:\n        credit_rate = credit_rate_1\n    elif n_children == 2:\n        credit_rate = credit_rate_2\n    else:\n        credit_rate = credit_rate_3\n    # Get earned income cap based on number of children\n    if n_children == 0:\n        earned_income_cap = earned_income_cap_0\n    elif n_children == 1:\n        earned_income_cap = earned_income_cap_1\n    else:\n        earned_income_cap = earned_income_cap_2\n    # Phase-in: credit_rate * min(earned_income, cap)\n    phase_in_amount = credit_rate * min(earned_income, earned_income_cap)\n    # Use greater of AGI or earned income for phaseout - 32(a)(2)(B)\n    income = max(adjusted_gross_income, earned_income)\n    # Get phaseout rate based on number of children\n    if n_children == 0:\n        phaseout_rate = phaseout_rate_0\n    elif n_children == 1:\n        phaseout_rate = phaseout_rate_1\n    else:\n        phaseout_rate = phaseout_rate_2\n    # Get phaseout threshold (single/HoH base)\n    if n_children == 0:\n        phaseout_threshold = phaseout_start_0\n    else:\n        phaseout_threshold = phaseout_start_1\n    # Joint filers get higher threshold per 32(b)(2)(B)\n    if filing_status == JOINT:\n        adjusted_threshold = phaseout_threshold + joint_adjustment\n    else:\n        adjusted_threshold = phaseout_threshold\n    # Reduction = rate * (income - threshold), but not below zero\n    phase_out_amount = max(0, phaseout_rate * (income - adjusted_threshold))\n    # Final credit = phase-in minus phase-out, but not below zero\n    # Eligibility check: ineligible individuals get 0\n    if is_eligible_individual:\n        result = max(0, phase_in_amount - phase_out_amount)\n    else:\n        result = 0\n    return result\n  default: 0\n\n# 26 USC 32 - Earned Income Credit (Validation Version)\n#\nvariable eitc_validation:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Earned Income Tax Credit\"\n  description: \"Refundable credit for low-to-moderate income working individuals per 26 USC 32(a)(1)\"\n  syntax: python\n  formula: |\n    # Cap children at 3 for credit calculation\n    n_children = min(num_qualifying_children, 3)\n    # Get credit rate based on number of children - 32(a)(2)(A)\n    if n_children == 0:\n        credit_rate = credit_rate_0\n    elif n_children == 1:\n        credit_rate = credit_rate_1\n    elif n_children == 2:\n        credit_rate = credit_rate_2\n    else:\n        credit_rate = credit_rate_3\n    # Get earned income cap based on number of children\n    if n_children == 0:\n        earned_income_cap = earned_income_cap_0\n    elif n_children == 1:\n        earned_income_cap = earned_income_cap_1\n    else:\n        earned_income_cap = earned_income_cap_2\n    # Phase-in: credit_rate * min(earned_income, cap)\n    phase_in_amount = credit_rate * min(earned_income, earned_income_cap)\n    # Use greater of AGI or earned income for phaseout - 32(a)(2)(B)\n    income = max(adjusted_gross_income, earned_income)\n    # Get phaseout rate based on number of children\n    if n_children == 0:\n        phaseout_rate = phaseout_rate_0\n    elif n_children == 1:\n        phaseout_rate = phaseout_rate_1\n    else:\n        phaseout_rate = phaseout_rate_2\n    # Get phaseout threshold (single/HoH base)\n    if n_children == 0:\n        phaseout_threshold = phaseout_start_0\n    else:\n        phaseout_threshold = phaseout_start_1\n    # Joint filers get higher threshold per 32(b)(2)(B)\n    if filing_status == JOINT:\n        adjusted_threshold = phaseout_threshold + joint_adjustment\n    else:\n        adjusted_threshold = phaseout_threshold\n    # Reduction = rate * (income - threshold), but not below zero\n    phase_out_amount = max(0, phaseout_rate * (income - adjusted_threshold))\n    # Final credit = phase-in minus phase-out, but not below zero\n    # Eligibility check: ineligible individuals get 0\n    if is_eligible_individual:\n        result = max(0, phase_in_amount - phase_out_amount)\n    else:\n        result = 0\n    return result\n  default: 0",
      "path": "cosilico-us/statute/26/32.rac"
    },
    {
      "citation": "26 USC 32(a)(1)",
      "title": "Earned Income Credit",
      "text": "In the case of an eligible individual, there shall be allowed as a credit\nagainst the tax imposed by this subtitle for the taxable year an amount\nequal to the credit percentage of so much of the taxpayer's earned income\nfor the taxable year as does not exceed the earned income amount.",
      "code": "variable earned_income_credit:\n  imports:\n    - 26/32/c/2/A#earned_income\n    - 26/62/a#adjusted_gross_income\n    - 26/1#filing_status\n    - 26/32/c/1/A/i#is_eligible_individual\n    - 26/32/a/2/A#initial_credit_amount\n    - 26/32/a/2/B#credit_reduction_amount\n    - 26/32/b/2/A#agi_limit\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Earned Income Tax Credit\"\n  description: \"Refundable credit for low-to-moderate income working individuals and families per 26 USC 32(a)(1)\"\n  syntax: python\n  formula: |\n    # is_eligible_individual checks all requirements from 32(c), 32(d), and 32(i)\n    if not is_eligible_individual:\n        return 0\n    # Credit = phase-in amount minus phase-out reduction, but not below zero\n    return max(0, initial_credit_amount - credit_reduction_amount)\n  default: 0",
      "path": "cosilico-us/statute/26/32/a/1.rac"
    },
    {
      "citation": "26 USC 32(c)(1)(A)(i)",
      "title": "Eligible Individual (with Qualifying Child)",
      "text": "The term 'eligible individual' means--\n(i) in the case of an eligible individual who has 1 or more qualifying\nchildren, an individual who has a qualifying child for such taxable year\nCombined with 32(d): \"In the case of an individual who is married... this\nsection shall apply only if a joint return is filed",
      "code": "variable is_eligible_individual:\n  imports:\n    - 26/32/c/3/A#num_qualifying_children\n    - 26/32/c/1/A/ii#meets_no_child_requirements\n    - 26/32/c/1/B#is_qualifying_child_of_other\n    - 26/32/c/1/C#has_foreign_earned_income\n    - 26/32/c/1/D#is_nonresident_alien\n    - 26/32/c/1/E/i#missing_taxpayer_tin\n    - 26/32/c/1/E/ii#missing_spouse_tin\n    - 26/32/i/1#has_excessive_investment_income\n    - 26/32/d#is_mfs_filing_status\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Eligible for EITC\"\n  description: \"Whether individual meets all EITC eligibility requirements per 26 USC 32(c)(1) and 32(d)\"\n  syntax: python\n  formula: |\n    # 32(d): MFS filing status disqualifies\n    if is_mfs_filing_status:\n        return False\n    # Must have qualifying children OR meet no-child requirements\n    meets_child_requirement = (num_qualifying_children > 0) or meets_no_child_requirements\n    # Check all disqualifying conditions\n    not_disqualified = (\n        not is_qualifying_child_of_other      # 32(c)(1)(B)\n        and not has_foreign_earned_income     # 32(c)(1)(C)\n        and not is_nonresident_alien          # 32(c)(1)(D)\n        and not missing_taxpayer_tin          # 32(c)(1)(E)(i)\n        and not missing_spouse_tin            # 32(c)(1)(E)(ii)\n        and not has_excessive_investment_income  # 32(i)\n    )\n    return meets_child_requirement and not_disqualified",
      "path": "cosilico-us/statute/26/32/c/1/A/i.rac"
    },
    {
      "citation": "26 USC 32(d)",
      "title": "Married Individuals Filing Separate Returns",
      "text": "(d) Married individuals filing separate returns\nIn the case of an individual who is married (within the meaning of\nsection 7703), this section shall apply only if a joint return is filed\nfor the taxable year under section 6013.\nFor purposes of this paragraph, marital status shall be determined\nunder section 7703.",
      "code": "variable is_mfs_filing_status:\n  imports: [26/1#filing_status]\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Is Married Filing Separately\"\n  description: \"Whether filing status is MFS, disqualifying from EITC per 26 USC 32(d)\"\n  syntax: python\n  formula: |\n    # MARRIED_FILING_SEPARATELY filing status disqualifies from EITC\n    return filing_status == MARRIED_FILING_SEPARATELY",
      "path": "cosilico-us/statute/26/32/d.rac"
    },
    {
      "citation": "26 USC 3304(a)(1)",
      "title": "(3) - Coverage Requirements",
      "text": "",
      "code": "variable coverage:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"FUTA tax liability\"\n  description: \"Federal unemployment tax owed by employer per 26 USC 3301\"\n  syntax: python\n  formula: |\n    # Most employment is covered; exceptions defined in 3306(c)\n    # Exceptions include:\n    # - Agricultural labor (unless employer has 10+ workers or $20k+ payroll)\n    # - Domestic service (unless $1,000+ per quarter)\n    # - Self-employment\n    # - Federal government employees (separate system)\n    # - Certain nonprofit employees (optional coverage)\n    return is_employee and not is_excluded_employment\n  default: 0",
      "path": "cosilico-us/statute/26/3304/a.rac"
    },
    {
      "citation": "26 USC 3304(a)(4)",
      "title": "(7) - Unemployment Insurance Eligibility",
      "text": "",
      "code": "variable eligibility:\n  entity: Person\n  period: Year\n  dtype: Integer\n  unit: \"USD\"\n  label: \"Extended benefits weeks\"\n  description: \"Additional weeks available under extended benefits\"\n  syntax: python\n  formula: |\n    # Standard base period: first 4 of last 5 completed calendar quarters\n    # States may also offer \"alternate base period\" using most recent 4 quarters\n    # This calculation would typically use quarterly wage data\n    return base_period_wages\n  default: 0",
      "path": "cosilico-us/statute/26/3304/b.rac"
    },
    {
      "citation": "26 USC 36B",
      "title": "Premium Tax Credit",
      "text": "",
      "code": "variable index:\n  imports:\n    - 26/36B/a#premium_tax_credit\n    - 26/36B/b#applicable_percentage",
      "path": "cosilico-us/statute/26/36B.rac"
    },
    {
      "citation": "26 USC 36B(a)",
      "title": "Premium Tax Credit",
      "text": "(a) IN GENERAL.--In the case of an applicable taxpayer, there shall be\nallowed as a credit against the tax imposed by this subtitle for any\ntaxable year an amount equal to the premium assistance credit amount\nof the taxpayer for the taxable year.",
      "code": "variable premium_tax_credit:\n  imports:\n    - 26/62/a#adjusted_gross_income\n    - 26/1#filing_status\n    - 26/36B/b#applicable_percentage\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Additional PTC Refund\"\n  description: \"Additional refund if actual PTC exceeds advance payments\"\n  syntax: python\n  formula: |\n    # Household includes:\n    # - Taxpayer\n    # - Spouse (if filing jointly)\n    # - All dependents claimed\n    return tax_unit_size\n  default: 0",
      "path": "cosilico-us/statute/26/36B/a.rac"
    },
    {
      "citation": "26 USC 36B(b)(3)(A)",
      "title": "Applicable Percentage",
      "text": "(3) APPLICABLE PERCENTAGE.--\n(A) IN GENERAL.--The applicable percentage for any taxable year shall be\nthe percentage such that the applicable percentage for any taxpayer\nwhose household income is within an income tier specified in the\nfollowing table shall increase, on a sliding scale in a linear manner,\nfrom the initial premium percentage to the final premium percentage\nspecified in such table for such income tier...\nThis determines the \"expected contribution\" which is subtracted from",
      "code": "variable applicable_percentage:\n  entity: TaxUnit\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"Monthly Expected Premium Contribution\"\n  description: \"Monthly portion of expected premium contribution\"\n  syntax: python\n  formula: |\n    income_pct = household_income_pct_fpl\n    # Under IRA (2021-2025): Income above 400% FPL still eligible at 8.5%\n    # Below 100% FPL: No credit (Medicaid eligible in expansion states)\n    if income_pct < min_eligibility_pct_fpl:\n        return 0\n    # Bracket 1: 100-150% FPL (0% contribution under IRA)\n    if income_pct < bracket_150_pct:\n        return interpolate_bracket(\n            income_pct,\n            bracket_1.lower_fpl,\n            bracket_1.upper_fpl,\n            bracket_1.initial_pct,\n            bracket_1.final_pct\n        )\n    # Bracket 2: 150-200% FPL (0% to 2% under IRA)\n    if income_pct < bracket_200_pct:\n        return interpolate_bracket(\n            income_pct,\n            bracket_2.lower_fpl,\n            bracket_2.upper_fpl,\n            bracket_2.initial_pct,\n            bracket_2.final_pct\n        )\n    # Bracket 3: 200-250% FPL (2% to 4% under IRA)\n    if income_pct < bracket_250_pct:\n        return interpolate_bracket(\n            income_pct,\n            bracket_3.lower_fpl,\n            bracket_3.upper_fpl,\n            bracket_3.initial_pct,\n            bracket_3.final_pct\n        )\n    # Bracket 4: 250-300% FPL (4% to 6% under IRA)\n    if income_pct < bracket_300_pct:\n        return interpolate_bracket(\n            income_pct,\n            bracket_4.lower_fpl,\n            bracket_4.upper_fpl,\n            bracket_4.initial_pct,\n            bracket_4.final_pct\n        )\n    # Bracket 5: 300-400% FPL (6% to 8.5% under IRA)\n    if income_pct < bracket_400_pct:\n        return interpolate_bracket(\n            income_pct,\n            bracket_5.lower_fpl,\n            bracket_5.upper_fpl,\n            bracket_5.initial_pct,\n            bracket_5.final_pct\n        )\n    # Bracket 6: 400%+ FPL (8.5% flat under IRA - no cliff!)\n    return bracket_6.initial_pct\n  default: 0",
      "path": "cosilico-us/statute/26/36B/b.rac"
    },
    {
      "citation": "26 USC 36B(c)",
      "title": "Definition of Applicable Taxpayer",
      "text": "(c) DEFINITION AND RULES RELATING TO APPLICABLE TAXPAYER, COVERAGE MONTHS,\nAND QUALIFIED HEALTH PLAN.--\n(1) APPLICABLE TAXPAYER.--\n(A) IN GENERAL.--The term 'applicable taxpayer' means, with respect to\nany taxable year, a taxpayer whose household income for the taxable\nyear equals or exceeds 100 percent but does not exceed 400 percent\nof an amount equal to the poverty line for a family of the size\ninvolved.\n(B) SPECIAL RULE FOR CERTAIN INDIVIDUALS LAWFULLY PRESENT IN THE\nUNITED STATES.--\n(C) MARRIED COUPLES MUST FILE JOINT RETURN.--If the taxpayer is married\n(within the meaning of section 7703) at the close of the taxable\nyear, the taxpayer shall be treated as an applicable taxpayer only\nif the taxpayer and the taxpayer's spouse file a joint return for\nthe taxable year.\n(D) DENIAL OF CREDIT TO DEPENDENTS.--No credit shall be allowed under\nthis section to any individual with respect to whom a deduction\nunder section 151 is allowable to another taxpayer for a taxable\nyear beginning in the calendar year in which such individual's\ntaxable year begins.",
      "code": "variable applicable_taxpayer:\n  imports:\n    - 26/1#filing_status\n\nvariable ptc_filing_status_eligible:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"PTC Filing Status Eligible\"\n  description: \"Eligible filing status per 26 USC 36B(c)(1)(C)\"\n  syntax: python\n  formula: |\n    # Married filing separately is generally ineligible\n    # Exception: Victims of domestic abuse or spousal abandonment (not modeled)\n    result = filing_status != \"separate\"\n    return result\n\nvariable ptc_income_eligible:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"PTC Income Eligible\"\n  description: \"Household income within eligible range per 26 USC 36B(c)(1)(A)\"\n  syntax: python\n  formula: |\n    income_pct = household_income_pct_fpl\n    # Must be at least 100% FPL\n    # Those below 100% may be eligible for Medicaid\n    if income_pct < income_lower_limit:\n        return False\n    # Under IRA (2021-2025): No upper limit\n    # Credit phases out naturally via 8.5% contribution rate\n    return income_pct <= income_upper_limit_ira\n\nvariable ptc_not_dependent:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"PTC Not Claimed as Dependent\"\n  description: \"Not claimed as dependent by another per 26 USC 36B(c)(1)(D)\"\n  syntax: python\n  formula: |\n    # Taxpayer cannot be claimed as dependent by another\n    result = not is_tax_unit_dependent\n    return result\n\nvariable is_applicable_taxpayer:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Is Applicable Taxpayer for PTC\"\n  description: \"Meets all applicable taxpayer requirements per 26 USC 36B(c)(1)\"\n  syntax: python\n  formula: |\n    # All conditions must be met\n    if not ptc_filing_status_eligible:\n        return False\n    if not ptc_income_eligible:\n        return False\n    if not ptc_not_dependent:\n        return False\n    return True\n\nvariable ptc_coverage_months:\n  entity: TaxUnit\n  period: Year\n  dtype: Integer\n  label: \"PTC Coverage Months\"\n  description: \"Number of months enrolled in qualified health plan per 26 USC 36B(c)(2)\"\n  default: 0\n\nvariable enrolled_in_qualified_health_plan:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Enrolled in Qualified Health Plan\"\n  description: \"Enrolled in QHP through Marketplace per 26 USC 36B(c)(3)\"\n  default: false",
      "path": "cosilico-us/statute/26/36B/c.rac"
    },
    {
      "citation": "26 USC 36B(d)",
      "title": "Definitions and Special Rules",
      "text": "(d) TERMS RELATING TO INCOME AND FAMILIES.--For purposes of this section--\n(1) FAMILY SIZE.--The family size involved with respect to any taxpayer\nshall be equal to the number of individuals for whom the taxpayer is\nallowed a deduction under section 151 (relating to allowance of\ndeduction for personal exemptions) for the taxable year.\n(2) HOUSEHOLD INCOME.--\n(A) HOUSEHOLD INCOME.--The term 'household income' means, with respect\nto any taxpayer, an amount equal to the sum of--\n(i) the modified adjusted gross income of the taxpayer, plus\n(ii) the aggregate modified adjusted gross incomes of all other\nindividuals who... were taken into account in determining the\ntaxpayer's family size under paragraph (1)...\n(B) MODIFIED ADJUSTED GROSS INCOME.--The term 'modified adjusted gross\nincome' means adjusted gross income increased by--\n(i) any amount excluded from gross income under section 911,\n(ii) any amount of interest received or accrued by the taxpayer\nduring the taxable year which is exempt from tax, and\n(iii) an amount equal to the portion of the taxpayer's social\nsecurity benefits (as defined in section 86(d)) which is not\nincluded in gross income...\n(3) POVERTY LINE.--\n(A) IN GENERAL.--The term 'poverty line' has the meaning given that\nterm in section 2110(c)(5) of the Social Security Act (42 U.S.C.\n1397jj(c)(5)).\n(B) POVERTY LINE USED.--In the case of any qualified health plan\noffered through an Exchange for coverage during a taxable year\nbeginning in a calendar year, the poverty line used shall be the\nmost recently published poverty line as of the 1st day of the\nregular enrollment period for coverage during such calendar year.",
      "code": "variable definitions:\n  imports:\n    - 26/62/a#adjusted_gross_income\n\nvariable ptc_household_size:\n  entity: TaxUnit\n  period: Year\n  dtype: Integer\n  label: \"PTC Household Size\"\n  description: \"Family size for FPL determination per 26 USC 36B(d)(1)\"\n  syntax: python\n  formula: |\n    # Household includes:\n    # - Taxpayer (and spouse if filing jointly)\n    # - All dependents for whom deduction under section 151 is allowed\n    return tax_unit_size\n\nvariable ptc_magi:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Modified AGI for PTC\"\n  description: \"MAGI for PTC purposes per 26 USC 36B(d)(2)(B)\"\n  syntax: python\n  formula: |\n    # MAGI = AGI + excluded items:\n    # (i) Foreign earned income exclusion (Section 911)\n    # (ii) Tax-exempt interest\n    # (iii) Non-taxable Social Security benefits\n    agi = adjusted_gross_income\n    # For simplified implementation, using AGI as approximation\n    # Full implementation would add:\n    # + foreign_earned_income_exclusion\n    # + tax_exempt_interest\n    # + nontaxable_social_security_benefits\n    return agi\n\nvariable household_income:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Household Income for PTC\"\n  description: \"Modified AGI of taxpayer plus dependents per 26 USC 36B(d)(2)(A)\"\n  syntax: python\n  formula: |\n    # Household income = MAGI of taxpayer + MAGI of dependents required to file\n    # For simplicity, using tax unit MAGI (which includes all members)\n    return ptc_magi\n\nvariable ptc_federal_poverty_level:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Federal Poverty Level for PTC\"\n  description: \"FPL for household size per 26 USC 36B(d)(3) and HHS Guidelines\"\n  syntax: python\n  formula: |\n    size = ptc_household_size\n    if size <= 0:\n        return 0\n    # FPL = First person amount + (additional persons * additional amount)\n    # Uses 48 contiguous states + DC guidelines (Alaska/Hawaii have higher FPL)\n    return fpl_first_person + max(0, size - 1) * fpl_additional_person\n\nvariable household_income_pct_fpl:\n  entity: TaxUnit\n  period: Year\n  dtype: Rate\n  unit: \"/1\"\n  label: \"Household Income as Percentage of FPL\"\n  description: \"Household income relative to federal poverty level\"\n  syntax: python\n  formula: |\n    income = household_income\n    fpl = ptc_federal_poverty_level\n    if fpl <= 0:\n        return 0\n    return income / fpl\n\nvariable slcsp_premium:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Second Lowest Cost Silver Plan Premium\"\n  description: \"SLCSP benchmark premium per 26 USC 36B(b)(3)(B)\"\n  default: 0\n\nvariable slcsp_premium_monthly:\n  entity: TaxUnit\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"Monthly SLCSP Premium\"\n  description: \"Monthly portion of benchmark premium\"\n  formula: return slcsp_premium / months_per_year",
      "path": "cosilico-us/statute/26/36B/d.rac"
    },
    {
      "citation": "26 USC 36B(f)",
      "title": "Reconciliation of Credit and Advance Credit",
      "text": "(f) RECONCILIATION OF CREDIT AND ADVANCE CREDIT.--\n(1) IN GENERAL.--The amount of the credit allowed under this section for\nany taxable year shall be reduced (but not below zero) by the amount\nof any advance payment of such credit under section 1412 of the\nPatient Protection and Affordable Care Act.\n(2) EXCESS ADVANCE PAYMENTS.--\n(A) IN GENERAL.--If the advance payments to a taxpayer under section\n1412 of the Patient Protection and Affordable Care Act for a\ntaxable year exceed the credit allowed by this section (determined\nwithout regard to paragraph (1)), the tax imposed by this chapter\nfor the taxable year shall be increased by the amount of such\nexcess.\n(B) LIMITATION ON INCREASE.--\n(i) IN GENERAL.--In the case of a taxpayer whose household income is\nless than 400 percent of the poverty line for the size of the\nfamily involved for the taxable year, the amount of the increase\nunder subparagraph (A) shall in no event exceed the applicable\ndollar amount determined in accordance with the following table...",
      "code": "variable reconciliation:\n  imports:\n    - 26/36B/a#premium_tax_credit\n    - 26/1#filing_status\n\nvariable advance_ptc:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Advance Premium Tax Credit\"\n  description: \"Advance payments of PTC made during year per 26 USC 36B(f)(1)\"\n  default: 0\n\nvariable net_ptc_adjustment:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net PTC Adjustment\"\n  description: \"Difference between actual PTC and advance payments per 26 USC 36B(f)\"\n  syntax: python\n  formula: |\n    actual_credit = premium_tax_credit\n    advance = advance_ptc\n    # Positive = Additional credit due (taxpayer gets refund)\n    # Negative = Excess advance (taxpayer owes repayment)\n    return actual_credit - advance\n\nvariable excess_aptc_repayment_cap:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Excess APTC Repayment Cap\"\n  description: \"Maximum repayment of excess advance per 26 USC 36B(f)(2)(B)\"\n  syntax: python\n  formula: |\n    income_pct = household_income_pct_fpl\n    is_joint = filing_status == \"joint\"\n    # No cap for income at or above 400% FPL\n    if income_pct >= bracket_400_pct:\n        return no_repayment_cap  # No limit\n    # Cap based on income bracket and filing status\n    if income_pct < bracket_200_pct:\n        if is_joint:\n            return repay_cap_under_200_joint\n        else:\n            return repay_cap_under_200_single\n    if income_pct < bracket_300_pct:\n        if is_joint:\n            return repay_cap_200_300_joint\n        else:\n            return repay_cap_200_300_single\n    # 300-400% FPL\n    if is_joint:\n        return repay_cap_300_400_joint\n    else:\n        return repay_cap_300_400_single\n\nvariable excess_advance_ptc_repayment:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Excess Advance PTC Repayment\"\n  description: \"Additional tax due for excess advance payments per 26 USC 36B(f)(2)\"\n  syntax: python\n  formula: |\n    adjustment = net_ptc_adjustment\n    # If adjustment is positive or zero, no repayment needed\n    if adjustment >= 0:\n        return 0\n    # Excess advance (negative adjustment becomes positive repayment)\n    excess = -adjustment\n    # Apply repayment cap for those below 400% FPL\n    cap = excess_aptc_repayment_cap\n    return min(excess, cap)\n\nvariable additional_ptc_refund:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Additional PTC Refund\"\n  description: \"Additional refund if actual PTC exceeds advance payments\"\n  syntax: python\n  formula: |\n    adjustment = net_ptc_adjustment\n    # If positive, taxpayer is owed additional credit\n    return max(0, adjustment)",
      "path": "cosilico-us/statute/26/36B/f.rac"
    },
    {
      "citation": "26 USC 63",
      "title": "Taxable Income Defined / Standard Deduction",
      "text": "26 USC Section 63 - Taxable Income Defined\n\n(a) In general.-- Except as provided in subsection (b), for purposes of\nthis subtitle, the term \"taxable income\" means gross income minus the\ndeductions allowed by this chapter (other than the standard deduction).\n\n(b) Individuals who do not itemize their deductions.-- In the case of\nan individual who does not elect to itemize his deductions for the\ntaxable year, for purposes of this subtitle, the term \"taxable income\"\nmeans adjusted gross income, minus--\n(1) the standard deduction, and\n(2) the deduction for personal exemptions provided in section 151.\n\n(c) Standard deduction.--\n(1) In general.-- For purposes of this subtitle--\n(A) In the case of an individual who is not a married individual\n(as defined in section 7703) who is not a surviving spouse or head\nof household (as defined in section 2), the term \"standard deduction\"\nmeans the sum of--\n(i) the basic standard deduction, and\n(ii) the additional standard deduction.\n\n(c)(2) Basic standard deduction.-- For purposes of paragraph (1), the\nbasic standard deduction is--\n(A) 200 percent of the dollar amount in effect under subparagraph (C)\nfor the taxable year in the case of--\n(i) a joint return, or\n(ii) a surviving spouse (as defined in section 2(a)),\n(B) $4,400 in the case of a head of household (as defined in\nsection 2(b)), or\n(C) $3,000 in any other case.\n\n(c)(5) Limitation on basic standard deduction in the case of certain\ndependents.-- In the case of an individual with respect to whom a\ndeduction under section 151 is allowable to another taxpayer for a\ntaxable year beginning in the calendar year in which the individual's\ntaxable year begins, the basic standard deduction applicable to such\nindividual for such individual's taxable year shall not exceed the\ngreater of--\n(A) $500, or\n(B) the sum of $250 and such individual's earned income.\n\n(c)(6) Certain individuals, etc., not eligible for standard deduction.--\nIn the case of--\n(A) a married individual filing a separate return where either spouse\nitemizes deductions,\n(B) a nonresident alien individual, or\n(C) an individual making a return under section 443(a)(1) for a\nperiod of less than 12 months on account of a change in his annual\naccounting period,\nthe standard deduction shall be zero.\n\n(f) Aged or blind additional amounts.--\n(1) Additional amounts for the aged.-- The taxpayer shall be entitled\nto an additional amount of $600--\n(A) for himself if he has attained age 65 before the close of his\ntaxable year, and\n(B) for the spouse of the taxpayer if the spouse has attained age\n65 before the close of the taxable year and an additional exemption\nis allowable to the taxpayer for such spouse under section 151(b).\n(2) Additional amount for blind.-- The taxpayer shall be entitled\nto an additional amount of $600--\n(A) for himself if he is blind at the close of the taxable year, and\n(B) for the spouse of the taxpayer if the spouse is blind as of the\nclose of the taxable year and an additional exemption is allowable\nto the taxpayer for such spouse under section 151(b).\n(3) Higher amount for certain unmarried individuals.-- In the case of\nan individual who is not married and is not a surviving spouse,\nparagraphs (1) and (2) shall be applied by substituting \"$750\"\nfor \"$600\".",
      "code": "variable that aggregates:\n# - Basic standard deduction (63(c)(2))\n# - Dependent limitation (63(c)(5))\n# - Additional amounts for aged/blind (63(f))\n# - Ineligibility rules (63(c)(6))\n\ntext: \"\"\"\n26 USC Section 63 - Taxable Income Defined\n\n(a) In general.-- Except as provided in subsection (b), for purposes of\nthis subtitle, the term \"taxable income\" means gross income minus the\ndeductions allowed by this chapter (other than the standard deduction).\n\n(b) Individuals who do not itemize their deductions.-- In the case of\nan individual who does not elect to itemize his deductions for the\ntaxable year, for purposes of this subtitle, the term \"taxable income\"\nmeans adjusted gross income, minus--\n(1) the standard deduction, and\n(2) the deduction for personal exemptions provided in section 151.\n\n(c) Standard deduction.--\n(1) In general.-- For purposes of this subtitle--\n(A) In the case of an individual who is not a married individual\n(as defined in section 7703) who is not a surviving spouse or head\nof household (as defined in section 2), the term \"standard deduction\"\nmeans the sum of--\n(i) the basic standard deduction, and\n(ii) the additional standard deduction.\n\n(c)(2) Basic standard deduction.-- For purposes of paragraph (1), the\nbasic standard deduction is--\n(A) 200 percent of the dollar amount in effect under subparagraph (C)\nfor the taxable year in the case of--\n(i) a joint return, or\n(ii) a surviving spouse (as defined in section 2(a)),\n(B) $4,400 in the case of a head of household (as defined in\nsection 2(b)), or\n(C) $3,000 in any other case.\n\n(c)(5) Limitation on basic standard deduction in the case of certain\ndependents.-- In the case of an individual with respect to whom a\ndeduction under section 151 is allowable to another taxpayer for a\ntaxable year beginning in the calendar year in which the individual's\ntaxable year begins, the basic standard deduction applicable to such\nindividual for such individual's taxable year shall not exceed the\ngreater of--\n(A) $500, or\n(B) the sum of $250 and such individual's earned income.\n\n(c)(6) Certain individuals, etc., not eligible for standard deduction.--\nIn the case of--\n(A) a married individual filing a separate return where either spouse\nitemizes deductions,\n(B) a nonresident alien individual, or\n(C) an individual making a return under section 443(a)(1) for a\nperiod of less than 12 months on account of a change in his annual\naccounting period,\nthe standard deduction shall be zero.\n\n(f) Aged or blind additional amounts.--\n(1) Additional amounts for the aged.-- The taxpayer shall be entitled\nto an additional amount of $600--\n(A) for himself if he has attained age 65 before the close of his\ntaxable year, and\n(B) for the spouse of the taxpayer if the spouse has attained age\n65 before the close of the taxable year and an additional exemption\nis allowable to the taxpayer for such spouse under section 151(b).\n(2) Additional amount for blind.-- The taxpayer shall be entitled\nto an additional amount of $600--\n(A) for himself if he is blind at the close of the taxable year, and\n(B) for the spouse of the taxpayer if the spouse is blind as of the\nclose of the taxable year and an additional exemption is allowable\nto the taxpayer for such spouse under section 151(b).\n(3) Higher amount for certain unmarried individuals.-- In the case of\nan individual who is not married and is not a surviving spouse,\nparagraphs (1) and (2) shall be applied by substituting \"$750\"\nfor \"$600\".\n\"\"\"\n\n# Main standard deduction variable\nvariable standard_deduction:\n  imports:\n    - 26/63/c/2#basic_standard_deduction\n    - 26/63/c/5#dependent_standard_deduction\n    - 26/63/f#additional_standard_deduction\n    - 26/63/c/6#is_ineligible_for_standard_deduction\n    - 26/1#filing_status\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Standard Deduction\"\n  description: \"Total standard deduction including basic and additional amounts per 26 USC 63\"\n  syntax: python\n  formula: |\n    # 63(c)(5): Use dependent limitation if applicable\n    if is_dependent:\n        basic = dependent_standard_deduction\n    else:\n        basic = basic_standard_deduction\n    # 63(c)(6): Check for ineligibility (MFS spouse itemizes, NRA, etc.)\n    if is_ineligible_for_standard_deduction:\n        result = 0\n    else:\n        result = basic + additional_standard_deduction\n    return result\n  tests:\n    - name: \"Single filer 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: SINGLE\n        is_dependent: false\n        is_ineligible_for_standard_deduction: false\n        age: 30\n        is_blind: false\n      expect: 14600\n    - name: \"Married filing jointly 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: MARRIED_FILING_JOINTLY\n        is_dependent: false\n        is_ineligible_for_standard_deduction: false\n        age: 40\n        spouse_age: 38\n        is_blind: false\n        spouse_is_blind: false\n      expect: 29200\n    - name: \"Head of household 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: HEAD_OF_HOUSEHOLD\n        is_dependent: false\n        is_ineligible_for_standard_deduction: false\n        age: 35\n        is_blind: false\n      expect: 21900\n    - name: \"Single aged 65+ 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: SINGLE\n        is_dependent: false\n        is_ineligible_for_standard_deduction: false\n        age: 67\n        is_blind: false\n      expect: 16550\n    - name: \"Single aged and blind 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: SINGLE\n        is_dependent: false\n        is_ineligible_for_standard_deduction: false\n        age: 70\n        is_blind: true\n      expect: 18500\n    - name: \"Married both aged 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: MARRIED_FILING_JOINTLY\n        is_dependent: false\n        is_ineligible_for_standard_deduction: false\n        age: 68\n        spouse_age: 66\n        is_blind: false\n        spouse_is_blind: false\n      expect: 32300\n    - name: \"Dependent with no earned income 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: SINGLE\n        is_dependent: true\n        is_ineligible_for_standard_deduction: false\n        earned_income: 0\n        age: 16\n        is_blind: false\n      expect: 1300\n    - name: \"Dependent with $5000 earned income 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: SINGLE\n        is_dependent: true\n        is_ineligible_for_standard_deduction: false\n        earned_income: 5000\n        age: 17\n        is_blind: false\n      expect: 5450\n    - name: \"Dependent earned income capped at basic 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: SINGLE\n        is_dependent: true\n        is_ineligible_for_standard_deduction: false\n        earned_income: 20000\n        age: 19\n        is_blind: false\n      expect: 14600\n    - name: \"Ineligible - MFS spouse itemizes\"\n      period: 2024-01\n      inputs:\n        filing_status: MARRIED_FILING_SEPARATELY\n        is_dependent: false\n        is_ineligible_for_standard_deduction: true\n        age: 45\n        is_blind: false\n      expect: 0",
      "path": "cosilico-us/statute/26/63.rac"
    },
    {
      "citation": "26 USC 63(a)",
      "title": "Taxable Income Defined",
      "text": "(a) In general.— Except as provided in subsection (b), for purposes of\nthis subtitle, the term 'taxable income' means gross income minus\nthe deductions allowed by this chapter (other than the standard\ndeduction).\n(b) Individuals who do not itemize their deductions.— In the case of\nan individual who does not elect to itemize his deductions for the\ntaxable year, for purposes of this subtitle, the term 'taxable\nincome' means adjusted gross income, minus—\n(1) the standard deduction, and\n(2) the deduction for personal exemptions provided in section 151.",
      "code": "variable taxable_income:\n  imports:\n    - 26/62/a#adjusted_gross_income\n    - 26/63/e#taxable_income_deductions\n    - 26/151#personal_exemption\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Taxable Income\"\n  description: \"Adjusted gross income minus deductions per 26 USC 63\"\n  syntax: python\n  formula: |\n    agi = adjusted_gross_income\n    deductions = taxable_income_deductions\n    # Personal exemption (suspended 2018-2025 by TCJA Section 11041)\n    exemptions = personal_exemption\n    # Taxable income cannot be negative\n    return max(0, agi - deductions - exemptions)\n  default: 0",
      "path": "cosilico-us/statute/26/63/a.rac"
    },
    {
      "citation": "26 USC 63(c)(2)",
      "title": "Basic Standard Deduction",
      "text": "(c)(2) Basic standard deduction.-- For purposes of paragraph (1), the\nbasic standard deduction is--\n(A) 200 percent of the dollar amount in effect under subparagraph (C)\nfor the taxable year in the case of--\n(i) a joint return, or\n(ii) a surviving spouse (as defined in section 2(a)),\n(B) $4,400 in the case of a head of household (as defined in\nsection 2(b)), or\n(C) $3,000 in any other case.",
      "code": "variable basic_standard_deduction:\n  imports:\n    - 26/63/c/2/basic_joint#basic_joint\n    - 26/63/c/2/basic_head_of_household#basic_head_of_household\n    - 26/63/c/2/basic_single#basic_single\n    - 26/1#filing_status\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Basic Standard Deduction\"\n  description: \"Basic standard deduction amount based on filing status per 26 USC 63(c)(2)\"\n  syntax: python\n  formula: |\n    # 63(c)(2)(A): Joint return or surviving spouse\n    if filing_status == MARRIED_FILING_JOINTLY or filing_status == QUALIFYING_WIDOW:\n      return basic_joint\n    # 63(c)(2)(B): Head of household\n    if filing_status == HEAD_OF_HOUSEHOLD:\n      return basic_head_of_household\n    # 63(c)(2)(C): Single or married filing separately\n    return basic_single\n  tests:\n    - name: \"Single filer (base 1988)\"\n      period: 1988-01\n      inputs:\n        filing_status: SINGLE\n      expect: 3000\n    - name: \"Married filing jointly (base 1988)\"\n      period: 1988-01\n      inputs:\n        filing_status: MARRIED_FILING_JOINTLY\n      expect: 5000\n    - name: \"Head of household (base 1988)\"\n      period: 1988-01\n      inputs:\n        filing_status: HEAD_OF_HOUSEHOLD\n      expect: 4400\n    - name: \"Married filing separately (base 1988)\"\n      period: 1988-01\n      inputs:\n        filing_status: MARRIED_FILING_SEPARATELY\n      expect: 3000\n    - name: \"Surviving spouse (base 1988)\"\n      period: 1988-01\n      inputs:\n        filing_status: QUALIFYING_WIDOW\n      expect: 5000",
      "path": "cosilico-us/statute/26/63/c/2.rac"
    },
    {
      "citation": "26 USC 63(c)(2)(A)",
      "title": "Basic Standard Deduction for Joint Returns",
      "text": "(c)(2)(A) 200 percent of the dollar amount in effect under subparagraph (C)\nfor the taxable year in the case of--\n(i) a joint return, or\n(ii) a surviving spouse (as defined in section 2(a)).",
      "code": "# 26 USC 63(c)(2)(A) - Basic Standard Deduction for Joint Returns\n#\n# Reference: IRC Section 63(c)(2)(A), indexed per (c)(4)\n\ntext: \"\"\"\n(c)(2)(A) 200 percent of the dollar amount in effect under subparagraph (C)\nfor the taxable year in the case of--\n(i) a joint return, or\n(ii) a surviving spouse (as defined in section 2(a)).\n\"\"\"\n\n# Base statutory value from TRA86\n# Indexed values in guidance files (IRS Rev. Proc.)\nparameter basic_joint:\n  description: \"Basic standard deduction for married filing jointly or surviving spouse\"\n  unit: \"USD\"\n  indexed_by: statute/26/63/c/4\n  values:\n    1988-01-01: 5000",
      "path": "cosilico-us/statute/26/63/c/2/basic_joint.rac"
    },
    {
      "citation": "26 USC 63(c)(2)(B)",
      "title": "Basic Standard Deduction for Head of Household",
      "text": "(c)(2)(B) $4,400 in the case of a head of household (as defined in\nsection 2(b)).",
      "code": "# 26 USC 63(c)(2)(B) - Basic Standard Deduction for Head of Household\n#\n# Reference: IRC Section 63(c)(2)(B), indexed per (c)(4)\n\ntext: \"\"\"\n(c)(2)(B) $4,400 in the case of a head of household (as defined in\nsection 2(b)).\n\"\"\"\n\n# Base statutory value from IRC 63(c)(2)(B)\n# Indexed values in guidance files (IRS Rev. Proc.)\nparameter basic_head_of_household:\n  description: \"Basic standard deduction for head of household filing status\"\n  unit: \"USD\"\n  indexed_by: statute/26/63/c/4\n  values:\n    1988-01-01: 4400",
      "path": "cosilico-us/statute/26/63/c/2/basic_head_of_household.rac"
    },
    {
      "citation": "26 USC 63(c)(2)(C)",
      "title": "Basic Standard Deduction for Single/MFS",
      "text": "(c)(2)(C) $3,000 in the case of an individual who is not--\n(i) a married individual or a surviving spouse, or\n(ii) a head of household.\nThis includes single filers and married filing separately.",
      "code": "# 26 USC 63(c)(2)(C) - Basic Standard Deduction for Single/MFS\n#\n# Reference: IRC Section 63(c)(2)(C), indexed per (c)(4)\n\ntext: \"\"\"\n(c)(2)(C) $3,000 in the case of an individual who is not--\n(i) a married individual or a surviving spouse, or\n(ii) a head of household.\nThis includes single filers and married filing separately.\n\"\"\"\n\n# Base statutory value from IRC 63(c)(2)(C)\n# Indexed values in guidance files (IRS Rev. Proc.)\nparameter basic_single:\n  description: \"Basic standard deduction for single or married filing separately\"\n  unit: \"USD\"\n  indexed_by: statute/26/63/c/4\n  values:\n    1988-01-01: 3000",
      "path": "cosilico-us/statute/26/63/c/2/basic_single.rac"
    },
    {
      "citation": "26 USC 63(c)(5)",
      "title": "Limitation on Basic Standard Deduction for Dependents",
      "text": "(c)(5) Limitation on basic standard deduction in the case of certain\ndependents.-- In the case of an individual with respect to whom a\ndeduction under section 151 is allowable to another taxpayer for a\ntaxable year beginning in the calendar year in which the individual's\ntaxable year begins, the basic standard deduction applicable to such\nindividual for such individual's taxable year shall not exceed the\ngreater of--\n(A) $500, or\n(B) the sum of $250 and such individual's earned income.",
      "code": "variable dependent_standard_deduction:\n  imports:\n    - 26/63/c/5/dependent_minimum#dependent_minimum\n    - 26/63/c/5/dependent_earned_addon#dependent_earned_addon\n    - 26/63/c/2#basic_standard_deduction\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Dependent Standard Deduction\"\n  description: \"Limited standard deduction for individuals claimed as dependents per 26 USC 63(c)(5)\"\n  syntax: python\n  formula: |\n    # 63(c)(5)(A): Greater of minimum or (earned income + addon)\n    earned_plus = earned_income + dependent_earned_addon\n    dependent_amount = max(dependent_minimum, earned_plus)\n    # Cannot exceed the regular basic standard deduction\n    return min(dependent_amount, basic_standard_deduction)\n  tests:\n    - name: \"No earned income 2024\"\n      period: 2024-01\n      inputs:\n        earned_income: 0\n        filing_status: SINGLE\n      expect: 1300\n    - name: \"Low earned income 2024\"\n      period: 2024-01\n      inputs:\n        earned_income: 500\n        filing_status: SINGLE\n      expect: 1300\n    - name: \"Moderate earned income 2024\"\n      period: 2024-01\n      inputs:\n        earned_income: 5000\n        filing_status: SINGLE\n      expect: 5450\n    - name: \"High earned income capped 2024\"\n      period: 2024-01\n      inputs:\n        earned_income: 20000\n        filing_status: SINGLE\n      expect: 14600\n    - name: \"Exact threshold 2024\"\n      period: 2024-01\n      inputs:\n        earned_income: 850\n        filing_status: SINGLE\n      expect: 1300\n    - name: \"Just above threshold 2024\"\n      period: 2024-01\n      inputs:\n        earned_income: 900\n        filing_status: SINGLE\n      expect: 1350\n    - name: \"No earned income 2023\"\n      period: 2023-01\n      inputs:\n        earned_income: 0\n        filing_status: SINGLE\n      expect: 1250",
      "path": "cosilico-us/statute/26/63/c/5.rac"
    },
    {
      "citation": "26 USC 63(c)(5)(A)(i)",
      "title": "Dependent Minimum Standard Deduction",
      "text": "(c)(5)(A) In general.-- In the case of an individual with respect to whom\na deduction under section 151 is allowable to another taxpayer for a\ntaxable year beginning in the calendar year in which the individual's\ntaxable year begins, the basic standard deduction applicable to such\nindividual for such individual's taxable year shall not exceed the\ngreater of--\n(i) $500, or\n(ii) the sum of $250 and such individual's earned income.",
      "code": "# 26 USC 63(c)(5)(A)(i) - Dependent Minimum Standard Deduction\n#\n# Reference: IRC Section 63(c)(5)(A)(i), Rev. Proc. 2023-34\n\ntext: \"\"\"\n(c)(5)(A) In general.-- In the case of an individual with respect to whom\na deduction under section 151 is allowable to another taxpayer for a\ntaxable year beginning in the calendar year in which the individual's\ntaxable year begins, the basic standard deduction applicable to such\nindividual for such individual's taxable year shall not exceed the\ngreater of--\n(i) $500, or\n(ii) the sum of $250 and such individual's earned income.\n\"\"\"\n\nparameter dependent_minimum:\n  description: \"Minimum standard deduction floor for dependents\"\n  unit: \"USD\"\n  indexed_by: statute/26/63/c/4\n  values:\n    1988-01-01: 500",
      "path": "cosilico-us/statute/26/63/c/5/dependent_minimum.rac"
    },
    {
      "citation": "26 USC 63(c)(5)(A)(ii)",
      "title": "Dependent Earned Income Add-on",
      "text": "(c)(5)(A)(ii) the sum of $250 and such individual's earned income.\nThe dependent's basic standard deduction is the greater of the minimum\n($500 base) or earned income plus this add-on amount, but cannot exceed\nthe regular basic standard deduction.",
      "code": "# 26 USC 63(c)(5)(A)(ii) - Dependent Earned Income Add-on\n#\n# Reference: IRC Section 63(c)(5)(A)(ii), Rev. Proc. 2023-34\n\ntext: \"\"\"\n(c)(5)(A)(ii) the sum of $250 and such individual's earned income.\nThe dependent's basic standard deduction is the greater of the minimum\n($500 base) or earned income plus this add-on amount, but cannot exceed\nthe regular basic standard deduction.\n\"\"\"\n\nparameter dependent_earned_addon:\n  description: \"Amount added to dependent's earned income for standard deduction calculation\"\n  unit: \"USD\"\n  indexed_by: statute/26/63/c/4\n  values:\n    1988-01-01: 250",
      "path": "cosilico-us/statute/26/63/c/5/dependent_earned_addon.rac"
    },
    {
      "citation": "26 USC 63(c)(6)",
      "title": "Certain Individuals Not Eligible for Standard Deduction",
      "text": "(c)(6) Certain individuals, etc., not eligible for standard deduction.--\nIn the case of--\n(A) a married individual filing a separate return where either spouse\nitemizes deductions,\n(B) a nonresident alien individual, or\n(C) an individual making a return under section 443(a)(1) for a\nperiod of less than 12 months on account of a change in his annual\naccounting period,\nthe standard deduction shall be zero.",
      "code": "variable is_ineligible_for_standard_deduction:\n  imports:\n    - 26/1#filing_status\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Ineligible for Standard Deduction\"\n  description: \"Whether taxpayer is ineligible for standard deduction per 26 USC 63(c)(6)\"\n  syntax: python\n  formula: |\n    # 63(c)(6)(A): MFS where spouse itemizes\n    if filing_status == MARRIED_FILING_SEPARATELY and spouse_itemizes:\n      return True\n    # 63(c)(6)(B): Nonresident alien\n    if is_nonresident_alien:\n      return True\n    # 63(c)(6)(C): Short tax year - not modeled (rare edge case)\n    return False\n  tests:\n    - name: \"Single filer eligible\"\n      inputs:\n        filing_status: SINGLE\n        spouse_itemizes: false\n        is_nonresident_alien: false\n      expect: false\n    - name: \"MFJ eligible\"\n      inputs:\n        filing_status: MARRIED_FILING_JOINTLY\n        spouse_itemizes: false\n        is_nonresident_alien: false\n      expect: false\n    - name: \"MFS spouse does not itemize\"\n      inputs:\n        filing_status: MARRIED_FILING_SEPARATELY\n        spouse_itemizes: false\n        is_nonresident_alien: false\n      expect: false\n    - name: \"MFS spouse itemizes - ineligible\"\n      inputs:\n        filing_status: MARRIED_FILING_SEPARATELY\n        spouse_itemizes: true\n        is_nonresident_alien: false\n      expect: true\n    - name: \"Nonresident alien - ineligible\"\n      inputs:\n        filing_status: SINGLE\n        spouse_itemizes: false\n        is_nonresident_alien: true\n      expect: true",
      "path": "cosilico-us/statute/26/63/c/6.rac"
    },
    {
      "citation": "26 USC 63(d)",
      "title": "Itemized Deductions Defined",
      "text": "(d) Itemized deductions.— For purposes of this subtitle, the term\n'itemized deductions' means the deductions allowable under this\nchapter other than—\n(1) the deductions allowable in arriving at adjusted gross income, and\n(2) the deduction for personal exemptions provided by section 151.",
      "code": "variable itemized_deductions:\n  imports:\n    - 26/163/a#interest_deduction\n    - 26/164/b/6#salt_deduction\n    - 26/170/a#charitable_deduction\n    - 26/213/a#medical_expense_deduction\n\nvariable itemized_taxable_income_deductions:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total Itemized Deductions\"\n  description: \"Sum of allowable itemized deductions per 26 USC 63(d)\"\n  syntax: python\n  formula: |\n    # Sum all itemized deduction components\n    # Note: casualty_loss_deduction omitted pending Section 165 implementation\n    medical = medical_expense_deduction      # 213: Exceeds 7.5% AGI floor\n    salt = salt_deduction                    # 164: Capped at $10K (TCJA)\n    interest = interest_deduction            # 163: Mortgage + investment\n    charity = charitable_deduction           # 170: Subject to AGI limits\n    return medical + salt + interest + charity\n  default: 0\n\nvariable total_itemized_deductions:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total Itemized Deductions\"\n  description: \"Alias for itemized_taxable_income_deductions\"\n  syntax: python\n  formula: |\n    return itemized_taxable_income_deductions\n  default: 0",
      "path": "cosilico-us/statute/26/63/d.rac"
    },
    {
      "citation": "26 USC 63(e)",
      "title": "Election to Itemize",
      "text": "(e) Election to itemize.—\n(1) In general.— Unless an individual makes an election under this\nsubsection for the taxable year, no itemized deduction shall be\nallowed for the taxable year. For purposes of this subtitle, the\ndetermination of whether a deduction is allowable under this chapter\nshall be made without regard to the preceding sentence.\n(2) Time and manner of election.— Any election under this subsection\nshall be made on the taxpayer's return, and the Secretary shall\nprescribe the time and manner of such election.\n(3) Change of election.— Under regulations prescribed by the Secretary,\na change of election with respect to itemized deductions for any\ntaxable year may be made after the filing of the return for such\nyear. If the spouse of the taxpayer filed a separate return for\nany taxable year corresponding to the taxable year of the taxpayer,\nthe change shall not be allowed unless, in accordance with such\nregulations—\n(A) the spouse makes a change of election with respect to itemized\ndeductions, for the taxable year covered in such separate return,\nconsistent with the change of election made by the taxpayer, and\n(B) the taxpayer and spouse consent to the assessment (within such\nperiod as may be agreed on with the Secretary) of any deficiency,\nto the extent attributable to such change of election, even\nthough at the time of the filing of such consent the assessment\nof such deficiency would otherwise be prevented by the operation\nof any law or rule of law.",
      "code": "variable deduction_choice:\n  imports:\n    - 26/63/c#standard_deduction\n    - 26/63/d#itemized_taxable_income_deductions\n\nvariable uses_standard_deduction:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Uses Standard Deduction\"\n  description: \"Whether the taxpayer uses standard deduction vs itemizing per 26 USC 63(e)\"\n  syntax: python\n  formula: |\n    # Taxpayer uses standard deduction if:\n    # 1. Eligible for standard deduction (63(c)(6)), AND\n    # 2. Standard deduction >= itemized deductions\n    # If ineligible (MFS spouse itemizes, NRA, etc.), must itemize\n    if is_ineligible_for_standard_deduction:\n      return False\n    std = standard_deduction\n    itemized = itemized_taxable_income_deductions\n    # Optimal behavior: choose standard if >= itemized\n    return std >= itemized\n  default: True\n\nvariable taxable_income_deductions:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Deductions from Taxable Income\"\n  description: \"The deduction amount used (standard or itemized) per 26 USC 63\"\n  syntax: python\n  formula: |\n    std = standard_deduction\n    itemized = itemized_taxable_income_deductions\n    # If ineligible for standard deduction, must use itemized\n    if is_ineligible_for_standard_deduction:\n      return itemized\n    # Optimal behavior: use larger of the two\n    return max(std, itemized)\n  default: 0",
      "path": "cosilico-us/statute/26/63/e.rac"
    },
    {
      "citation": "26 USC 63(f)",
      "title": "Additional Amounts for Aged and Blind",
      "text": "(f) Aged or blind additional amounts.--\n(1) Additional amounts for the aged.-- The taxpayer shall be entitled\nto an additional amount of $600--\n(A) for himself if he has attained age 65 before the close of his\ntaxable year, and\n(B) for the spouse of the taxpayer if the spouse has attained age\n65 before the close of the taxable year and an additional exemption\nis allowable to the taxpayer for such spouse under section 151(b).\n(2) Additional amount for blind.-- The taxpayer shall be entitled\nto an additional amount of $600--\n(A) for himself if he is blind at the close of the taxable year, and\n(B) for the spouse of the taxpayer if the spouse is blind as of the\nclose of the taxable year and an additional exemption is allowable\nto the taxpayer for such spouse under section 151(b).\n(3) Higher amount for certain unmarried individuals.-- In the case of\nan individual who is not married and is not a surviving spouse,\nparagraphs (1) and (2) shall be applied by substituting \"$750\"\nfor \"$600\".",
      "code": "variable additional_standard_deduction:\n  imports:\n    - 26/63/f/1/additional_aged_unmarried#additional_aged_unmarried\n    - 26/63/f/1/additional_aged_married#additional_aged_married\n    - 26/63/f/2/additional_blind_unmarried#additional_blind_unmarried\n    - 26/63/f/2/additional_blind_married#additional_blind_married\n    - 26/63/f/1/aged_threshold#aged_threshold\n    - 26/1#filing_status\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Additional Standard Deduction\"\n  description: \"Additional standard deduction amounts for aged and blind taxpayers per 26 USC 63(f)\"\n  syntax: python\n  formula: |\n    # 63(f)(3): \"married\" includes surviving spouse per statute text\n    is_married = (filing_status == MARRIED_FILING_JOINTLY) or (filing_status == MARRIED_FILING_SEPARATELY) or (filing_status == QUALIFYING_WIDOW)\n    # Select amounts based on marital status\n    if is_married:\n      aged_amount = additional_aged_married\n      blind_amount = additional_blind_married\n    else:\n      aged_amount = additional_aged_unmarried\n      blind_amount = additional_blind_unmarried\n    # 63(f)(1): Primary taxpayer aged 65+\n    if age >= aged_threshold:\n      primary_aged = aged_amount\n    else:\n      primary_aged = 0\n    # 63(f)(2): Primary taxpayer blind\n    if is_blind:\n      primary_blind = blind_amount\n    else:\n      primary_blind = 0\n    # Spouse additions (joint filers only)\n    if filing_status == MARRIED_FILING_JOINTLY and spouse_age >= aged_threshold:\n      spouse_aged = aged_amount\n    else:\n      spouse_aged = 0\n    if filing_status == MARRIED_FILING_JOINTLY and spouse_is_blind:\n      spouse_blind_add = blind_amount\n    else:\n      spouse_blind_add = 0\n    return primary_aged + primary_blind + spouse_aged + spouse_blind_add\n  tests:\n    - name: \"Single under 65 not blind 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: SINGLE\n        age: 40\n        is_blind: false\n      expect: 0\n    - name: \"Single aged 65+ 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: SINGLE\n        age: 67\n        is_blind: false\n      expect: 1950\n    - name: \"Single blind under 65 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: SINGLE\n        age: 50\n        is_blind: true\n      expect: 1950\n    - name: \"Single aged and blind 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: SINGLE\n        age: 70\n        is_blind: true\n      expect: 3900\n    - name: \"MFJ neither aged 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: MARRIED_FILING_JOINTLY\n        age: 55\n        spouse_age: 52\n        is_blind: false\n        spouse_is_blind: false\n      expect: 0\n    - name: \"MFJ one spouse aged 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: MARRIED_FILING_JOINTLY\n        age: 67\n        spouse_age: 60\n        is_blind: false\n        spouse_is_blind: false\n      expect: 1550\n    - name: \"MFJ both spouses aged 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: MARRIED_FILING_JOINTLY\n        age: 68\n        spouse_age: 66\n        is_blind: false\n        spouse_is_blind: false\n      expect: 3100\n    - name: \"MFJ both aged and one blind 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: MARRIED_FILING_JOINTLY\n        age: 70\n        spouse_age: 68\n        is_blind: true\n        spouse_is_blind: false\n      expect: 4650\n    - name: \"MFJ both aged and both blind 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: MARRIED_FILING_JOINTLY\n        age: 72\n        spouse_age: 70\n        is_blind: true\n        spouse_is_blind: true\n      expect: 6200\n    - name: \"Head of household aged 2024\"\n      period: 2024-01\n      inputs:\n        filing_status: HEAD_OF_HOUSEHOLD\n        age: 66\n        is_blind: false\n      expect: 1950\n    - name: \"MFS aged 2024 (uses married amount)\"\n      period: 2024-01\n      inputs:\n        filing_status: MARRIED_FILING_SEPARATELY\n        age: 66\n        is_blind: false\n      expect: 1550\n    - name: \"Surviving spouse aged 2024 (uses married amount)\"\n      period: 2024-01\n      inputs:\n        filing_status: QUALIFYING_WIDOW\n        age: 67\n        is_blind: false\n      expect: 1550\n    - name: \"Single aged 2023\"\n      period: 2023-01\n      inputs:\n        filing_status: SINGLE\n        age: 66\n        is_blind: false\n      expect: 1850",
      "path": "cosilico-us/statute/26/63/f.rac"
    },
    {
      "citation": "26 USC 63(f)(1)",
      "title": "Additional Amount for Aged (Married)",
      "text": "(f) Aged or blind additional amounts.--\n(1) Additional amounts for the aged.-- The taxpayer shall be entitled\nto an additional amount of $600--\n(A) for himself if he has attained age 65 before the close of his\ntaxable year, and\n(B) for the spouse of the taxpayer if the spouse has attained age\n65 before the close of the taxable year and an additional exemption\nis allowable to the taxpayer for such spouse under section 151(b).\n(3) Higher amount for certain unmarried individuals.-- In the case of\nan individual who is not married and is not a surviving spouse,\nparagraphs (1) and (2) shall be applied by substituting \"$750\"\nfor \"$600\".",
      "code": "# 26 USC 63(f)(1) - Additional Amount for Aged (Married)\n#\n# Reference: IRC Section 63(f)(1), (f)(3), Rev. Proc. 2023-34\n\ntext: \"\"\"\n(f) Aged or blind additional amounts.--\n(1) Additional amounts for the aged.-- The taxpayer shall be entitled\nto an additional amount of $600--\n(A) for himself if he has attained age 65 before the close of his\ntaxable year, and\n(B) for the spouse of the taxpayer if the spouse has attained age\n65 before the close of the taxable year and an additional exemption\nis allowable to the taxpayer for such spouse under section 151(b).\n(3) Higher amount for certain unmarried individuals.-- In the case of\nan individual who is not married and is not a surviving spouse,\nparagraphs (1) and (2) shall be applied by substituting \"$750\"\nfor \"$600\".\n\"\"\"\n\n# Base statutory value from IRC 63(f)(1)\n# Indexed values in IRS guidance files\nparameter additional_aged_married:\n  description: \"Additional standard deduction for aged taxpayer who is married or surviving spouse\"\n  unit: \"USD\"\n  indexed_by: statute/26/63/f/3\n  values:\n    1988-01-01: 600",
      "path": "cosilico-us/statute/26/63/f/1/additional_aged_married.rac"
    },
    {
      "citation": "26 USC 63(f)(1)",
      "title": "Additional Amount for Aged (Unmarried)",
      "text": "(f)(3) Higher amount for certain unmarried individuals.-- In the case of\nan individual who is not married and is not a surviving spouse,\nparagraphs (1) and (2) shall be applied by substituting \"$750\"\nfor \"$600\".",
      "code": "# 26 USC 63(f)(1), (f)(3) - Additional Amount for Aged (Unmarried)\n#\n# Reference: IRC Section 63(f)(1), (f)(3), Rev. Proc. 2023-34\n\ntext: \"\"\"\n(f)(3) Higher amount for certain unmarried individuals.-- In the case of\nan individual who is not married and is not a surviving spouse,\nparagraphs (1) and (2) shall be applied by substituting \"$750\"\nfor \"$600\".\n\"\"\"\n\n# Base statutory value from IRC 63(f)(3)\n# Indexed values in IRS guidance files\nparameter additional_aged_unmarried:\n  description: \"Additional standard deduction for aged taxpayer who is single or head of household\"\n  unit: \"USD\"\n  indexed_by: statute/26/63/f/3\n  values:\n    1988-01-01: 750",
      "path": "cosilico-us/statute/26/63/f/1/additional_aged_unmarried.rac"
    },
    {
      "citation": "26 USC 63(f)(1)",
      "title": "Age Threshold for Additional Deduction",
      "text": "(f)(1) Additional amounts for the aged.-- The taxpayer shall be entitled\nto an additional amount... for himself if he has attained age 65 before\nthe close of his taxable year...",
      "code": "# 26 USC 63(f)(1) - Age Threshold for Additional Deduction\n#\n# Reference: IRC Section 63(f)(1)\n\ntext: \"\"\"\n(f)(1) Additional amounts for the aged.-- The taxpayer shall be entitled\nto an additional amount... for himself if he has attained age 65 before\nthe close of his taxable year...\n\"\"\"\n\nparameter aged_threshold:\n  description: \"Age threshold for additional aged standard deduction\"\n  unit: years\n  reference: \"26 USC 63(f)(1)\"\n  values:\n    1988-01-01: 65",
      "path": "cosilico-us/statute/26/63/f/1/aged_threshold.rac"
    },
    {
      "citation": "26 USC 63(f)(2)",
      "title": "Additional Amount for Blind (Married)",
      "text": "(f)(2) Additional amount for blind.-- The taxpayer shall be entitled\nto an additional amount of $600--\n(A) for himself if he is blind at the close of the taxable year, and\n(B) for the spouse of the taxpayer if the spouse is blind as of the\nclose of the taxable year and an additional exemption is allowable\nto the taxpayer for such spouse under section 151(b).",
      "code": "# 26 USC 63(f)(2) - Additional Amount for Blind (Married)\n#\n# Reference: IRC Section 63(f)(2), Rev. Proc. 2023-34\n\ntext: \"\"\"\n(f)(2) Additional amount for blind.-- The taxpayer shall be entitled\nto an additional amount of $600--\n(A) for himself if he is blind at the close of the taxable year, and\n(B) for the spouse of the taxpayer if the spouse is blind as of the\nclose of the taxable year and an additional exemption is allowable\nto the taxpayer for such spouse under section 151(b).\n\"\"\"\n\nparameter additional_blind_married:\n  description: \"Additional standard deduction for blind taxpayer who is married or surviving spouse\"\n  unit: \"USD\"\n  indexed_by: statute/26/63/f/3\n  values:\n    1988-01-01: 600",
      "path": "cosilico-us/statute/26/63/f/2/additional_blind_married.rac"
    },
    {
      "citation": "26 USC 63(f)(2)",
      "title": "Additional Amount for Blind (Unmarried)",
      "text": "(f)(3) Higher amount for certain unmarried individuals.-- In the case of\nan individual who is not married and is not a surviving spouse,\nparagraphs (1) and (2) shall be applied by substituting \"$750\"\nfor \"$600\".",
      "code": "# 26 USC 63(f)(2), (f)(3) - Additional Amount for Blind (Unmarried)\n#\n# Reference: IRC Section 63(f)(2), (f)(3), Rev. Proc. 2023-34\n\ntext: \"\"\"\n(f)(3) Higher amount for certain unmarried individuals.-- In the case of\nan individual who is not married and is not a surviving spouse,\nparagraphs (1) and (2) shall be applied by substituting \"$750\"\nfor \"$600\".\n\"\"\"\n\nparameter additional_blind_unmarried:\n  description: \"Additional standard deduction for blind taxpayer who is single or head of household\"\n  unit: \"USD\"\n  indexed_by: statute/26/63/f/3\n  values:\n    1988-01-01: 750",
      "path": "cosilico-us/statute/26/63/f/2/additional_blind_unmarried.rac"
    },
    {
      "citation": "26 USC Section 1",
      "title": "Filing Status",
      "text": "There is hereby imposed on the taxable income of every individual...\na tax determined in accordance with the following table",
      "code": "variable filing_status:\n  entity: TaxUnit\n  period: Year\n  dtype: Enum(FilingStatus)\n  label: \"Filing Status\"\n  description: \"Tax filing status determining applicable rate schedule\"\n\n# 26 USC Section 1 - Tax Imposed (Ordinary Income Tax)\n#\n\ntext: \"\"\"\nThere is hereby imposed on the taxable income of every individual...\na tax determined in accordance with the following table\n\"\"\"\n\n# Federal income tax brackets (base statutory values from TCJA 2017)\n# Thresholds indexed annually per IRC 1(f); base 2018 values here\n# Current indexed values in IRS Rev. Proc. guidance files\nparameter brackets:\n  description: \"Federal income tax brackets\"\n  indexed_by: statute/26/1/f\n  values:\n    # TCJA base thresholds (2018)\n    thresholds:\n      single: [0, 9525, 38700, 82500, 157500, 200000, 500000]\n      married_filing_jointly: [0, 19050, 77400, 165000, 315000, 400000, 600000]\n      married_filing_separately: [0, 9525, 38700, 82500, 157500, 200000, 300000]\n      head_of_household: [0, 13600, 51800, 82500, 157500, 200000, 500000]\n      qualifying_widow: [0, 19050, 77400, 165000, 315000, 400000, 600000]\n    # Rates are statutory (TCJA)\n    rates: [0.10, 0.12, 0.22, 0.24, 0.32, 0.35, 0.37]\n\nvariable income_tax:\n  imports:\n    - 26/1#filing_status\n\nvariable income_tax_before_credits:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Income Tax Before Credits\"\n  description: \"Federal income tax on ordinary income before credits per 26 USC Section 1\"\n  syntax: python\n  formula: |\n    if taxable_income <= 0:\n        return 0\n    return marginal_agg(taxable_income, brackets, threshold_by=filing_status)\n  default: 0\n\nvariable income_tax_before_credits_vectorized:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Income Tax Before Credits (Vectorized)\"\n  description: \"Vectorized implementation for microsimulation\"\n  syntax: python\n  formula: |\n    return marginal_agg(taxable_income, brackets, threshold_by=filing_status)\n  default: 0\n\nvariable total_federal_income_tax:\n  imports:\n    - 26/1#income_tax_before_credits\n    - 26/1/h#capital_gains_tax\n    - 26/55/a#alternative_minimum_tax\n    - 26/1411/net_investment_income_tax#net_investment_income_tax\n    - 26/1401/self_employment_tax#self_employment_tax\n    - 26/3101/b/2#additional_medicare_tax\n    - 26/26#total_nonrefundable_credits\n    - 26/6401/total_refundable_credits#total_refundable_credits\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total Federal Income Tax\"\n  description: \"Final federal income tax liability (negative = refund) per 26 USC Section 1\"\n  syntax: python\n  formula: |\n    # Regular income tax (on ordinary income)\n    regular_tax = income_tax_before_credits\n    # Capital gains are taxed at preferential rates under Section 1(h)\n    # For taxpayers with capital gains, the actual tax is computed\n    # as the lesser of regular tax or the Section 1(h) calculation\n    # For simplicity, we use the capital gains tax as an add-on here\n    cap_gains_tax = capital_gains_tax\n    # AMT is only the excess over regular tax per Section 55(a)\n    amt = alternative_minimum_tax\n    # NIIT applies in addition to all other taxes\n    niit = net_investment_income_tax\n    # Self-employment tax - aggregate from Person level\n    se_tax = sum(Person.self_employment_tax)\n    # Additional Medicare Tax\n    add_medicare = additional_medicare_tax\n    return regular_tax + cap_gains_tax + amt + niit + se_tax + add_medicare\n  default: 0",
      "path": "cosilico-us/statute/26/1.rac"
    },
    {
      "citation": "26 USC Section 1(h)",
      "title": "Maximum Capital Gains Rate",
      "text": "(h) Maximum capital gains rate.--\n(1) In general.--If a taxpayer has a net capital gain for any taxable year, the tax imposed\nby this section for such taxable year shall not exceed the sum of--\n(A) a tax computed at the rates and in the same manner as if this subsection had not been\nenacted on the greater of--\n(i) taxable income reduced by the net capital gain; or\n(ii) the lesser of-- (I) the amount of taxable income taxed at a rate below 25 percent; or\n(II) taxable income reduced by the adjusted net capital gain;\n(B) 0 percent of so much of the adjusted net capital gain (or, if less, taxable income) as\ndoes not exceed the excess (if any) of-- (i) the amount of taxable income which would\n(without regard to this paragraph) be taxed at a rate below 25 percent, over\n(ii) the taxable income reduced by the adjusted net capital gain;\n(C) 15 percent of the lesser of-- (i) so much of the adjusted net capital gain (or, if less,\ntaxable income) as exceeds the amount on which a tax is determined under subparagraph (B), or\n(ii) the excess of-- (I) the amount of taxable income which would (without regard to this\nparagraph) be taxed at a rate below 39.6 percent, over (II) the sum of the amounts on which\na tax is determined under subparagraphs (A) and (B),\n(D) 20 percent of the adjusted net capital gain (or, if less, taxable income) in excess of\nthe amount on which tax is determined under subparagraphs (B) and (C),\n...\n(11) Dividends taxed as net capital gain.--\n(A) In general.--For purposes of this subsection, the term \"net capital gain\" means net\ncapital gain (determined without regard to this paragraph) increased by qualified dividend income.",
      "code": "variable net_capital_gain:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net Capital Gain\"\n  description: \"Net long-term capital gains after netting with short-term losses per 26 USC 1222\"\n  syntax: python\n  formula: |\n    # Net capital gain = LTCG - STCL, but cannot be negative here\n    # Short-term gains are taxed as ordinary income, not preferential\n    result = max(0, long_term_capital_gains)\n    return result\n  default: 0\n\nvariable adjusted_net_capital_gain:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Adjusted Net Capital Gain\"\n  description: \"Net capital gain plus qualified dividends per Section 1(h)(11)(A)\"\n  syntax: python\n  formula: |\n    # Section 1(h)(11)(A): net capital gain increased by qualified dividend income\n    result = net_capital_gain + qualified_dividends\n    return result\n  default: 0\n\nvariable ordinary_income:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Ordinary Income for Bracket Positioning\"\n  description: \"Taxable income minus adjusted net capital gain, used to determine bracket starting position\"\n  syntax: python\n  formula: |\n    # Ordinary income = taxable income - preferential income\n    result = max(0, taxable_income - adjusted_net_capital_gain)\n    return result\n  default: 0\n\nvariable zero_rate_threshold:\n  imports:\n    - 26/1#filing_status\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"0% Rate Threshold\"\n  description: \"Maximum taxable income for 0% capital gains rate based on filing status\"\n  syntax: python\n  formula: |\n    if filing_status == JOINT:\n        return zero_rate_threshold_joint\n    elif filing_status == SURVIVING_SPOUSE:\n        return zero_rate_threshold_joint\n    elif filing_status == SEPARATE:\n        return zero_rate_threshold_separate\n    elif filing_status == HEAD_OF_HOUSEHOLD:\n        return zero_rate_threshold_hoh\n    else:\n        return zero_rate_threshold_single\n  default: 0\n\nvariable fifteen_rate_threshold:\n  imports:\n    - 26/1#filing_status\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"15% Rate Threshold\"\n  description: \"Maximum taxable income for 15% capital gains rate based on filing status\"\n  syntax: python\n  formula: |\n    if filing_status == JOINT:\n        return fifteen_rate_threshold_joint\n    elif filing_status == SURVIVING_SPOUSE:\n        return fifteen_rate_threshold_joint\n    elif filing_status == SEPARATE:\n        return fifteen_rate_threshold_separate\n    elif filing_status == HEAD_OF_HOUSEHOLD:\n        return fifteen_rate_threshold_hoh\n    else:\n        return fifteen_rate_threshold_single\n  default: 0\n\nvariable capital_gains_zero_rate_amount:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Capital Gains Taxed at 0%\"\n  description: \"Amount of adjusted net capital gain taxed at 0% per Section 1(h)(1)(B)\"\n  syntax: python\n  formula: |\n    # Section 1(h)(1)(B): 0% on ANCG up to (threshold - ordinary_income)\n    # Room in 0% bracket = threshold minus ordinary income\n    room_in_zero_bracket = max(0, zero_rate_threshold - ordinary_income)\n    # Amount taxed at 0% is lesser of room in bracket or total ANCG\n    result = min(room_in_zero_bracket, adjusted_net_capital_gain)\n    return result\n  default: 0\n\nvariable capital_gains_fifteen_rate_amount:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Capital Gains Taxed at 15%\"\n  description: \"Amount of adjusted net capital gain taxed at 15% per Section 1(h)(1)(C)\"\n  syntax: python\n  formula: |\n    # Remaining ANCG after 0% bracket\n    remaining_ancg = adjusted_net_capital_gain - capital_gains_zero_rate_amount\n    if remaining_ancg <= 0:\n        return 0\n    # Room in 15% bracket = (15% threshold - 0% threshold) adjusted for ordinary income position\n    # Start point is max(ordinary_income, zero_rate_threshold)\n    start_point = max(ordinary_income, zero_rate_threshold)\n    room_in_fifteen_bracket = max(0, fifteen_rate_threshold - start_point)\n    # Amount taxed at 15% is lesser of room in bracket or remaining ANCG\n    result = min(room_in_fifteen_bracket, remaining_ancg)\n    return result\n  default: 0\n\nvariable capital_gains_twenty_rate_amount:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Capital Gains Taxed at 20%\"\n  description: \"Amount of adjusted net capital gain taxed at 20% per Section 1(h)(1)(D)\"\n  syntax: python\n  formula: |\n    # Everything beyond the 15% bracket is taxed at 20%\n    result = max(0, adjusted_net_capital_gain - capital_gains_zero_rate_amount - capital_gains_fifteen_rate_amount)\n    return result\n  default: 0\n\nvariable capital_gains_tax:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Capital Gains Tax\"\n  description: \"Federal income tax on net capital gain and qualified dividends at preferential rates per 26 USC 1(h)\"\n  syntax: python\n  formula: |\n    # Section 1(h): Three-tier preferential rate structure\n    # 0% rate on amount in subparagraph (B)\n    tax_at_zero = capital_gains_zero_rate_amount * zero_rate\n    # 15% rate on amount in subparagraph (C)\n    tax_at_fifteen = capital_gains_fifteen_rate_amount * fifteen_rate\n    # 20% rate on remainder per subparagraph (D)\n    tax_at_twenty = capital_gains_twenty_rate_amount * twenty_rate\n    return tax_at_zero + tax_at_fifteen + tax_at_twenty\n  default: 0\n  tests:\n    - name: \"Single filer, $30k taxable income, $10k LTCG, fully in 0% bracket\"\n      period: 2018-01\n      inputs:\n        taxable_income: 30000\n        long_term_capital_gains: 10000\n        qualified_dividends: 0\n        filing_status: SINGLE\n      # Ordinary = $30k - $10k = $20k. Room in 0% = $38,600 - $20,000 = $18,600\n      # All $10k fits in 0% bracket. Tax = $0\n      expect: 0\n    - name: \"Single filer, $50k taxable income, $20k LTCG, spans 0% and 15%\"\n      period: 2018-01\n      inputs:\n        taxable_income: 50000\n        long_term_capital_gains: 20000\n        qualified_dividends: 0\n        filing_status: SINGLE\n      # Ordinary = $50k - $20k = $30k. Room in 0% = $38,600 - $30,000 = $8,600\n      # At 0%: $8,600. At 15%: $20,000 - $8,600 = $11,400\n      # Tax = $0 + $11,400 * 0.15 = $1,710\n      expect: 1710\n    - name: \"Joint filer, $500k taxable income, $50k ANCG, spans 15% and 20%\"\n      period: 2018-01\n      inputs:\n        taxable_income: 500000\n        long_term_capital_gains: 30000\n        qualified_dividends: 20000\n        filing_status: JOINT\n      # Ordinary = $500k - $50k = $450k. 0% threshold joint = $77,200\n      # 15% threshold joint = $479,000\n      # Room at 0%: max(0, $77,200 - $450,000) = $0\n      # Room at 15%: max(0, $479,000 - max($450,000, $77,200)) = $29,000\n      # At 15%: $29,000. At 20%: $50,000 - $29,000 = $21,000\n      # Tax = $29,000 * 0.15 + $21,000 * 0.20 = $4,350 + $4,200 = $8,550\n      expect: 8550\n    - name: \"Head of household, $60k taxable income, $20k ANCG\"\n      period: 2018-01\n      inputs:\n        taxable_income: 60000\n        long_term_capital_gains: 15000\n        qualified_dividends: 5000\n        filing_status: HEAD_OF_HOUSEHOLD\n      # Ordinary = $60k - $20k = $40k. 0% threshold HOH = $51,700\n      # Room in 0% = $51,700 - $40,000 = $11,700\n      # At 0%: $11,700. At 15%: $20,000 - $11,700 = $8,300\n      # Tax = $0 + $8,300 * 0.15 = $1,245\n      expect: 1245\n    - name: \"MFS, $250k taxable income, $20k LTCG, spans 15% and 20%\"\n      period: 2018-01\n      inputs:\n        taxable_income: 250000\n        long_term_capital_gains: 20000\n        qualified_dividends: 0\n        filing_status: SEPARATE\n      # Ordinary = $250k - $20k = $230k. 15% threshold MFS = $239,500\n      # Room at 15%: $239,500 - $230,000 = $9,500\n      # At 15%: $9,500. At 20%: $20,000 - $9,500 = $10,500\n      # Tax = $9,500 * 0.15 + $10,500 * 0.20 = $1,425 + $2,100 = $3,525\n      expect: 3525\n\nvariable qualified_dividend_tax:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Qualified Dividend Tax\"\n  description: \"Federal income tax on qualified dividend income at preferential rates per Section 1(h)(11)\"\n  syntax: python\n  formula: |\n    # Pro-rate the preferential tax between cap gains and qualified dividends\n    if adjusted_net_capital_gain > 0:\n      return capital_gains_tax * (qualified_dividends / adjusted_net_capital_gain)\n    return 0\n  default: 0\n\nvariable net_capital_gain_tax:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net Capital Gain Tax\"\n  description: \"Federal income tax on net capital gain (excluding qualified dividends) at preferential rates\"\n  syntax: python\n  formula: |\n    # Pro-rate the preferential tax between cap gains and qualified dividends\n    if adjusted_net_capital_gain > 0:\n      return capital_gains_tax * (net_capital_gain / adjusted_net_capital_gain)\n    return 0\n  default: 0",
      "path": "cosilico-us/statute/26/1/h.rac"
    },
    {
      "citation": "26 USC Section 1(h)(11)",
      "title": "Qualified Dividend Income",
      "text": "(11) Dividends taxed as net capital gain.--\n(A) In general.--For purposes of this subsection, the term \"net capital gain\" means net\ncapital gain (determined without regard to this paragraph) increased by qualified dividend income.\n(B) Qualified dividend income.--For purposes of this paragraph--\n(i) In general.--The term \"qualified dividend income\" means dividends received during\nthe taxable year from--\n(I) domestic corporations, and\n(II) qualified foreign corporations.\n(ii) Certain dividends excluded.--Such term shall not include--\n(I) any dividend from a corporation which for the taxable year of the corporation\nin which the distribution is made, or the preceding taxable year, is a corporation\nexempt from tax under section 501 or 521,\n(II) any amount allowed as a deduction under section 591 (relating to deduction\nfor dividends paid by mutual savings banks, etc.), and\n(III) any dividend described in section 404(k).\n(iii) Coordination with section 246(c).--Such term shall not include any dividend\non any share of stock-- (I) with respect to which the holding period requirements of\nsection 246(c) are not met...",
      "code": "variable qualified_dividend_income:\n  imports:\n    - 26/1/h#qualified_dividends\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Qualified Dividend Income\"\n  description: \"Total qualified dividend income eligible for preferential capital gains rates per 26 USC 1(h)(11)\"\n  syntax: python\n  formula: |\n    # In microsimulation, qualified dividends are provided as direct input\n    # Full implementation would aggregate is_qualified_dividend for each dividend payment\n    return qualified_dividends\n  default: 0\n  tests:\n    - name: \"Pass-through of qualified dividends input\"\n      inputs:\n        qualified_dividends: 5000\n      expect: 5000\n    - name: \"Zero qualified dividends\"\n      inputs:\n        qualified_dividends: 0\n      expect: 0",
      "path": "cosilico-us/statute/26/1/h/11.rac"
    },
    {
      "citation": "26 USC Section 11(a)",
      "title": "Corporations Subject to Tax",
      "text": "(a) Corporations in general.—A tax is hereby imposed for each taxable year\non the taxable income of every corporation.",
      "code": "variable tax_imposed:\n  entity: Corporation\n  period: Year\n  dtype: Boolean\n  label: \"Subject to Corporate Income Tax\"\n  description: \"Whether entity is subject to tax under 26 USC 11\"\n  syntax: python\n  formula: |\n    # Only C corporations are subject to corporate income tax\n    # S corporations: exempt per 26 USC 1363(a)\n    # Partnerships: exempt per 26 USC 701\n    # Sole proprietorships: taxed at individual level\n    return entity_type == C_CORPORATION",
      "path": "cosilico-us/statute/26/11/a.rac"
    },
    {
      "citation": "26 USC Section 11(b)",
      "title": "Amount of Tax",
      "text": "(b) Amount of tax.—The amount of the tax imposed by subsection (a) shall be\n21 percent of taxable income.\nPre-TCJA (1993-2017): Graduated rates from 15% to 35% with \"bubble\" rates",
      "code": "variable tax_amount:\n  entity: Corporation\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Corporate Income Tax\"\n  description: \"Federal corporate income tax under 26 USC 11\"\n  syntax: python\n  formula: |\n    # Only C corporations pay corporate income tax\n    if not is_subject_to_corporate_tax: return 0\n    # No tax on zero or negative income\n    if taxable_income <= 0: return 0\n    # Post-TCJA: flat 21% rate\n    if tax_year >= tcja_effective_year: return taxable_income * flat_rate\n    # Pre-TCJA: graduated rates with bubbles\n    return compute_graduated_tax(taxable_income, graduated_brackets)",
      "path": "cosilico-us/statute/26/11/b.rac"
    },
    {
      "citation": "26 USC Section 1201(a)",
      "title": "Alternative Tax for Corporations",
      "text": "(a) GENERAL RULE.—If for any taxable year a corporation has a net capital gain\nand any rate of tax imposed by section 11, 511, or 831(a) or (b) (whichever is\napplicable) exceeds 35 percent, then, in lieu of any such tax, there is hereby\nimposed a tax... computed as provided in paragraph (1), (2), or (3).",
      "code": "variable alternative_tax:\n  entity: Corporation\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Corporate Income Tax (with Section 1201 consideration)\"\n  description: \"Final corporate tax applying Section 1201 if beneficial\"\n  syntax: python\n  formula: |\n    # Only C corporations can use Section 1201\n    if not is_subject_to_corporate_tax:\n        return False\n    # Must have net capital gain\n    if net_capital_gain <= 0:\n        return False\n    # Post-TCJA: Regular rate (21%) is always lower than alternative (35%)\n    if tax_year >= tcja_effective_year:\n        return False\n    # Pre-TCJA: Compare regular tax vs Section 1201 tax\n    regular_tax = compute_regular_tax()\n    section_1201_tax = compute_section_1201_tax()\n    return section_1201_tax < regular_tax",
      "path": "cosilico-us/statute/26/1201/a.rac"
    },
    {
      "citation": "26 USC Section 121",
      "title": "Exclusion of Gain from Sale of Principal Residence",
      "text": "Gross income shall not include gain from the sale or exchange of property if,\nduring the 5-year period ending on the date of the sale or exchange, such\nproperty has been owned and used by the taxpayer as the taxpayer's principal\nresidence for periods aggregating 2 years or more.",
      "code": "variable principal_residence_exclusion:\n  imports: [26/1#filing_status]\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Principal Residence Gain Exclusion\"\n  description: \"Amount of gain from sale of principal residence excluded from gross income per 26 USC 121\"\n\nvariable meets_ownership_test:\n  dtype: Boolean\n  description: \"Whether taxpayer meets 2-year ownership requirement\"\n  formula: return years_owned >= ownership_required\n\nvariable meets_use_test:\n  dtype: Boolean\n  description: \"Whether taxpayer meets 2-year use requirement\"\n  formula: return years_used_as_residence >= use_required\n\nvariable meets_frequency_test:\n  dtype: Boolean\n  description: \"Whether taxpayer meets once-every-2-years limitation\"\n  syntax: python\n  formula: |\n    if not prior_exclusion_claimed:\n    return true\n    return years_since_last_exclusion >= waiting_period\n\nvariable meets_full_requirements:\n  dtype: Boolean\n  description: \"Whether taxpayer fully qualifies for exclusion\"\n  formula: return meets_ownership_test and meets_use_test and meets_frequency_test\n\nvariable qualifies_for_joint_limit:\n  dtype: Boolean\n  description: \"Whether married filing jointly qualifies for $500,000 limit\"\n  syntax: python\n  formula: |\n    if filing_status != JOINT:\n    return false\n    # Either spouse meets ownership (we assume primary taxpayer's ownership)\n    either_spouse_owns = meets_ownership_test\n    # Both spouses must meet use test\n    both_spouses_used = meets_use_test and spouse_meets_use_test\n    # Neither spouse used exclusion in prior 2 years\n    neither_used_recently = meets_frequency_test and not spouse_prior_exclusion_claimed\n    return either_spouse_owns and both_spouses_used and neither_used_recently\n\nvariable reduced_exclusion_fraction:\n  dtype: Rate\n  description: \"Fraction of full exclusion available under 121(c)\"\n  syntax: python\n  formula: |\n    if meets_full_requirements:\n    return 1.0\n    if not qualifies_for_reduced_exclusion:\n    return 0.0\n    # Fraction = shorter of (ownership/use time) or (time since last exclusion)\n    # divided by required period (2 years)\n    # Ownership fraction\n    ownership_fraction = min(years_owned / ownership_required, 1.0)\n    # Use fraction\n    use_fraction = min(years_used_as_residence / use_required, 1.0)\n    # Frequency fraction (if applicable)\n    if prior_exclusion_claimed:\n    frequency_fraction = min(years_since_last_exclusion / waiting_period, 1.0)\n    else:\n    frequency_fraction = 1.0\n    # Take the minimum of all applicable fractions\n    return min(ownership_fraction, use_fraction, frequency_fraction)\n\nvariable applicable_exclusion_limit:\n  dtype: Money\n  unit: \"USD\"\n  description: \"Maximum exclusion available based on filing status and requirements\"\n  syntax: python\n  formula: |\n    # Determine base limit\n    if qualifies_for_joint_limit:\n    base_limit = joint_limit\n    else:\n    base_limit = single_limit\n    # Apply reduced exclusion fraction if not fully meeting requirements\n    return base_limit * reduced_exclusion_fraction\n\nvariable excludable_gain:\n  dtype: Money\n  unit: \"USD\"\n  description: \"Gain eligible for exclusion (realized gain minus depreciation recapture)\"\n  syntax: python\n  formula: |\n    # Depreciation taken after May 6, 1997 is not excludable\n    # It is taxed as unrecaptured Section 1250 gain (25% rate)\n    return max(0, realized_gain_on_residence - depreciation_after_1997)\n  default: 0",
      "path": "cosilico-us/statute/26/121.rac"
    },
    {
      "citation": "26 USC Section 1223",
      "title": "--- Merged from capital_gains.rac ----",
      "text": "Section 1001(a): \"The gain from the sale or other disposition of property shall\nbe the excess of the amount realized therefrom over the adjusted basis...\nSection 1001(c): \"Except as otherwise provided in this subtitle, the entire\nexchange shall be recognized.",
      "code": "variable capital_gains:\n  imports:\n    - 26/1#filing_status\n  entity: Asset\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"FMV at Gift Date\"\n  description: \"Fair market value at date of gift\"\n  syntax: python\n  formula: |\n    # Gain = amount realized - adjusted basis\n    # If negative, it's a loss\n    return amount_realized - adjusted_basis\n  default: 0\n\n\n# ---- Merged from holding_period.rac ----\n\n# 26 USC Section 1223 - Holding Period Rules\n#\nvariable holding_period:\n  imports:\n    - 26/1001/capital_gains#is_inherited_property\n    - 26/1001/capital_gains#is_gifted_property\n    - 26/1031/like_kind_exchange#is_like_kind_exchange\n  entity: Asset\n  period: Year\n  dtype: Boolean\n  label: \"Held Substantially Identical Long-Term\"\n  description: \"Held substantially identical property long-term when short sale initiated\"\n  syntax: python\n  formula: |\n    # Calculate days between acquisition and disposition\n    # Note: Day of acquisition is excluded, day of disposition is included\n    return days_between(acquisition_date, disposition_date)\n  default: False\n\n\n# ---- Merged from netting.rac ----\n\n# 26 USC Sections 1211-1212, 1222 - Capital Gain/Loss Netting Rules\n#\nvariable netting:\n  imports:\n    - 26/1001/capital_gains#short_term_capital_gain\n    - 26/1001/capital_gains#short_term_capital_loss\n    - 26/1001/capital_gains#long_term_capital_gain\n    - 26/1001/capital_gains#long_term_capital_loss\n    - 26/1#filing_status\n    - 26/1212/carryover#short_term_capital_loss_carryover\n    - 26/1212/carryover#long_term_capital_loss_carryover\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  unit: \"USD\"\n  label: \"Has Capital Loss Carryover\"\n  description: \"Taxpayer has unused capital loss to carry forward\"\n  syntax: python\n  formula: |\n    # Include carryover losses from prior years\n    total_st_loss = short_term_capital_loss + short_term_capital_loss_carryover\n    net = short_term_capital_gain - total_st_loss\n    # Only a gain if positive\n    return max(0, net)\n  default: False\n\n\n# ---- Merged from preferential_rates.rac ----\n\n# 26 USC Section 1(h) - Preferential Capital Gains Rates (Integration)\n#\n\ntext: \"\"\"\nSection 1(h) provides three-tier preferential rates for \"net capital gain\":\n\"\"\"\nvariable preferential_rates:\n  imports:\n    - 26/1001/netting#net_capital_gain\n    - 26/1001/netting#capital_gain_net_income\n    - 26/1001/special_assets#collectibles_gain\n    - 26/1001/special_assets#section_1250_unrecaptured_gain\n    - 26/1001/special_assets#qsbs_gain_included\n    - 26/1/h#capital_gains_taxed_at_zero_pct\n    - 26/1/h#capital_gains_taxed_at_fifteen_pct\n    - 26/1/h#capital_gains_taxed_at_twenty_pct\n    - 26/1/h#capital_gains_tax\n    - 26/1/h/11/qualified_dividends#qualified_dividend_income\n    - 26/1#filing_status\n    - 26/63/c/taxable_income#taxable_income\n    - 26/1411/niit#net_investment_income_tax\n  entity: TaxUnit\n  period: Year\n  dtype: Rate\n  unit: \"USD\"\n  label: \"Ordinary Income Marginal Rate\"\n  description: \"Marginal tax rate on ordinary income\"\n  formula: return collectibles_gain * collectibles_rate\n  default: 0.22",
      "path": "cosilico-us/statute/26/1001/a.rac"
    },
    {
      "citation": "26 USC Section 1411(a)",
      "title": "Net Investment Income Tax",
      "text": "(a) In general. - In the case of an individual, there shall be imposed\n(in addition to any other tax imposed by this subtitle) for each taxable year\na tax equal to 3.8 percent of the lesser of -\n(A) net investment income for such taxable year, or\n(B) the excess (if any) of -\n(i) modified adjusted gross income for such taxable year, over\n(ii) the threshold amount.\n(b) Threshold amount. - For purposes of this chapter, the term 'threshold amount' means -\n(1) in the case of a taxpayer making a joint return under section 6013 or\na surviving spouse (as defined in section 2(a)), $250,000,\n(2) in the case of a married taxpayer (as defined in section 7703) filing a\nseparate return, one-half of the dollar amount determined under paragraph (1), and\n(3) in any other case, $200,000.\n(d) Modified adjusted gross income. - For purposes of this chapter, the term\n'modified adjusted gross income' means adjusted gross income increased by the\nexcess of -\n(1) the amount excluded from gross income under section 911(a)(1), over\n(2) the amount of any deductions (taken into account in computing adjusted\ngross income) or exclusions disallowed under section 911(d)(6) with respect\nto the amounts described in paragraph (1).",
      "code": "variable niit:\n  imports:\n    - 26/1411/c#net_investment_income\n    - 26/62/a#adjusted_gross_income\n    - 26/1#filing_status\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net Investment Income Tax\"\n  description: \"3.8% surtax on investment income for high-income taxpayers per Section 1411(a)\"\n  syntax: python\n  formula: |\n    # Section 1411(d): Modified AGI = AGI + foreign earned income exclusion\n    magi = adjusted_gross_income + foreign_earned_income_exclusion\n    # Section 1411(b): Determine threshold based on filing status\n    # (1) Joint return or surviving spouse: $250,000\n    # (2) Married filing separately: $125,000 (half of joint)\n    # (3) Any other case (single, HOH): $200,000\n    if filing_status == JOINT:\n        threshold = threshold_joint\n    elif filing_status == SURVIVING_SPOUSE:\n        threshold = threshold_joint\n    elif filing_status == SEPARATE:\n        threshold = threshold_separate\n    else:\n        threshold = threshold_other\n    # Section 1411(a)(1)(B): Excess of MAGI over threshold\n    excess_magi = max(0, magi - threshold)\n    # Section 1411(a)(1): Tax is rate (3.8%) times lesser of:\n    # (A) net investment income, or\n    # (B) excess of MAGI over threshold\n    taxable_amount = min(net_investment_income, excess_magi)\n    return niit_rate * taxable_amount\n  default: 0\n\n# Standalone validation version (no imports - accepts inputs directly)\nvariable niit_standalone:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net Investment Income Tax (Standalone)\"\n  description: \"3.8% surtax on investment income for high-income taxpayers per Section 1411(a) - validation version\"\n  syntax: python\n  formula: |\n    # Section 1411(d): Modified AGI = AGI + foreign earned income exclusion\n    magi = adjusted_gross_income + foreign_earned_income_exclusion\n    # Section 1411(b): Determine threshold based on filing status\n    # (1) Joint return or surviving spouse: $250,000\n    # (2) Married filing separately: $125,000 (half of joint)\n    # (3) Any other case (single, HOH): $200,000\n    if filing_status == JOINT:\n        threshold = threshold_joint\n    elif filing_status == SURVIVING_SPOUSE:\n        threshold = threshold_joint\n    elif filing_status == SEPARATE:\n        threshold = threshold_separate\n    else:\n        threshold = threshold_other\n    # Section 1411(a)(1)(B): Excess of MAGI over threshold\n    excess_magi = max(0, magi - threshold)\n    # Section 1411(a)(1): Tax is rate (3.8%) times lesser of:\n    # (A) net investment income, or\n    # (B) excess of MAGI over threshold\n    taxable_amount = min(net_investment_income, excess_magi)\n    return niit_rate * taxable_amount\n  default: 0",
      "path": "cosilico-us/statute/26/1411/a.rac"
    },
    {
      "citation": "26 USC Section 1411(c)",
      "title": "Net Investment Income",
      "text": "(c) Net investment income. - For purposes of this chapter -\n(1) In general. - The term 'net investment income' means the excess (if any) of -\n(A) the sum of -\n(i) gross income from interest, dividends, annuities, royalties, and rents,\nother than such income which is derived in the ordinary course of a trade\nor business not described in paragraph (2),\n(ii) other gross income derived from a trade or business described in paragraph (2), and\n(iii) net gain (to the extent taken into account in computing taxable income)\nattributable to the disposition of property other than property held in a\ntrade or business not described in paragraph (2), over\n(B) the deductions allowed by this subtitle which are properly allocable to such\ngross income or net gain.\n(2) Passive activity income. - A trade or business is described in this paragraph if -\n(A) such trade or business is a passive activity (within the meaning of section 469)\nwith respect to the taxpayer, or\n(B) such trade or business consists of trading in financial instruments or commodities.",
      "code": "variable net_investment_income:\n  imports:\n    - 26/32/i/2/C#rental_income\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net Investment Income\"\n  description: \"Net investment income for NIIT purposes per Section 1411(c)\"\n  syntax: python\n  formula: |\n    # Section 1411(c)(1)(A)(i): Investment income from interest, dividends, annuities, royalties, rents\n    # Note: Uses taxable interest only (excludes tax-exempt muni bond interest per Section 103)\n    investment_income = (\n        sum(members, taxable_interest_income) +\n        sum(members, dividend_income) +\n        sum(members, rental_income) +\n        sum(members, royalty_income) +\n        sum(members, annuity_income)\n    )\n    # Section 1411(c)(1)(A)(iii): Net capital gains (loss-limited)\n    # loss_limited_net_capital_gains is already at TaxUnit level\n    capital_gains_component = loss_limited_net_capital_gains\n    # Section 1411(c)(2): Passive business income\n    passive_component = sum(members, passive_business_income)\n    # Total NII before deductions\n    gross_nii = investment_income + capital_gains_component + passive_component\n    # Section 1411(c)(1)(B): Deductions properly allocable to NII\n    # This is a simplified calculation - full implementation would include\n    # investment interest expense, margin interest, and other allocable deductions\n    # TODO: Add allocable_investment_deductions when available\n    return max(0, gross_nii)\n  default: 0",
      "path": "cosilico-us/statute/26/1411/c.rac"
    },
    {
      "citation": "26 USC Section 151",
      "title": "Personal Exemptions",
      "text": "(a) Allowance of deductions.-- In the case of an individual, the\nexemptions provided by this section shall be allowed as deductions\nin computing taxable income.",
      "code": "variable personal_exemption:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Personal Exemption\"\n  description: \"Deduction for personal exemptions per 26 USC 151 (suspended 2018-2025)\"\n  syntax: python\n  formula: |\n    # Suspended 2018-2025 by TCJA Section 11041\n    # Returns 0 during suspension period\n    return exemption_amount\n  default: 0",
      "path": "cosilico-us/statute/26/151.rac"
    },
    {
      "citation": "26 USC Section 162(l)",
      "title": "Self-Employed Health Insurance Deduction",
      "text": "(l) Special rules for health insurance costs of self-employed individuals.—\n(1) Allowance of deduction.—In the case of an individual who is an\nemployee within the meaning of section 401(c)(1), there shall be\nallowed as a deduction under this section an amount equal to the\namount paid during the taxable year for insurance which constitutes\nmedical care for the taxpayer, his spouse, and dependents.\n(2) Limitations.—\n(A) Dollar amount.—No deduction shall be allowed under paragraph (1)\nto the extent that the amount of such deduction exceeds the\ntaxpayer's earned income derived by the taxpayer from the trade\nor business with respect to which the plan providing the medical\ncare coverage is established.",
      "code": "variable self_employed_health_insurance:\n  imports: [26/1402/a#self_employment_income]\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total Self-Employed Health Insurance Deduction\"\n  description: \"Combined self-employed health insurance deduction for tax unit\"\n  formula: return self_employment_income > 0",
      "path": "cosilico-us/statute/26/162/l.rac"
    },
    {
      "citation": "26 USC Section 165",
      "title": "Capital Losses (Stub)",
      "text": "(f) Capital losses.-- Losses from sales or exchanges of capital assets\nshall be allowed only to the extent allowed in sections 1211 and 1212.",
      "code": "variable capital_losses:\n  imports: [26/61/a/3/gains_from_property#capital_gains]\n\nvariable capital_losses:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Capital Losses\"\n  description: \"Losses from sales or exchanges of capital assets\"\n  default: 0\n\nparameter capital_loss_limit:\n  description: \"Maximum capital loss deduction per year (Section 1211(b))\"\n  unit: \"USD\"\n  values:\n    1978-01-01: 3000\n\nvariable capital_loss_deduction:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Capital Loss Deduction\"\n  description: \"Deductible capital loss (limited to $3,000)\"\n  syntax: python\n  formula: |\n    net_loss = capital_losses - capital_gains\n    if net_loss <= 0:\n        return 0\n    # Limited to $3,000 for non-MFS, $1,500 for MFS\n    # Simplified - using standard limit\n    return min(capital_loss_limit, net_loss)\n  default: 0",
      "path": "cosilico-us/statute/26/165.rac"
    },
    {
      "citation": "26 USC Section 168",
      "title": "Accelerated Cost Recovery System (MACRS)",
      "text": "(a) GENERAL RULE.—Except as otherwise provided in this section, the\ndepreciation deduction provided by section 167(a) for any tangible property\nshall be determined by using—\n(1) the applicable depreciation method,\n(2) the applicable recovery period, and\n(3) the applicable convention.",
      "code": "variable depreciation:\n  entity: Asset\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"MACRS Depreciation\"\n  description: \"Total depreciation deduction under Section 168\"\n  syntax: python\n  formula: |\n    if current_year < year_placed_in_service: return 0  # Not yet placed in service\n    return current_year - year_placed_in_service + 1\n  default: 0",
      "path": "cosilico-us/statute/26/168/a.rac"
    },
    {
      "citation": "26 USC Section 172",
      "title": "Input Variables",
      "text": "",
      "code": "variable nol_carryforward_pre_2018:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Pre-2018 NOL Carryforward\"\n  description: \"Net operating losses originating before 2018, not subject to 80% limitation\"\n  default: 0\n\nvariable nol_carryforward_post_2017:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Post-2017 NOL Carryforward\"\n  description: \"Net operating losses originating after 2017, subject to 80% limitation\"\n  default: 0\n\nvariable farming_loss_carryback:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Farming Loss Carryback\"\n  description: \"Farming loss available for 2-year carryback under Section 172(b)(1)(B)\"\n  default: 0\n\nvariable is_farming_business:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Farming Business\"\n  description: \"Whether taxpayer has a farming business per Section 263A(e)(4)\"\n  default: false\n\nvariable current_year_farming_loss:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Current Year Farming Loss\"\n  description: \"Net operating loss from farming business in current year\"\n  default: 0\n\nvariable prior_nol_deduction_claimed:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Prior NOL Deduction Claimed\"\n  description: \"NOL deduction amount claimed in current year (for modification calculation)\"\n  default: 0",
      "path": "cosilico-us/statute/26/172.rac"
    },
    {
      "citation": "26 USC Section 172(a)",
      "title": "Net Operating Loss Deduction Allowed",
      "text": "(a) Deduction allowed.-- There shall be allowed as a deduction for the\ntaxable year an amount equal to--\n(1) the aggregate of the net operating loss carryovers to such year,\nplus the net operating loss carrybacks to such year, and\n(2) in the case of a net operating loss for a taxable year beginning\nafter December 31, 2017, such deduction shall not exceed 80 percent\nof taxable income (determined without regard to the deduction\nallowed under this section).",
      "code": "variable nol_deduction:\n  imports:\n    - 26/63/a#taxable_income\n    - 26/172/b#nol_deduction_pre_2018\n    - 26/172/b#nol_deduction_post_2017\n    - 26/172/b#total_nol_carryforward\n    - 26/172#farming_loss_carryback\n\nvariable nol_deduction:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net Operating Loss Deduction\"\n  description: \"Total NOL deduction from carryforwards and carrybacks per 26 USC 172(a)\"\n  syntax: python\n  formula: |\n    # Aggregate of:\n    # (1) Pre-2018 NOL carryforwards (no 80% limit)\n    # (2) Post-2017 NOL carryforwards (80% limit applies)\n    # (3) Farming loss carrybacks (special 2-year carryback)\n    pre_2018_deduction = nol_deduction_pre_2018\n    post_2017_deduction = nol_deduction_post_2017\n    # Farming carryback applies to prior years, not current year deduction\n    # For current year, we only use carryforwards\n    farming_carryback = farming_loss_carryback\n    total = pre_2018_deduction + post_2017_deduction + farming_carryback\n    # Ensure deduction does not exceed taxable income\n    # (Should already be handled by component calculations)\n    return min(total, max(0, taxable_income))\n  default: 0\n\nvariable nol_deduction_claimed:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"NOL Deduction Claimed\"\n  description: \"Whether taxpayer claims an NOL deduction in current year\"\n  formula: return nol_deduction > 0\n  default: False\n\nvariable taxable_income_before_nol:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Taxable Income Before NOL Deduction\"\n  description: \"Taxable income computed without NOL deduction\"\n  syntax: python\n  formula: |\n    # This is used for computing the 80% limitation\n    return taxable_income + nol_deduction\n  default: 0\n\nvariable amt_nol_deduction:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"AMT NOL Deduction\"\n  description: \"NOL deduction for AMT purposes per Section 56(d)\"\n  syntax: python\n  formula: |\n    # For AMT, NOL deduction generally limited to 80% of AMTI\n    # (before NOL and QBID deductions)\n    # This is similar to regular NOL limitation\n    # For simplicity, use regular NOL deduction\n    # Full implementation would recompute with AMTI\n    return nol_deduction\n  default: 0",
      "path": "cosilico-us/statute/26/172/a.rac"
    },
    {
      "citation": "26 USC Section 172(b)",
      "title": "Net Operating Loss Carrybacks and Carryovers",
      "text": "(b) Net operating loss carrybacks and carryovers.--\n(1) Years to which loss may be carried.--\n(A) General rule.-- A net operating loss for any taxable year--\n(i) shall not be a net operating loss carryback to any taxable year\npreceding the taxable year of such loss, and\n(ii) shall be a net operating loss carryover to each taxable year\nfollowing the taxable year of the loss.\n(B) Special rules for farming losses.--\n(i) In general.-- In the case of any portion of a net operating\nloss for the taxable year which is a farming loss, such loss\nshall be a net operating loss carryback to each of the 2 taxable\nyears preceding the taxable year of such loss.",
      "code": "variable carryback_carryover:\n  imports:\n    - 26/63/a#taxable_income\n    - 26/1#filing_status\n    - 26/172#nol_carryforward_pre_tcja\n    - 26/172#nol_carryforward_post_tcja\n    - 26/172#farming_loss_carryback\n    - 26/172#is_farming_business\n    - 26/172#current_year_farming_loss\n\nvariable nol_carryforward_allowed:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"NOL Carryforward Allowed\"\n  description: \"Whether NOL can be carried forward per 172(b)(1)(A)\"\n  syntax: python\n  formula: |\n    # Post-TCJA: NOLs can be carried forward indefinitely\n    # No limitation period on carryforwards\n    return True\n  default: True\n\nvariable nol_carryback_allowed:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"NOL Carryback Allowed\"\n  description: \"Whether NOL can be carried back (generally no for post-TCJA)\"\n  syntax: python\n  formula: |\n    # Post-TCJA: General carryback eliminated\n    # Exception for farming losses under 172(b)(1)(B)\n    return False\n  default: False\n\nvariable farming_loss_carryback_allowed:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Farming Loss Carryback Allowed\"\n  description: \"Whether farming loss qualifies for carryback per 172(b)(1)(B)\"\n  syntax: python\n  formula: |\n    # Farming losses may be carried back per 172(b)(1)(B)\n    # Taxpayer must have a farming business and farming loss\n    return is_farming_business and current_year_farming_loss > 0\n  default: False\n\nvariable farming_loss_carryback_years:\n  entity: TaxUnit\n  period: Year\n  dtype: Integer\n  label: \"Farming Loss Carryback Years\"\n  description: \"Number of years farming loss can be carried back\"\n  syntax: python\n  formula: |\n    if farming_loss_carryback_allowed:\n        return farming_loss_carryback_years_param\n    else:\n        return 0\n  default: 0\n\nvariable total_nol_carryforward:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total NOL Carryforward Available\"\n  description: \"Total NOL carryforward from all prior years available for deduction\"\n  syntax: python\n  formula: |\n    # Sum of pre-TCJA and post-TCJA NOL carryforwards\n    # These are tracked separately due to different limitation rules\n    return nol_carryforward_pre_tcja + nol_carryforward_post_tcja\n  default: 0\n\nvariable nol_taxable_income_for_limitation:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Taxable Income for NOL Limitation\"\n  description: \"Taxable income computed without NOL deduction for 80% limitation\"\n  syntax: python\n  formula: |\n    # Use taxable income before NOL deduction\n    # This creates a circular dependency that must be resolved iteratively\n    # For practical purposes, we use taxable income plus any NOL already taken\n    return max(0, taxable_income)\n  default: 0\n\nvariable nol_limitation_amount:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"NOL Limitation Amount\"\n  description: \"Maximum NOL deduction based on 80% taxable income limitation\"\n  syntax: python\n  formula: |\n    # Post-TCJA NOLs limited to 80% of taxable income\n    # Pre-TCJA NOLs not subject to this limitation\n    ti = nol_taxable_income_for_limitation\n    return ti * nol_limitation_rate\n  default: 0\n\nvariable nol_deduction_pre_tcja:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Pre-TCJA NOL Deduction\"\n  description: \"NOL deduction from pre-TCJA losses (not subject to 80% limit)\"\n  syntax: python\n  formula: |\n    ti = nol_taxable_income_for_limitation\n    available = nol_carryforward_pre_tcja\n    # Pre-TCJA NOLs can offset 100% of taxable income\n    return min(available, ti)\n  default: 0\n\nvariable nol_deduction_post_tcja:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Post-TCJA NOL Deduction\"\n  description: \"NOL deduction from post-TCJA losses (subject to 80% limit)\"\n  syntax: python\n  formula: |\n    ti = nol_taxable_income_for_limitation\n    available = nol_carryforward_post_tcja\n    # First apply any pre-TCJA NOL\n    remaining_ti = max(0, ti - nol_deduction_pre_tcja)\n    # Post-TCJA NOLs limited to 80% of remaining taxable income\n    limitation = remaining_ti * nol_limitation_rate\n    return min(available, limitation)\n  default: 0\n\nvariable nol_carryforward_remaining_pre_tcja:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Remaining Pre-TCJA NOL Carryforward\"\n  description: \"Pre-TCJA NOL remaining after current year deduction\"\n  formula: return max(0, nol_carryforward_pre_tcja - nol_deduction_pre_tcja)\n  default: 0\n\nvariable nol_carryforward_remaining_post_tcja:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Remaining Post-TCJA NOL Carryforward\"\n  description: \"Post-TCJA NOL remaining after current year deduction\"\n  formula: return max(0, nol_carryforward_post_tcja - nol_deduction_post_tcja)\n  default: 0",
      "path": "cosilico-us/statute/26/172/b.rac"
    },
    {
      "citation": "26 USC Section 172(c)",
      "title": "Net Operating Loss Defined",
      "text": "(c) Net operating loss defined.-- For purposes of this section, the term\n'net operating loss' means the excess of the deductions allowed by this\nchapter over the gross income. Such excess shall be computed with the\nmodifications specified in subsection (d).",
      "code": "variable nol_defined:\n  imports:\n    - 26/62/a#adjusted_gross_income\n    - 26/63/a#taxable_income\n    - 26/172/d#nol_modifications\n\nvariable net_operating_loss:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net Operating Loss\"\n  description: \"Excess of deductions over gross income per 26 USC 172(c)\"\n  syntax: python\n  formula: |\n    # NOL = negative taxable income (before NOL deduction), with modifications\n    # Per 172(c), we compute the excess of deductions over income\n    # with modifications from 172(d)\n    modified_taxable_income = taxable_income + nol_modifications\n    # NOL only exists when modified taxable income is negative\n    if modified_taxable_income >= 0:\n        return 0\n    # Return the absolute value of the loss\n    return -modified_taxable_income\n  default: 0\n\nvariable has_net_operating_loss:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Has Net Operating Loss\"\n  description: \"Whether taxpayer has a net operating loss in the current year\"\n  formula: return net_operating_loss > 0\n  default: False",
      "path": "cosilico-us/statute/26/172/c.rac"
    },
    {
      "citation": "26 USC Section 172(d)",
      "title": "Modifications",
      "text": "(d) Modifications.-- The modifications referred to in this section are\nas follows:\n(1) Net operating loss deduction.-- No net operating loss deduction\nshall be allowed.\n(2) Capital gains and losses of taxpayers other than corporations.--\n(A) Losses from sales or exchanges of capital assets shall be\nallowed only to the extent of gains from such sales or exchanges.\n(B) Exclusions and deductions under section 1202.\n(3) Deduction for personal exemptions.-- No deduction shall be allowed\nunder section 151 (relating to personal exemptions).\n(4) Nonbusiness deductions of taxpayers other than corporations.--\n[Detailed modifications for nonbusiness deductions]",
      "code": "variable nol_modifications:\n  imports:\n    - 26/165#capital_losses\n    - 26/151#personal_exemption\n    - 26/63/c#standard_deduction\n    - 26/63/d#itemized_deductions\n    - 26/172#prior_nol_deduction_claimed\n\nvariable nol_modification_prior_nol:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"NOL Modification - Prior NOL\"\n  description: \"Add back prior year NOL deductions per 172(d)(1)\"\n  syntax: python\n  formula: |\n    # When computing current year NOL, add back any NOL deduction taken\n    # This prevents circular references and stacking of NOL deductions\n    return prior_nol_deduction_claimed\n  default: 0\n\nvariable nol_modification_capital_losses:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"NOL Modification - Capital Losses\"\n  description: \"Capital losses limited to capital gains per 172(d)(2)\"\n  syntax: python\n  formula: |\n    # Capital losses can only offset capital gains for NOL computation\n    # Excess capital losses are not part of NOL\n    net_capital = capital_gains - capital_losses\n    # If net capital gain or no loss, no modification needed\n    if net_capital >= 0:\n        return 0\n    # Disallow excess capital losses beyond what offset gains\n    # Add back the excess loss that reduced taxable income\n    excess_capital_loss = -net_capital\n    # But only to extent losses exceeded gains\n    if capital_losses > capital_gains:\n        return excess_capital_loss\n    else:\n        return 0\n  default: 0\n\nvariable nol_modification_exemptions:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"NOL Modification - Exemptions\"\n  description: \"Add back personal exemptions per 172(d)(3)\"\n  syntax: python\n  formula: |\n    # Personal exemptions are not allowed in computing NOL\n    # Add them back (though suspended 2018-2025 by TCJA)\n    return personal_exemption\n  default: 0\n\nvariable nol_modification_nonbusiness:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"NOL Modification - Nonbusiness Deductions\"\n  description: \"Limit nonbusiness deductions to nonbusiness income per 172(d)(4)\"\n  syntax: python\n  formula: |\n    # Simplified: For individuals, nonbusiness deductions (e.g., standard/itemized)\n    # cannot create or increase an NOL beyond business losses\n    # This is a complex calculation in practice; simplified here\n    # The modification ensures only business losses generate NOL\n    # Nonbusiness deductions (medical, state taxes, etc.) are limited\n    # For now, return 0 as most individual NOLs are from business losses\n    # Full implementation would track business vs. nonbusiness items\n    return 0\n  default: 0\n\nvariable nol_modifications:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total NOL Modifications\"\n  description: \"Total modifications to taxable income for NOL calculation per 172(d)\"\n  syntax: python\n  formula: |\n    # Sum all modifications that adjust taxable income for NOL purposes\n    # These are added to taxable income before determining if NOL exists\n    return (\n    nol_modification_prior_nol +\n    nol_modification_capital_losses +\n    nol_modification_exemptions +\n    nol_modification_nonbusiness\n    )\n  default: 0",
      "path": "cosilico-us/statute/26/172/d.rac"
    },
    {
      "citation": "26 USC Section 179(a)",
      "title": "Election to Expense Certain Depreciable Business Assets",
      "text": "(a) TREATMENT AS EXPENSES.—A taxpayer may elect to treat the cost of any\nsection 179 property as an expense which is not chargeable to capital account.\nAny cost so treated shall be allowed as a deduction for the taxable year in\nwhich the section 179 property is placed in service.",
      "code": "variable expensing_election:\n  entity: Business\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Section 179 Carryforward\"\n  description: \"Disallowed Section 179 amount to carry forward to next year\"\n  syntax: python\n  formula: |\n    # Start with maximum\n    max_available = maximum_deduction\n    # Calculate phaseout reduction\n    excess_investment = max(0, total_cost_of_section_179_property - phaseout_threshold)\n    phaseout_reduction = excess_investment * phaseout_rate\n    # Available after phaseout (cannot go below zero)\n    return max(0, max_available - phaseout_reduction)\n  default: 0",
      "path": "cosilico-us/statute/26/179/a.rac"
    },
    {
      "citation": "26 USC Section 215",
      "title": "Alimony, etc., Payments (Pre-2019)",
      "text": "(a) General rule.—In the case of an individual, there shall be allowed\nas a deduction an amount equal to the alimony or separate maintenance\npayments paid during such individual's taxable year.\n(b) Alimony or separate maintenance payments defined.—For purposes of\nthis section, the term 'alimony or separate maintenance payment' means\nany alimony or separate maintenance payment (as defined in section 71(b))\nwhich is includible in the gross income of the recipient under section 71.\n(10) Alimony.—The deduction allowed by section 215.",
      "code": "variable alimony_deduction:\n  imports: [26/1#filing_status]\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Alimony Deduction\"\n  description: \"Above-the-line deduction for alimony payments per 26 USC 62(a)(10) and 215\"\n  syntax: python\n  formula: |\n    # Per TCJA: Only pre-2019 divorce instruments allow alimony deduction\n    if not is_pre_2019_divorce_agreement_payer:\n    return 0\n    # Per 26 USC 215(a): Alimony paid is deductible for pre-2019 agreements\n    # The alimony_deduction_rate parameter confirms deduction rules by year\n    # but the controlling factor is the agreement date, not the tax year\n    return alimony_paid * alimony_deduction_rate\n  default: 0",
      "path": "cosilico-us/statute/26/215.rac"
    },
    {
      "citation": "26 USC Section 219",
      "title": "Retirement Savings",
      "text": "(a) Allowance of deduction.--In the case of an individual, there shall be\nallowed as a deduction an amount equal to the qualified retirement\ncontributions of the individual for the taxable year.\n(b) Maximum amount of deduction.--\n(1) The amount allowable as a deduction shall not exceed the lesser of--\n(A) the deductible amount, or\n(B) an amount equal to compensation includible in gross income.\n(c) Special rules for certain married individuals.\n(g) Limitation on deduction for active participants in certain pension plans.",
      "code": "variable ira_deduction:\n  imports:\n    - 26/219/b#ira_contribution_limit\n    - 26/219/b#ira_max_deductible_contribution\n    - 26/219/b#traditional_ira_contributions\n    - 26/219/g#ira_phaseout_ratio\n    - 26/219/g#ira_deduction_after_phaseout\n    - 26/219/g#is_active_retirement_plan_participant\n    - 26/32/c/2/A#earned_income\n    - 26/1#filing_status\n    - 26/62/a#adjusted_gross_income\n  entity: Person\n  period: Year\n  dtype: Boolean\n  unit: \"USD\"\n  label: \"Eligible for Spousal IRA\"\n  description: \"Whether individual can contribute to IRA using spouse's compensation\"\n  syntax: python\n  formula: |\n    # Must have earned income to contribute (post-SECURE, no age limit)\n    if earned_income <= 0:\n    return 0",
      "path": "cosilico-us/statute/26/219.rac"
    },
    {
      "citation": "26 USC Section 219(b)",
      "title": "Maximum Amount of Deduction",
      "text": "(1) In General.--The amount allowable as a deduction under subsection (a)\nto any individual for any taxable year shall not exceed the lesser of--\n(A) the deductible amount, or\n(B) an amount equal to the compensation includible in the individual's\ngross income for such taxable year.",
      "code": "variable contribution_limits:\n  imports: [26/32/c/2/A#earned_income]\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Maximum Deductible IRA Contribution\"\n  description: \"Lesser of contribution limit or compensation\"\n  syntax: python\n  formula: |\n    base_limit = deductible_amount\n    # 219(b)(5)(B): Add catch-up for age 50+\n    if age >= catch_up_age:\n        return base_limit + catch_up_amount\n    return base_limit",
      "path": "cosilico-us/statute/26/219/b.rac"
    },
    {
      "citation": "26 USC Section 219(g)",
      "title": "Limitation on Deduction for Active Participants",
      "text": "(1) In general.--If, for any taxable year, the individual or the\nindividual's spouse is an active participant, each of the dollar\nlimitations... shall be reduced (but not below zero) by the amount\ndetermined under paragraph (2).\n(2) Amount of reduction.--\n(A) In general.--The amount determined under this paragraph shall be\nthe amount which bears the same ratio to the dollar limitation...\nas the excess of adjusted gross income over the applicable dollar\namount bears to $10,000 ($20,000 in the case of a joint return).",
      "code": "variable phaseout:\n  imports:\n    - 26/1#filing_status\n    - 26/62/a#adjusted_gross_income\n    - 26/219/b#ira_max_deductible_contribution\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"IRA Deduction After Phase-out\"\n  description: \"IRA deduction after applying income-based phase-out\"\n  syntax: python\n  formula: |\n    # MFS has its own very narrow range\n    if filing_status == MARRIED_FILING_SEPARATELY:\n        return phaseout_mfs_start\n    elif filing_status == JOINT and not is_active_retirement_plan_participant and spouse_is_active_retirement_plan_participant:\n        # 219(g)(7): Contributor not covered but spouse is covered\n        return phaseout_spouse_covered_start\n    elif filing_status == JOINT:\n        # Contributor is covered (or neither covered - no phase-out in that case)\n        return phaseout_joint_start\n    else:\n        # Single or Head of Household\n        return phaseout_single_start\n  default: 0",
      "path": "cosilico-us/statute/26/219/g.rac"
    },
    {
      "citation": "26 USC Section 221",
      "title": "Interest on Education Loans",
      "text": "(a) Allowance of deduction\nIn the case of an individual, there shall be allowed as a deduction\nfor the taxable year an amount equal to the interest paid by the\ntaxpayer during the taxable year on any qualified education loan.\n(b) Maximum deduction\n(1) In general\nExcept as provided in paragraph (2), the deduction allowed by\nsubsection (a) for the taxable year shall not exceed $2,500.\n(2) Limitation based on modified adjusted gross income\n(A) In general\nThe amount which would (but for this paragraph) be allowable\nas a deduction under this section shall be reduced (but not\nbelow zero) by the amount determined under subparagraph (B).\n(c) Definitions\nFor purposes of this section... the term 'qualified education loan'\nmeans any indebtedness incurred by the taxpayer solely to pay\nqualified higher education expenses...\n(d) Special rules\n(1) Denial of double benefit. No deduction shall be allowed...\n(2) Married couples must file joint return. If the taxpayer is\nmarried at the close of the taxable year, the deduction shall\nbe allowed only if the taxpayer and the taxpayer's spouse file\na joint return for the taxable year.\n(3) Dependents not eligible. No deduction shall be allowed... to\nan individual with respect to whom a deduction under section\n151 is allowable to another taxpayer...",
      "code": "variable student_loan_interest:\n  imports:\n    - 26/1#filing_status\n    - 26/62/a#adjusted_gross_income\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Student Loan Interest Deduction\"\n  description: \"Above-the-line deduction for interest paid on qualified education loans\"\n  syntax: python\n  formula: |\n    # 26 USC 221(d)(2) - MFS cannot claim this deduction\n    not_mfs = filing_status != MARRIED_FILING_SEPARATELY\n    # 26 USC 221(d)(3) - Cannot be claimed as dependent\n    # Check if the primary taxpayer is claimed as dependent\n    taxpayer_not_dependent = not any(members.is_claimed_as_dependent)\n    return not_mfs and taxpayer_not_dependent",
      "path": "cosilico-us/statute/26/221.rac"
    },
    {
      "citation": "26 USC Section 221(a)",
      "title": "Allowance of Deduction",
      "text": "(a) Allowance of deduction\nIn the case of an individual, there shall be allowed as a deduction for\nthe taxable year an amount equal to the interest paid by the taxpayer\nduring the taxable year on any qualified education loan.\n(b) Maximum deduction\n(1) In general\nExcept as provided in paragraph (2), the deduction allowed by\nsubsection (a) for the taxable year shall not exceed $2,500.\n(2) Limitation based on modified adjusted gross income\n(A) In general\nThe amount which would (but for this paragraph) be allowable\nas a deduction under this section shall be reduced (but not\nbelow zero) by the amount determined under subparagraph (B).\n(B) Amount of reduction\nThe amount determined under this subparagraph is the amount\nwhich bears the same ratio to the amount which would be so\nallowable as (i) the excess of the taxpayer's modified adjusted\ngross income over $50,000 ($100,000 in the case of a joint return)\nbears to (ii) $15,000 ($30,000 in the case of a joint return).\n(d) Special rules\n(2) Married couples must file joint return\nIf the taxpayer is married at the close of the taxable year, the\ndeduction shall be allowed under subsection (a) only if the taxpayer\nand the taxpayer's spouse file a joint return for the taxable year.\n(3) Dependents not eligible\nNo deduction shall be allowed under this section to an individual\nwith respect to whom a deduction under section 151 is allowable to\nanother taxpayer for a taxable year beginning in the calendar year\nin which such individual's taxable year begins.",
      "code": "variable student_loan_deduction:\n  imports:\n    - 26/1#filing_status\n    - 26/62/a#adjusted_gross_income\n    - 26/221/b#is_qualified_education_loan\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Student Loan Interest Paid\"\n  description: \"Interest paid by the taxpayer on qualified education loans during the tax year\"\n\nvariable student_loan_interest_paid:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Claimed as Dependent\"\n  description: \"Whether the individual can be claimed as a dependent by another taxpayer under Section 151\"\n\nvariable is_claimed_as_dependent:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  label: \"Student Loan Interest Deduction Eligibility\"\n  description: \"Whether the tax unit is eligible for the student loan interest deduction\"\n\nvariable student_loan_interest_deduction_eligible:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Phase-out Start Threshold\"\n  description: \"MAGI threshold where student loan interest deduction phase-out begins\"\n  syntax: python\n  formula: |\n    # 221(d)(2): MFS cannot claim this deduction\n    not_mfs = filing_status != MARRIED_FILING_SEPARATELY\n    # 221(d)(3): Cannot be claimed as dependent by another taxpayer\n    # Check that primary taxpayer is not claimed as dependent\n    taxpayer_not_dependent = not any(members.is_claimed_as_dependent)\n    return not_mfs and taxpayer_not_dependent\n\nvariable student_loan_interest_phaseout_start:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Phase-out End Threshold\"\n  description: \"MAGI threshold where student loan interest deduction is fully phased out\"\n  syntax: python\n  formula: |\n    if filing_status == MARRIED_FILING_JOINTLY:\n        return phaseout_joint_start\n    # Single, HOH, and Qualifying Widow(er) use single thresholds\n    return phaseout_single_start\n\nvariable student_loan_interest_phaseout_end:\n  entity: TaxUnit\n  period: Year\n  dtype: Rate\n  label: \"Student Loan Interest Phase-out Ratio\"\n  description: \"Ratio of deduction reduced due to MAGI-based phase-out\"\n  syntax: python\n  formula: |\n    if filing_status == MARRIED_FILING_JOINTLY:\n        return phaseout_joint_end\n    return phaseout_single_end\n\nvariable student_loan_interest_phaseout_ratio:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Student Loan Interest Deduction (Before Phase-out)\"\n  description: \"Deduction amount before applying income-based phase-out\"\n  syntax: python\n  formula: |\n    # For Section 221, MAGI equals AGI (no add-backs required per 221(b)(2)(C))\n    # Unlike some other provisions, 221 uses AGI directly\n    magi = adjusted_gross_income\n    start = student_loan_interest_phaseout_start\n    end = student_loan_interest_phaseout_end\n    range = end - start\n    # Below phase-out start: no reduction\n    if magi <= start:\n        return 0\n    # Above phase-out end: fully phased out\n    if magi >= end:\n        return 1\n    # Per 221(b)(2)(B): proportional reduction within phase-out range\n    # Reduction ratio = (MAGI - threshold) / phase-out range\n    return (magi - start) / range\n\nvariable student_loan_interest_deduction_before_phaseout:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Student Loan Interest Deduction\"\n  description: \"Above-the-line deduction for interest paid on qualified education loans per 26 USC 221\"\n  syntax: python\n  formula: |\n    # Sum interest paid by all members of the tax unit\n    total_interest = sum(members.student_loan_interest_paid)\n    # 221(b)(1): Cannot exceed maximum deduction ($2,500)\n    return min(total_interest, max_deduction)\n\nvariable student_loan_interest_deduction:\n  syntax: python\n  formula: |\n    # Check eligibility per 221(d)\n    if not student_loan_interest_deduction_eligible:\n        return 0\n    # Get base deduction (capped at maximum per 221(b)(1))\n    base = student_loan_interest_deduction_before_phaseout\n    # Apply phase-out per 221(b)(2)\n    phaseout = student_loan_interest_phaseout_ratio\n    # 221(b)(2)(A): Reduce by phase-out amount, but not below zero\n    return max(base * (1 - phaseout), 0)",
      "path": "cosilico-us/statute/26/221/a.rac"
    },
    {
      "citation": "26 USC Section 221(d)",
      "title": "Definitions",
      "text": "(d) Definitions\nFor purposes of this section--\n(1) Qualified education loan\nThe term 'qualified education loan' means any indebtedness incurred\nby the taxpayer solely to pay qualified higher education expenses--\n(A) which are incurred on behalf of the taxpayer, the taxpayer's\nspouse, or any dependent of the taxpayer as of the time the\nindebtedness was incurred,\n(B) which are paid or incurred within a reasonable period of time\nbefore or after the indebtedness is incurred, and\n(C) which are attributable to education furnished during a period\nduring which the recipient was an eligible student.\nSuch term includes indebtedness used to refinance indebtedness which\nqualifies as a qualified education loan. The term 'qualified education\nloan' shall not include any indebtedness owed to a person who is\nrelated (within the meaning of section 267(b) or 707(b)(1)) to the\ntaxpayer or to any person by reason of a loan under any qualified\nemployer plan (as defined in section 72(p)(4)) or under any contract\nreferred to in section 72(p)(5).\n(4) Eligible student\nThe term 'eligible student' has the meaning given such term by\nsection 25A(b)(3).\n(5) Dependent\nThe term 'dependent' has the meaning given such term by section 152\n(determined without regard to subsections (b)(1), (b)(2), and (d)(1)(B)\nthereof).\n(6) Qualified higher education expenses\nThe term 'qualified higher education expenses' has the meaning given\nsuch term by section 529(e)(3) (determined by substituting 'eligible\neducational institution' for 'eligible educational institution (as\ndefined in section 25A(f)(2))'.",
      "code": "variable qualified_loan:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Has Qualified Education Loan\"\n  description: \"Whether the individual has a loan that qualifies under Section 221(d)(1)\"\n\nvariable has_qualified_education_loan:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Qualified Higher Education Expenses\"\n  description: \"Expenses qualifying under Section 221(d)(6), referencing Section 529(e)(3)\"\n\nvariable qualified_higher_education_expenses_221:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Attends Eligible Educational Institution\"\n  description: \"Whether the individual attends an institution eligible under Section 221\"\n\nvariable attends_eligible_educational_institution:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Qualified Loan Beneficiary\"\n  description: \"Whether education expenses were for taxpayer, spouse, or dependent\"\n\nvariable is_qualified_loan_beneficiary:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Has Excluded Related-Party Loan\"\n  description: \"Whether the loan is from a related person and thus excluded from Section 221\"\n  syntax: python\n  formula: |\n    # The loan must be for education of:\n    # - The taxpayer themselves, OR\n    # - The taxpayer's spouse, OR\n    # - A dependent of the taxpayer (at time debt incurred)\n    #\n    # Note: Dependent status is determined at time loan was incurred,\n    # not at time interest is paid\n    return True  # Typically input-based determination\n\nvariable has_excluded_related_party_loan:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Has Qualifying Refinanced Loan\"\n  description: \"Whether a refinanced loan qualifies under Section 221(d)(1)\"\n\nvariable has_qualifying_refinanced_loan:",
      "path": "cosilico-us/statute/26/221/b.rac"
    },
    {
      "citation": "26 USC Section 223(b)",
      "title": "HSA Contribution Limits",
      "text": "(b) Limitations.—\n(1) In general.—The amount allowable as a deduction under subsection\n(a) to an individual for the taxable year shall not exceed the\nsum of the monthly limitations for months during such taxable\nyear that the individual is an eligible individual.\n(2) Monthly limitation.—The monthly limitation for any month is\n1/12 of—\n(A) in the case of an eligible individual who has self-only\ncoverage under a high deductible health plan as of the first\nday of such month, $2,250 ($4,150 for 2024), and\n(B) in the case of an eligible individual who has family\ncoverage under a high deductible health plan as of the first\nday of such month, $4,500 ($8,300 for 2024).\n(3) Additional contributions for individuals 55 or older.—\n(A) In general.—In the case of an individual who has attained\nage 55 before the close of the taxable year, the applicable\nlimitation under subparagraphs (A) and (B) of paragraph (2)\nshall be increased by the additional contribution amount.\n(B) Additional contribution amount.—For purposes of this section,\nthe term 'additional contribution amount' means $1,000.\n(5) Special rule for married individuals.—In the case of individuals\nwho are married to each other, if either spouse has family\ncoverage—\n(A) both shall be treated as having only such family coverage,\nand\n(B) the limitation under paragraph (1) shall be divided equally\nbetween them unless they agree on a different division.\n(6) Denial of deduction to dependents.—No deduction shall be\nallowed under this section to any individual with respect to\nwhom a deduction under section 151 is allowable to another\ntaxpayer for a taxable year beginning in the calendar year in\nwhich such individual's taxable year begins.\n(7) Medicare eligible individuals.—The limitation under this\nsubsection for any month with respect to an individual shall\nbe zero for the first month such individual is entitled to\nbenefits under title XVIII of the Social Security Act and for\neach month thereafter.",
      "code": "variable contribution_limits:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"HSA Excess Contributions\"\n  description: \"Contributions exceeding the limit (subject to excise tax)\"\n  formula: return hsa_contributions_self + hsa_contributions_employer\n  default: 12\n\n\nvariable hdhp_requirements:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  unit: \"USD\"\n  label: \"Can Be Claimed as Dependent\"\n  description: \"Whether the individual can be claimed as a dependent on another person's return\"\n  syntax: python\n  formula: |\n    if hdhp_coverage_type == self_only: return hdhp_min_deductible_self_only\n    if hdhp_coverage_type == family: return hdhp_min_deductible_family\n    return 0\n  default: false\n\n\nvariable hsa_deduction:\n  imports:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"HSA Additional Tax\"\n  description: \"20% additional tax on non-qualified HSA distributions\"\n  syntax: python\n  formula: |\n    # Must be an eligible individual\n    if not is_hsa_eligible:\n    return 0\n  default: false",
      "path": "cosilico-us/statute/26/223.rac"
    },
    {
      "citation": "26 USC Section 225",
      "title": "Qualified Overtime Compensation Deduction",
      "text": "(a) In general.—There shall be allowed as a deduction an amount equal to\nthe qualified overtime compensation received during the taxable year and\nincluded on statements furnished to the individual pursuant to section\n6041(d)(4) or 6051(a)(19).\n- Section 225(c): Only FLSA Section 7 overtime premium qualifies (the \"half",
      "code": "variable qualified_overtime_deduction:\n  imports:\n    - 26/1#filing_status\n    - 26/62/a#adjusted_gross_income\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Qualified Overtime Compensation Deduction\"\n  description: \"Above-the-line deduction for qualified overtime compensation per 26 USC 225\"\n  syntax: python\n  formula: |\n    # Section 225(g): No deduction after the termination year\n    if tax_year > termination_final_year:\n        return 0\n    # Section 225(e): Married individuals must file jointly\n    if filing_status == MARRIED_FILING_SEPARATELY:\n        return 0\n    # Section 225(d): SSN required (assumed valid if filing)\n    # Section 225(c)(1): Only FLSA Section 7 premium qualifies\n    # (the excess over regular rate, i.e., the \"half\" in time-and-a-half)\n    # This is an input variable provided by the taxpayer/employer\n    overtime_premium = qualified_overtime_compensation\n    # Section 225(b)(1): Apply maximum deduction cap\n    max_deduction = max_deduction_joint if filing_status == JOINT else max_deduction_single\n    capped_deduction = min(overtime_premium, max_deduction)\n    # Section 225(b)(2): Calculate phase-out based on MAGI\n    # Section 225(b)(2)(B): MAGI = AGI + Section 911/931/933 exclusions\n    magi = adjusted_gross_income + foreign_earned_income_exclusion + guam_income_exclusion + american_samoa_income_exclusion\n    phaseout_threshold = phaseout_threshold_joint if filing_status == JOINT else phaseout_threshold_single\n    # Section 225(b)(2)(A): Reduction = $100 per $1,000 over threshold\n    excess_income = max(0, magi - phaseout_threshold)\n    reduction_increments = floor(excess_income / phaseout_income_increment)\n    reduction = reduction_increments * phaseout_reduction_per_increment\n    # Deduction = capped amount minus phase-out reduction, but not below zero\n    return max(0, capped_deduction - reduction)\n  default: 0",
      "path": "cosilico-us/statute/26/225/a.rac"
    },
    {
      "citation": "26 USC Section 225(c)",
      "title": "Qualified Overtime Compensation Defined",
      "text": "(c) Qualified overtime compensation.—\n(1) In general.—For purposes of this section, the term 'qualified overtime\ncompensation' means overtime compensation paid to an individual required\nunder section 7 of the Fair Labor Standards Act of 1938 that is in excess\nof the regular rate (as used in such section) at which such individual\nis employed.\n(2) Exclusions.—Such term shall not include any qualified tip (as defined\nin section 224(d)).",
      "code": "variable qualified_overtime_compensation:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Qualified Overtime Compensation\"\n  description: \"Overtime premium for FLSA Section 7 covered employees (the excess over regular rate)\"\n  default: 0",
      "path": "cosilico-us/statute/26/225/c.rac"
    },
    {
      "citation": "26 USC Section 24",
      "title": "Child Tax Credit (Nonrefundable Portion)",
      "text": "",
      "code": "variable child_tax_credit:\n  imports:\n    - 26/26/a#tax_liability_before_credits\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Child Tax Credit (Nonrefundable)\"\n  description: \"Nonrefundable portion of Child Tax Credit per 26 USC Section 24, limited by tax liability\"\n  syntax: python\n  formula: |\n    # CTC is limited to tax liability per §26(a)\n    return min(tentative_child_tax_credit, tax_liability_before_credits)\n\n# 26 USC Section 24 - Child Tax Credit (Standalone Validation Version)\n#\nvariable ctc_standalone:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total Child Tax Credit\"\n  description: \"Sum of nonrefundable CTC and refundable ACTC per 26 USC Section 24\"\n  syntax: python\n  formula: |\n    if filing_status == JOINT: return PHASEOUT_THRESHOLD_JOINT\n    if filing_status == SURVIVING_SPOUSE: return PHASEOUT_THRESHOLD_JOINT\n    return PHASEOUT_THRESHOLD_SINGLE\n\n# 26 USC Section 24 - Child Tax Credit (Validation Version)\n#\nvariable ctc_validation:\n  imports:\n    - 26/24/h/2/credit_amount#credit_amount as ctc_credit_amount_param\n    - 26/24/h/4/other_dependent_amount#other_dependent_amount as ctc_other_dependent_amount_param\n    - 26/24/b/1/threshold#phaseout_threshold_joint as ctc_phaseout_threshold_joint_param\n    - 26/24/b/1/threshold#phaseout_threshold_single as ctc_phaseout_threshold_single_param\n    - 26/24/b/2/phaseout_rate#phaseout_rate as ctc_phaseout_rate_param\n    - 26/24/ctc_phaseout_increment#phaseout_increment as ctc_phaseout_increment_param\n    - 26/24/h/5/refundable_maximum#refundable_maximum as actc_refundable_maximum_param\n    - 26/24/d/1/B/parameters#earned_income_threshold as actc_earned_income_threshold_param\n    - 26/24/d/1/B/parameters#refundable_rate as actc_refundable_rate_param\n    - 26/24/actc_qualifying_children_threshold#qualifying_children_ss_threshold\n\nvariable num_qualifying_children:\n  entity: TaxUnit\n  period: Year\n  dtype: Count\n  label: \"Number of CTC Qualifying Children\"\n  description: \"Count of children qualifying for Child Tax Credit per Section 24(c)\"\n  default: 0\n\nvariable num_other_dependents:\n  entity: TaxUnit\n  period: Year\n  dtype: Count\n  label: \"Number of Other Dependents\"\n  description: \"Count of other dependents qualifying for $500 credit per Section 24(h)(4)\"\n  default: 0\n\nvariable adjusted_gross_income:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Adjusted Gross Income\"\n  description: \"AGI per Section 62\"\n  default: 0\n\nvariable earned_income:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Earned Income\"\n  description: \"Earned income for ACTC calculation per Section 24(d)(1)(B)\"\n  default: 0\n\nvariable tax_liability_before_credits:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Tax Liability Before Credits\"\n  description: \"Income tax before nonrefundable credits per Section 26(a)\"\n  default: 0\n\nvariable social_security_taxes:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Social Security Taxes\"\n  description: \"Employee portion of FICA taxes for ACTC calculation\"\n  default: 0\n\nvariable earned_income_credit:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Earned Income Credit\"\n  description: \"EITC amount for ACTC calculation with 3+ children\"\n  default: 0\n\nvariable filing_status:\n  entity: TaxUnit\n  period: Year\n  dtype: Enum(FilingStatus)\n  label: \"Filing Status\"\n  description: \"Federal income tax filing status per Section 1\"\n  default: SINGLE\n\nvariable ctc_credit_amount:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CTC Credit Amount Per Child\"\n  description: \"Credit amount per qualifying child per 26 USC 24(h)(2)\"\n  formula: return ctc_credit_amount_param\n\nvariable ctc_other_dependent_amount:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Other Dependent Credit Amount\"\n  description: \"Credit amount per other dependent per 26 USC 24(h)(4)\"\n  formula: return ctc_other_dependent_amount_param\n\nvariable ctc_phaseout_threshold_joint:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CTC Phase-Out Threshold (Joint)\"\n  description: \"AGI threshold for joint filers per 26 USC 24(b)(1)(A)\"\n  formula: return ctc_phaseout_threshold_joint_param\n\nvariable ctc_phaseout_threshold_single:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CTC Phase-Out Threshold (Single)\"\n  description: \"AGI threshold for non-joint filers per 26 USC 24(b)(1)(B)\"\n  formula: return ctc_phaseout_threshold_single_param\n\nvariable ctc_phaseout_rate:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CTC Phase-Out Rate\"\n  description: \"Credit reduction per $1,000 over threshold per 26 USC 24(b)(2)\"\n  formula: return ctc_phaseout_rate_param\n\nvariable actc_refundable_maximum:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"ACTC Refundable Maximum Per Child\"\n  description: \"Maximum refundable amount per child per 26 USC 24(h)(5)\"\n  formula: return actc_refundable_maximum_param\n\nvariable actc_earned_income_threshold:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"ACTC Earned Income Threshold\"\n  description: \"Earned income floor for refundable credit per 26 USC 24(d)(1)(B)(i)\"\n  formula: return actc_earned_income_threshold_param\n\nvariable actc_refundable_rate:\n  entity: TaxUnit\n  period: Year\n  dtype: Rate\n  label: \"ACTC Refundable Rate\"\n  description: \"Percentage of earned income above threshold per 26 USC 24(d)(1)(B)(i)\"\n  formula: return actc_refundable_rate_param\n\nvariable ctc_phaseout_threshold:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CTC Phase-Out Threshold\"\n  description: \"Income threshold where phase-out begins per Section 24(b)(1)\"\n  syntax: python\n  formula: |\n    if filing_status == JOINT: return ctc_phaseout_threshold_joint\n    if filing_status == SURVIVING_SPOUSE: return ctc_phaseout_threshold_joint\n    return ctc_phaseout_threshold_single\n\nvariable ctc_before_phaseout:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CTC Before Phase-Out\"\n  description: \"Total credit for all qualifying children and other dependents before phase-out\"\n  syntax: python\n  formula: |\n    let child_credit = num_qualifying_children * ctc_credit_amount\n    let other_credit = num_other_dependents * ctc_other_dependent_amount\n    return child_credit + other_credit\n\nvariable ctc_phaseout_reduction:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CTC Phase-Out Reduction\"\n  description: \"Credit reduction based on income exceeding threshold per Section 24(b)(2)\"\n  syntax: python\n  formula: |\n    let excess = adjusted_gross_income - ctc_phaseout_threshold\n    if excess <= 0 : 0\n    else ceil(excess / ctc_phaseout_increment_param) * ctc_phaseout_rate\n\nvariable total_child_tax_credit:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total Child Tax Credit\"\n  description: \"Total CTC per 26 USC Section 24 (sum of nonrefundable and refundable portions)\"\n  formula: return max(0, ctc_before_phaseout - ctc_phaseout_reduction)\n\nvariable ctc_phase_in_earnings:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CTC Phase-In (Earned Income Formula)\"\n  description: \"15% of earned income exceeding $2,500 per Section 24(d)(1)(B)(i)\"\n  syntax: python\n  formula: |\n    let excess = max(0, earned_income - actc_earned_income_threshold)\n    return actc_refundable_rate * excess\n\nvariable ctc_social_security_excess:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CTC Social Security Excess\"\n  description: \"Social security taxes minus EITC per Section 24(d)(1)(B)(ii)\"\n  formula: return max(0, social_security_taxes - earned_income_credit)\n\nvariable ctc_phase_in:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CTC Phase-In Amount\"\n  description: \"Amount used to determine refundable credit\"\n  syntax: python\n  formula: |\n    if num_qualifying_children < qualifying_children_ss_threshold : ctc_phase_in_earnings\n    else max(ctc_phase_in_earnings, ctc_social_security_excess)\n\nvariable ctc_refundable_maximum:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CTC Refundable Maximum\"\n  description: \"Maximum refundable amount based on number of qualifying children\"\n  formula: return num_qualifying_children * actc_refundable_maximum\n\nvariable refundable_ctc:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Refundable CTC (ACTC)\"\n  description: \"Refundable portion of CTC per Section 24(d)\"\n  syntax: python\n  formula: |\n    let ctc = total_child_tax_credit\n    let phase_in = ctc_phase_in\n    let limiting_tax = tax_liability_before_credits\n    let max_refundable = ctc_refundable_maximum\n    # How much CTC could be used if we had phase_in additional tax liability\n    let ctc_capped_by_tax = min(ctc, limiting_tax)\n    let ctc_capped_by_increased_tax = min(ctc, limiting_tax + phase_in)\n    let amount_ctc_would_increase = ctc_capped_by_increased_tax - ctc_capped_by_tax\n    # Refundable is limited by max refundable per child and by potential increase\n    return min(min(max_refundable, ctc), amount_ctc_would_increase)\n\nvariable non_refundable_ctc:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Non-Refundable CTC\"\n  description: \"Non-refundable portion of CTC\"\n  formula: return total_child_tax_credit - refundable_ctc\n\n# 26 USC § 24 - Total Child Tax Credit\n#\nvariable total_child_tax_credit:\n  imports:\n    - 26/24#child_tax_credit\n    - 26/24/d/1/B#additional_child_tax_credit\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total Child Tax Credit\"\n  description: \"Sum of nonrefundable CTC and refundable ACTC per 26 USC Section 24\"\n  formula: return child_tax_credit + additional_child_tax_credit",
      "path": "cosilico-us/statute/26/24.rac"
    },
    {
      "citation": "26 USC Section 24(a)",
      "title": "Child Tax Credit (Main Calculation)",
      "text": "(a) Allowance of credit.—\nThere shall be allowed as a credit against the tax imposed by this chapter\nfor the taxable year with respect to each qualifying child of the taxpayer\nfor which the taxpayer is allowed a deduction under section 151 an amount\nequal to $1,000.",
      "code": "variable ctc_gross_credit:\n  imports:\n    - 26/24/h/2#credit_amount\n    - 26/24/c/3#num_ctc_qualifying_children\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CTC Gross Credit\"\n  description: \"Total CTC before phaseout per 26 USC 24(a)\"\n  formula: return credit_amount * num_ctc_qualifying_children\n  tests:\n    - name: \"Two children, 2024\"\n      period: 2024-01\n      inputs: {num_ctc_qualifying_children: 2}\n      expect: 4000  # $2,000 x 2\n    - name: \"No children\"\n      inputs: {num_ctc_qualifying_children: 0}\n      expect: 0\n\nvariable ctc_phaseout_threshold:\n  imports:\n    - 26/1#filing_status\n    - 26/24/h/3#phaseout_threshold_joint\n    - 26/24/h/3#phaseout_threshold_other\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CTC Phaseout Threshold\"\n  description: \"Income threshold where CTC phaseout begins per 26 USC 24(b)(2) and 24(h)(3)\"\n  syntax: python\n  formula: |\n    if filing_status == JOINT:\n        threshold = phaseout_threshold_joint\n    else:\n        threshold = phaseout_threshold_other\n    return threshold\n  tests:\n    - name: \"Joint filers, 2024\"\n      period: 2024-01\n      inputs: {filing_status: JOINT}\n      expect: 400000\n    - name: \"Single filer, 2024\"\n      period: 2024-01\n      inputs: {filing_status: SINGLE}\n      expect: 200000\n\nvariable ctc_phaseout_reduction:\n  imports:\n    - 26/62/a#adjusted_gross_income\n    - 26/24/b/1#phaseout_rate\n    - 26/24/b/1#phaseout_increment\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CTC Phaseout Reduction\"\n  description: \"Credit reduction based on income above threshold per 26 USC 24(b)(1)\"\n  syntax: python\n  formula: |\n    threshold = ctc_phaseout_threshold\n    excess = max(0, adjusted_gross_income - threshold)\n    # \"or fraction thereof\" means round up\n    increments = -(-excess // phaseout_increment)  # Ceiling division\n    return phaseout_rate * increments\n  tests:\n    - name: \"Income at threshold\"\n      period: 2024-01\n      inputs: {adjusted_gross_income: 400000, filing_status: JOINT}\n      expect: 0\n    - name: \"Income $1 over threshold\"\n      period: 2024-01\n      inputs: {adjusted_gross_income: 400001, filing_status: JOINT}\n      expect: 50  # $50 for first $1,000 increment\n    - name: \"Income $10k over threshold\"\n      period: 2024-01\n      inputs: {adjusted_gross_income: 410000, filing_status: JOINT}\n      expect: 500  # 10 * $50\n\nvariable child_tax_credit_before_limit:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CTC Before Tax Liability Limit\"\n  description: \"Child Tax Credit after phaseout but before tax liability limit per 26 USC 24(a)-(b)\"\n  syntax: python\n  formula: |\n    gross = ctc_gross_credit\n    reduction = ctc_phaseout_reduction\n    return max(0, gross - reduction)\n  tests:\n    - name: \"No phaseout\"\n      period: 2024-01\n      inputs:\n        num_ctc_qualifying_children: 2\n        adjusted_gross_income: 100000\n        filing_status: JOINT\n      expect: 4000\n    - name: \"Partial phaseout\"\n      period: 2024-01\n      inputs:\n        num_ctc_qualifying_children: 2\n        adjusted_gross_income: 420000\n        filing_status: JOINT\n      expect: 3000  # 4000 - (20 * 50)\n    - name: \"Full phaseout\"\n      period: 2024-01\n      inputs:\n        num_ctc_qualifying_children: 1\n        adjusted_gross_income: 500000\n        filing_status: SINGLE\n      expect: 0  # 2000 - (300 * 50) = 2000 - 15000 = 0\n\nvariable child_tax_credit:\n  imports:\n    - 26/26/a#tax_liability_limit\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Child Tax Credit (Non-refundable)\"\n  description: \"Non-refundable portion of CTC limited to tax liability per 26 USC 24(a) and 26(a)\"\n  syntax: python\n  formula: |\n    credit = child_tax_credit_before_limit\n    return min(credit, tax_liability_limit)\n  tests:\n    - name: \"Credit less than tax liability\"\n      period: 2024-01\n      inputs:\n        num_ctc_qualifying_children: 2\n        adjusted_gross_income: 100000\n        filing_status: JOINT\n        tax_liability_limit: 10000\n      expect: 4000\n    - name: \"Tax liability limits credit\"\n      period: 2024-01\n      inputs:\n        num_ctc_qualifying_children: 3\n        adjusted_gross_income: 50000\n        filing_status: SINGLE\n        tax_liability_limit: 3000\n      expect: 3000  # Limited to tax liability\n\nvariable ctc_total:\n  imports:\n    - 26/24/d/1/B#additional_child_tax_credit\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total Child Tax Credit\"\n  description: \"Combined non-refundable CTC and refundable ACTC\"\n  formula: return child_tax_credit + additional_child_tax_credit\n  tests:\n    - name: \"High income, CTC only\"\n      period: 2024-01\n      inputs:\n        num_ctc_qualifying_children: 2\n        adjusted_gross_income: 150000\n        filing_status: JOINT\n        tax_liability_limit: 15000\n        earned_income: 150000\n      expect: 4000  # Full CTC, no ACTC needed\n    - name: \"Low income with ACTC\"\n      period: 2024-01\n      inputs:\n        num_ctc_qualifying_children: 2\n        adjusted_gross_income: 30000\n        filing_status: SINGLE\n        tax_liability_limit: 500\n        earned_income: 30000\n        social_security_taxes: 2295\n        earned_income_credit: 2000\n      expect: 3900  # $500 CTC + $3400 ACTC (capped at 1700*2)",
      "path": "cosilico-us/statute/26/24/a.rac"
    },
    {
      "citation": "26 USC Section 24(b)(1)",
      "title": "Phase-out Reduction",
      "text": "(b) Limitations.—\n(1) Limitation based on adjusted gross income.—\nThe amount of the credit allowable under subsection (a) shall be reduced\n(but not below zero) by $50 for each $1,000 (or fraction thereof) by which\nthe taxpayer's modified adjusted gross income exceeds the threshold amount.",
      "code": "# 26 USC Section 24(b)(1) - Phase-out Reduction\n#\n# Reference: IRC Section 24(b)(1)\n\ntext: \"\"\"\n(b) Limitations.—\n(1) Limitation based on adjusted gross income.—\nThe amount of the credit allowable under subsection (a) shall be reduced\n(but not below zero) by $50 for each $1,000 (or fraction thereof) by which\nthe taxpayer's modified adjusted gross income exceeds the threshold amount.\n\"\"\"\n\nparameter phaseout_rate:\n  description: \"CTC reduction amount per income increment above threshold\"\n  unit: USD\n  reference: \"26 USC 24(b)(1)\"\n  values:\n    1997-01-01: 50  # $50 per $1,000 excess\n\nparameter phaseout_increment:\n  description: \"Income increment for CTC phaseout calculation\"\n  unit: USD\n  reference: \"26 USC 24(b)(1)\"\n  values:\n    1997-01-01: 1000  # Per $1,000 (or fraction thereof)",
      "path": "cosilico-us/statute/26/24/b/1.rac"
    },
    {
      "citation": "26 USC Section 24(c)(1)",
      "title": "Qualifying Child Definition for CTC",
      "text": "(c) Qualifying child.—\n(1) In general.—\nThe term 'qualifying child' means a qualifying child of the taxpayer\n(as defined in section 152(c)) who has not attained age 17.",
      "code": "variable is_ctc_qualifying_child:\n  imports:\n    - 26/152/c#is_qualifying_child\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"CTC Qualifying Child\"\n  description: \"Whether this person is a qualifying child for CTC per 26 USC 24(c)(1)\"\n  syntax: python\n  formula: |\n    # Must be a qualifying child under Section 152(c) AND under age 17\n    return is_qualifying_child and age < qualifying_age_limit\n  tests:\n    - name: \"Child under 17\"\n      inputs: {age: 10, is_qualifying_child: true}\n      expect: true\n    - name: \"Child 17 or older\"\n      inputs: {age: 17, is_qualifying_child: true}\n      expect: false\n    - name: \"Not qualifying child under 152(c)\"\n      inputs: {age: 10, is_qualifying_child: false}\n      expect: false",
      "path": "cosilico-us/statute/26/24/c/1.rac"
    },
    {
      "citation": "26 USC Section 24(c)(3)",
      "title": "Count of Qualifying Children",
      "text": "",
      "code": "variable to count qualifying children in tax unit\n\nvariable num_ctc_qualifying_children:\n  imports:\n    - 26/24/c/1#is_ctc_qualifying_child\n  entity: TaxUnit\n  period: Year\n  dtype: Integer\n  label: \"Number of CTC Qualifying Children\"\n  description: \"Count of qualifying children for Child Tax Credit per 26 USC 24(c)\"\n  formula: return person.count(is_ctc_qualifying_child)\n  tests:\n    - name: \"No children\"\n      inputs: {is_ctc_qualifying_child: [false, false]}\n      expect: 0\n    - name: \"Two qualifying children\"\n      inputs: {is_ctc_qualifying_child: [true, true, false]}\n      expect: 2",
      "path": "cosilico-us/statute/26/24/c/3.rac"
    },
    {
      "citation": "26 USC Section 24(d)(1)(B)",
      "title": "Additional Child Tax Credit (Refundable Portion)",
      "text": "(d) Portion of credit refundable.—\n(1) In general.—\nThe aggregate credits allowed to a taxpayer under subpart C shall be increased\nby the lesser of—\n(A) the credit which would be allowed under this section without regard to\nthis subsection and the limitation under section 26(a), or\n(B) the amount by which the aggregate amount of credits allowed by this\nsubpart (determined without regard to this subsection) would increase if the\nlimitation imposed by section 26(a) were increased by the greater of—\n(i) 15 percent of so much of the taxpayer's earned income (within the\nmeaning of section 32) which exceeds $2,500, or\n(ii) in the case of a taxpayer with 3 or more qualifying children, the\nexcess (if any) of—\n(I) the taxpayer's social security taxes for the taxable year, over\n(II) the credit allowed under section 32 for the taxable year.",
      "code": "variable actc_earned_income_formula:\n  imports:\n    - 26/32/c/2/A#earned_income\n    - 26/24/h/5#refundable_max\n    - 26/24/c/3#num_ctc_qualifying_children\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"ACTC Earned Income Formula\"\n  description: \"15% of earned income above threshold per 26 USC 24(d)(1)(B)(i)\"\n  syntax: python\n  formula: |\n    excess = max(0, earned_income - earned_income_threshold)\n    earned_formula = refundable_rate * excess\n    # Cap at refundable max per child times number of qualifying children\n    max_refundable = refundable_max * num_ctc_qualifying_children\n    return min(earned_formula, max_refundable)\n\nvariable actc_ss_tax_formula:\n  imports:\n    - 26/3101#social_security_taxes\n    - 26/32/a/1#earned_income_credit\n    - 26/24/c/3#num_ctc_qualifying_children\n    - 26/24/h/5#refundable_max\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"ACTC SS Tax Formula\"\n  description: \"SS taxes minus EITC for families with 3+ children per 26 USC 24(d)(1)(B)(ii)\"\n  syntax: python\n  formula: |\n    # Only applies with 3+ qualifying children\n    ss_excess = max(0, social_security_taxes - earned_income_credit)\n    max_refundable = refundable_max * num_ctc_qualifying_children\n    # Zero out if less than 3 children (vectorized)\n    applies = (num_ctc_qualifying_children >= qualifying_children_threshold)\n    result = min(ss_excess, max_refundable) * applies\n    return result\n\nvariable additional_child_tax_credit:\n  imports:\n    - 26/24/a#child_tax_credit_before_limit\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Additional Child Tax Credit\"\n  description: \"Refundable portion of CTC per 26 USC 24(d)\"\n  syntax: python\n  formula: |\n    # ACTC = lesser of:\n    # (A) CTC before tax liability limit\n    # (B) greater of earned income formula or SS tax formula\n    earned_amt = actc_earned_income_formula\n    ss_amt = actc_ss_tax_formula\n    max_formula = max(earned_amt, ss_amt)\n    return min(child_tax_credit_before_limit, max_formula)\n  tests:\n    - name: \"Low income family, $30k earned income, 2 children\"\n      period: 2024-01\n      inputs:\n        earned_income: 30000\n        num_ctc_qualifying_children: 2\n        child_tax_credit_before_limit: 4000\n        social_security_taxes: 2295\n        earned_income_credit: 0\n      expect: 3400  # min(4000, 0.15*(30000-2500)) = min(4000, 4125) but capped at 1700*2\n    - name: \"Family with 3 children, SS tax formula higher\"\n      period: 2024-01\n      inputs:\n        earned_income: 10000\n        num_ctc_qualifying_children: 3\n        child_tax_credit_before_limit: 6000\n        social_security_taxes: 5000\n        earned_income_credit: 1000\n      expect: 4000  # SS formula: min(max(0, 5000-1000), 1700*3) = min(4000, 5100) = 4000",
      "path": "cosilico-us/statute/26/24/d/1/B.rac"
    },
    {
      "citation": "26 USC Section 24(h)(2)",
      "title": "Credit Amount (TCJA)",
      "text": "(h) Special rules for 2018 through 2025.—\n(2) Credit amount.—\nThe amount of credit allowable under subsection (a) for each qualifying child\nshall be $2,000.",
      "code": "# 26 USC Section 24(h)(2) - Credit Amount (TCJA)\n#\n# Reference: IRC Section 24(h)(2) as amended by P.L. 115-97 (TCJA)\n\ntext: \"\"\"\n(h) Special rules for 2018 through 2025.—\n(2) Credit amount.—\nThe amount of credit allowable under subsection (a) for each qualifying child\nshall be $2,000.\n\"\"\"\n\nparameter credit_amount:\n  description: \"CTC credit amount per qualifying child under TCJA\"\n  unit: USD\n  reference: \"26 USC 24(h)(2)\"\n  values:\n    2026-01-01: 1000  # TCJA sunset\n    2018-01-01: 2000  # TCJA\n    1997-01-01: 1000  # TRA97 original amount",
      "path": "cosilico-us/statute/26/24/h/2.rac"
    },
    {
      "citation": "26 USC Section 24(h)(3)",
      "title": "Phase-out Thresholds (TCJA)",
      "text": "(h) Special rules for 2018 through 2025.—\n(3) Threshold amount.—\nIn applying subsection (b), the threshold amount shall be $400,000 in the case\nof a joint return ($200,000 in any other case).",
      "code": "# 26 USC Section 24(h)(3) - Phase-out Thresholds (TCJA)\n#\n# Reference: IRC Section 24(h)(3) as amended by P.L. 115-97 (TCJA)\n\ntext: \"\"\"\n(h) Special rules for 2018 through 2025.—\n(3) Threshold amount.—\nIn applying subsection (b), the threshold amount shall be $400,000 in the case\nof a joint return ($200,000 in any other case).\n\"\"\"\n\nparameter phaseout_threshold_joint:\n  description: \"CTC phaseout threshold for married filing jointly under TCJA\"\n  unit: USD\n  reference: \"26 USC 24(h)(3)\"\n  values:\n    2026-01-01: 110000  # TCJA sunset - revert to pre-TCJA\n    2018-01-01: 400000  # TCJA\n    1997-01-01: 110000  # TRA97 original\n\nparameter phaseout_threshold_other:\n  description: \"CTC phaseout threshold for all filing statuses except joint under TCJA\"\n  unit: USD\n  reference: \"26 USC 24(h)(3)\"\n  values:\n    2026-01-01: 75000   # TCJA sunset - revert to pre-TCJA\n    2018-01-01: 200000  # TCJA\n    1997-01-01: 75000   # TRA97 original",
      "path": "cosilico-us/statute/26/24/h/3.rac"
    },
    {
      "citation": "26 USC Section 24(h)(4)",
      "title": "Credit for Other Dependents (TCJA)",
      "text": "(h) Special rules for 2018 through 2025.—\n(4) Credit for other dependents.—\n(A) In general.—\nIn the case of a taxpayer for which a deduction is allowed under section 151\nfor any dependent for the taxable year who is not a qualifying child\n(as defined in subsection (c)), the credit allowed under subsection (a)\n(determined after the application of paragraph (2)) shall be increased\nby $500 for each such dependent.",
      "code": "# 26 USC Section 24(h)(4) - Credit for Other Dependents (TCJA)\n#\n# Reference: IRC Section 24(h)(4) as amended by P.L. 115-97 (TCJA)\n\ntext: \"\"\"\n(h) Special rules for 2018 through 2025.—\n(4) Credit for other dependents.—\n(A) In general.—\nIn the case of a taxpayer for which a deduction is allowed under section 151\nfor any dependent for the taxable year who is not a qualifying child\n(as defined in subsection (c)), the credit allowed under subsection (a)\n(determined after the application of paragraph (2)) shall be increased\nby $500 for each such dependent.\n\"\"\"\n\nparameter other_dependent_credit:\n  description: \"CTC credit for dependents who are not qualifying children under TCJA\"\n  unit: USD\n  reference: \"26 USC 24(h)(4)\"\n  values:\n    2026-01-01: 0    # TCJA sunset - no ODC before TCJA\n    2018-01-01: 500  # TCJA created ODC",
      "path": "cosilico-us/statute/26/24/h/4.rac"
    },
    {
      "citation": "26 USC Section 24(h)(4)",
      "title": "Other Dependent Credit Calculation",
      "text": "(h) Special rules for 2018 through 2025.—\n(4) Credit for other dependents.—\n(A) In general.—\nIn the case of a taxpayer for which a deduction is allowed under section 151\nfor any dependent for the taxable year who is not a qualifying child\n(as defined in subsection (c)), the credit allowed under subsection (a)\n(determined after the application of paragraph (2)) shall be increased\nby $500 for each such dependent.",
      "code": "variable is_other_dependent:\n  imports:\n    - 26/24/c/1#is_ctc_qualifying_child\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Is Other Dependent for ODC\"\n  description: \"Whether this person qualifies as 'other dependent' for ODC per 26 USC 24(h)(4)\"\n  syntax: python\n  formula: |\n    # An \"other dependent\" is someone who:\n    # 1. Is a dependent under Section 152\n    # 2. Is NOT a CTC qualifying child under Section 24(c)\n    return is_dependent and not is_ctc_qualifying_child\n  tests:\n    - name: \"Adult dependent parent\"\n      inputs: {is_dependent: true, is_ctc_qualifying_child: false}\n      expect: true\n    - name: \"Qualifying child under 17\"\n      inputs: {is_dependent: true, is_ctc_qualifying_child: true}\n      expect: false\n\nvariable num_other_dependents:\n  entity: TaxUnit\n  period: Year\n  dtype: Integer\n  label: \"Number of Other Dependents\"\n  description: \"Count of dependents qualifying for ODC per 26 USC 24(h)(4)\"\n  formula: return person.count(is_other_dependent)\n\nvariable other_dependent_credit_amount:\n  imports:\n    - 26/24/h/4#other_dependent_credit\n    - 26/24/a#ctc_phaseout_reduction\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Other Dependent Credit\"\n  description: \"Credit for dependents who are not CTC qualifying children per 26 USC 24(h)(4)\"\n  syntax: python\n  formula: |\n    gross = other_dependent_credit * num_other_dependents\n    # ODC uses same phaseout as CTC\n    return max(0, gross - ctc_phaseout_reduction)\n  tests:\n    - name: \"One adult dependent, no phaseout\"\n      period: 2024-01\n      inputs:\n        num_other_dependents: 1\n        adjusted_gross_income: 100000\n        filing_status: JOINT\n      expect: 500\n    - name: \"ODC not available before TCJA\"\n      period: 2017-01\n      inputs:\n        num_other_dependents: 1\n        adjusted_gross_income: 50000\n        filing_status: SINGLE\n      expect: 0  # ODC didn't exist before 2018",
      "path": "cosilico-us/statute/26/24/h/4/odc.rac"
    },
    {
      "citation": "26 USC Section 24(h)(5)",
      "title": "Refundable Credit Cap (TCJA)",
      "text": "(h) Special rules for 2018 through 2025.—\n(5) Maximum amount of refundable credit.—\n(A) In general.—The amount determined under subsection (d)(1)(A) with respect\nto any qualifying child shall not exceed $1,400.\n(B) Adjustment for inflation.—\nIn the case of a taxable year beginning after 2018...",
      "code": "# 26 USC Section 24(h)(5) - Refundable Credit Cap (TCJA)\n#\n# Reference: IRC Section 24(h)(5) as amended by P.L. 115-97 (TCJA)\n\ntext: \"\"\"\n(h) Special rules for 2018 through 2025.—\n(5) Maximum amount of refundable credit.—\n(A) In general.—The amount determined under subsection (d)(1)(A) with respect\nto any qualifying child shall not exceed $1,400.\n(B) Adjustment for inflation.—\nIn the case of a taxable year beginning after 2018...\n\"\"\"\n\n# Base statutory value from TCJA\n# Indexed values in IRS guidance files\nparameter refundable_max:\n  description: \"Maximum refundable CTC (ACTC) per qualifying child under TCJA\"\n  unit: \"USD\"\n  indexed_by: statute/26/24/h/5/B\n  values:\n    2018-01-01: 1400",
      "path": "cosilico-us/statute/26/24/h/5.rac"
    },
    {
      "citation": "26 USC Section 243",
      "title": "Dividends Received by Corporations",
      "text": "(a) GENERAL RULE.—In the case of a corporation, there shall be allowed as\na deduction an amount equal to the following percentages of the amount\nreceived as dividends from a domestic corporation which is subject to\ntaxation under this chapter:\n(1) 50 percent, in the case of dividends other than dividends described\nin paragraph (2) or (3);\n(2) 100 percent, in the case of dividends received by a small business\ninvestment company;\n(3) 100 percent, in the case of qualifying dividends [from affiliates].\nsubstituting \"65 percent\" for \"50 percent\".",
      "code": "variable dividends_received_deduction:\n  entity: Corporation\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Dividends Received Deduction\"\n  description: \"Final DRD after all limitations\"\n  syntax: python\n  formula: |\n    if ownership_percentage >= ownership_threshold_affiliated:\n        return deduction_rate_affiliated\n    if ownership_percentage >= ownership_threshold_20_percent:\n        return deduction_rate_20_percent\n    return deduction_rate_portfolio\n  default: False",
      "path": "cosilico-us/statute/26/243/a.rac"
    },
    {
      "citation": "26 USC Section 26",
      "title": "Total Nonrefundable Personal Credits",
      "text": "Section 26(a) provides: \"The aggregate amount of credits allowed by this\n(2) the tentative minimum tax for the taxable year.",
      "code": "variable total_nonrefundable_credits:\n  imports:\n    - 26/21/a#child_dependent_care_credit\n    - 26/24#child_tax_credit\n    - 26/25A/a#education_credits_nonrefundable\n    - 26/26/a#tax_liability_before_credits\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total Nonrefundable Credits\"\n  description: \"Sum of nonrefundable personal credits per 26 USC Section 26, limited by tax liability\"\n  syntax: python\n  formula: |\n    # Sum all nonrefundable credits\n    # Each credit is already individually limited by tax liability in its own formula\n    total = child_dependent_care_credit + child_tax_credit + education_credits_nonrefundable\n    # Total cannot exceed tax liability (belt-and-suspenders with individual limits)\n    return min(total, tax_liability_before_credits)\n  default: 0",
      "path": "cosilico-us/statute/26/26.rac"
    },
    {
      "citation": "26 USC Section 26(a)",
      "title": "Tax Liability Before Credits",
      "text": "The aggregate amount of credits allowed by this subpart for the taxable\nyear shall not exceed the excess (if any) of—\n(1) the taxpayer's regular tax liability for the taxable year, over\n(2) the tentative minimum tax for the taxable year",
      "code": "variable tax_liability_before_credits:\n  imports:\n    - 26/1#income_tax_before_credits\n    - 26/55/a#tentative_minimum_tax\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Tax Liability Before Credits\"\n  description: \"Maximum amount of nonrefundable credits per Section 26(a)\"\n  syntax: python\n  formula: |\n    # Regular tax is the income tax computed under Section 1\n    # Self-employment tax is separate and not limited by Section 26\n    return income_tax_before_credits",
      "path": "cosilico-us/statute/26/26/a.rac"
    },
    {
      "citation": "26 USC Section 401(a)(9)",
      "title": "Required Minimum Distributions (RMD)",
      "text": "(9) Required distributions.--\n(A) In general.--A trust shall not constitute a qualified trust under\nthis subsection unless the plan provides that the entire interest\nof each employee--\n(i) will be distributed to such employee not later than the required\nbeginning date, or\n(ii) will be distributed, beginning not later than the required\nbeginning date...",
      "code": "variable rmd:\n  imports: [26/person/age#age]\n\nvariable birth_year:\n  entity: Person\n  period: Year\n  dtype: Integer\n  label: \"Birth Year\"\n  description: \"Year of birth for RMD age determination\"\n\nvariable prior_year_401k_balance:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"401(k) Prior Year Balance\"\n  description: \"Account balance as of December 31 of prior year for RMD calculation\"\n  default: 0\n\nvariable is_still_working_for_plan_sponsor:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Still Working for Plan Sponsor\"\n  description: \"Whether employee is still working for the 401(k) plan sponsor\"\n  default: false\n\nvariable is_5_percent_owner:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Is 5% Owner\"\n  description: \"Whether employee owns 5% or more of the business\"\n  default: false\n\nvariable rmd_applicable_age:\n  entity: Person\n  period: Year\n  dtype: Integer\n  label: \"RMD Applicable Age\"\n  description: \"Age at which required minimum distributions must begin\"\n  syntax: python\n  formula: |\n    # Use cut() to look up applicable age from birth year thresholds\n    return cut(birth_year, rmd_birth_year_thresholds)\n  default: 0\n\nvariable has_reached_rmd_age:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Reached RMD Age\"\n  description: \"Whether individual has reached required minimum distribution age\"\n  formula: return age >= rmd_applicable_age\n  default: false\n\nvariable is_rmd_required:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"RMD Required\"\n  description: \"Whether a required minimum distribution must be taken this year\"\n  syntax: python\n  formula: |\n    # Must have reached RMD age\n    if not has_reached_rmd_age:\n        return False\n    # Still-working exception for non-5% owners\n    if is_still_working_for_plan_sponsor and not is_5_percent_owner:\n        return False\n    # Must have account balance\n    if prior_year_401k_balance <= 0:\n        return False\n    return True\n  default: false\n\nvariable rmd_divisor:\n  entity: Person\n  period: Year\n  dtype: Decimal\n  label: \"RMD Divisor\"\n  description: \"Life expectancy divisor from IRS Uniform Lifetime Table\"\n  syntax: python\n  formula: |\n    # Use cut() to look up divisor from Uniform Lifetime Table\n    return cut(age, uniform_lifetime_table)\n  default: 0\n\nvariable required_minimum_distribution:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Required Minimum Distribution\"\n  description: \"Minimum amount that must be withdrawn from retirement account\"\n  syntax: python\n  formula: |\n    if not is_rmd_required:\n        return 0\n    # RMD = Prior year balance / Life expectancy divisor\n    return prior_year_401k_balance / rmd_divisor\n  default: 0\n\nvariable rmd_shortfall_penalty:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"RMD Shortfall Penalty\"\n  description: \"Excise tax on failure to take required minimum distribution\"\n  syntax: python\n  formula: |\n    # Input: Actual distribution taken\n    # For now, assume full compliance\n    return 0",
      "path": "cosilico-us/statute/26/402/c.rac"
    },
    {
      "citation": "26 USC Section 402(a)",
      "title": "Taxability of Beneficiary of Employees' Trust",
      "text": "(a) Taxability of beneficiary of exempt trust.--\n(1) In general.--Except as otherwise provided in this section, any\namount actually distributed to any distributee by any employees'\ntrust described in section 401(a) which is exempt from tax under\nsection 501(a) shall be taxable to the distributee, in the taxable\nyear of the distributee in which distributed, under section 72\n(relating to annuities).",
      "code": "variable distributions:\n  imports:\n    - 26/1#filing_status\n    - 26/402/e/4#early_withdrawal_penalty_401k\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net Taxable Distribution\"\n  description: \"Taxable distribution after excluding rollover amounts\"\n  syntax: python\n  formula: |\n    # Traditional distributions are fully taxable\n    traditional_taxable = traditional_401k_distribution\n    # Roth distributions are tax-free if qualified\n    # Qualified: 5-year holding period AND (age 59.5+ OR death/disability)\n    is_qualified_roth = roth_401k_5_year_satisfied and age >= early_withdrawal_penalty_age\n    # Non-qualified Roth: earnings portion is taxable\n    # Simplified: assume contributions recovered first (FIFO)\n    if is_qualified_roth:\n        roth_taxable = 0\n    else:\n        roth_taxable = max(0, roth_401k_distribution - roth_401k_contribution_basis)\n    return traditional_taxable + roth_taxable\n  default: 0",
      "path": "cosilico-us/statute/26/402/a.rac"
    },
    {
      "citation": "26 USC Section 408",
      "title": "Individual Retirement Accounts (Definitions)",
      "text": "(a) Individual retirement account.--For purposes of this section, the term\n'individual retirement account' means a trust created or organized in\nthe United States for the exclusive benefit of an individual or his\nbeneficiaries...",
      "code": "variable ira_definitions:\n  imports:\n    - 26/402/c#rmd_divisor\n    - 26/402/c#rmd_applicable_age\n\nvariable traditional_ira_balance:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Traditional IRA Balance\"\n  description: \"Total balance in all traditional IRA accounts\"\n  default: 0\n\nvariable roth_ira_balance:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Roth IRA Balance\"\n  description: \"Total balance in all Roth IRA accounts\"\n  default: 0\n\nvariable birth_year:\n  entity: Person\n  period: Year\n  dtype: Integer\n  label: \"Birth Year\"\n  description: \"Year of birth for RMD age determination\"\n\nvariable ira_rmd_applicable_age:\n  entity: Person\n  period: Year\n  dtype: Integer\n  label: \"IRA RMD Applicable Age\"\n  description: \"Age at which IRA required minimum distributions must begin\"\n  syntax: python\n  formula: |\n    # Same rules as 401(k) - reuses rmd_applicable_age from 402/c/rmd\n    return rmd_applicable_age\n  default: 0\n\nvariable is_ira_reached_rmd_age:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"IRA Reached RMD Age\"\n  description: \"Whether individual has reached IRA required minimum distribution age\"\n  formula: return age >= ira_rmd_applicable_age\n  default: false\n\nvariable ira_prior_year_balance:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"IRA Prior Year Balance\"\n  description: \"Total IRA account balance as of December 31 of prior year\"\n  default: 0\n\nvariable ira_required_minimum_distribution:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"IRA Required Minimum Distribution\"\n  description: \"Minimum amount that must be withdrawn from IRA\"\n  syntax: python\n  formula: |\n    # Must have reached RMD age\n    if not is_ira_reached_rmd_age:\n    return 0\n    # Must have account balance\n    if ira_prior_year_balance <= 0:\n    return 0\n    # RMD = Prior year balance / divisor from Uniform Lifetime Table\n    # Reuses rmd_divisor from 401(k) rules (same table)\n    return ira_prior_year_balance / rmd_divisor\n  default: 0\n\nvariable has_simple_ira:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Has SIMPLE IRA\"\n  description: \"Whether individual has a SIMPLE IRA (higher contribution limits)\"\n  default: false\n\nvariable has_sep_ira:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Has SEP IRA\"\n  description: \"Whether individual has a SEP IRA (self-employed)\"\n  default: false\n\nvariable total_ira_balance:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total IRA Balance\"\n  description: \"Combined balance of all traditional and Roth IRAs\"\n  formula: return traditional_ira_balance + roth_ira_balance",
      "path": "cosilico-us/statute/26/408.rac"
    },
    {
      "citation": "26 USC Section 408(d)",
      "title": "Tax Treatment of Distributions",
      "text": "(d) Tax treatment of distributions.--\n(1) In general.--Except as otherwise provided in this subsection, any\namount paid or distributed out of an individual retirement plan\nshall be included in gross income by the payee or distributee, as\nthe case may be, in the manner provided under section 72.",
      "code": "variable distributions:\n  imports:\n    - 26/62/a#adjusted_gross_income\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"IRA Early Withdrawal Penalty\"\n  description: \"10% additional tax on early IRA distributions per 72(t)\"\n  syntax: python\n  formula: |\n    if traditional_ira_distribution <= 0:\n        return 0\n    # If no basis, entire distribution is taxable\n    if traditional_ira_basis <= 0:\n        return traditional_ira_distribution\n    # Pro-rata rule: basis recovery based on ratio of basis to total value\n    # Total value = year-end value + current year distributions\n    total_value = traditional_ira_total_value + traditional_ira_distribution\n    if total_value <= 0:\n        return traditional_ira_distribution\n    # Non-taxable ratio = basis / total value\n    nontaxable_ratio = min(1.0, traditional_ira_basis / total_value)\n    nontaxable_amount = traditional_ira_distribution * nontaxable_ratio\n    return traditional_ira_distribution - nontaxable_amount\n  default: 0",
      "path": "cosilico-us/statute/26/408/d.rac"
    },
    {
      "citation": "26 USC Section 408(d)(3)",
      "title": "Rollover Contributions",
      "text": "(3) Rollover contribution.--An amount is described in this paragraph as\na rollover contribution if it meets the requirements of subparagraphs\n(A) and (B).\n(A) In general.--Paragraph (1) does not apply to any amount paid or\ndistributed out of an individual retirement account or individual\nretirement annuity to the individual for whose benefit the account\nor annuity is maintained if--\n(i) the entire amount received (including money and any other property)\nis paid into an individual retirement account or individual\nretirement annuity (other than an endowment contract) for the\nbenefit of such individual not later than the 60th day after the\nday on which he receives the payment or distribution...",
      "code": "variable rollovers:\n  imports: [26/408/d#traditional_ira_distribution]\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net IRA Distribution After Rollover\"\n  description: \"IRA distribution amount remaining taxable after valid rollover\"\n  syntax: python\n  formula: |\n    # Direct transfers always permitted\n    if is_ira_direct_transfer:\n        return True\n    # 60-day rollover limited to once per 12 months\n    if has_prior_12_month_rollover:\n        return False\n    return True\n  default: 0",
      "path": "cosilico-us/statute/26/408/d/3.rac"
    },
    {
      "citation": "26 USC Section 408(o)",
      "title": "Designated Nondeductible Contributions",
      "text": "",
      "code": "variable contribution_limits:\n  imports:\n    - 26/32/c/2/A#earned_income\n    - 26/1#filing_status\n    - 26/62/a#adjusted_gross_income\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Excess Contribution Penalty\"\n  description: \"6% excise tax on excess IRA contributions left in account\"\n  formula: return traditional_ira_contributions + roth_ira_contributions\n  default: 0",
      "path": "cosilico-us/statute/26/408/o.rac"
    },
    {
      "citation": "26 USC Section 408A(d)",
      "title": "Distribution Rules for Roth IRAs",
      "text": "(d) Distribution rules.--For purposes of this title--\n(1) Exclusion.--Any qualified distribution from a Roth IRA shall not be\nincludible in gross income.\n(2) Qualified distribution.--For purposes of this subsection--\n(A) In general.--The term 'qualified distribution' means any payment\nor distribution--\n(i) made on or after the date on which the individual attains\nage 59-1/2,\n(ii) made to a beneficiary (or to the estate of the individual)\non or after the death of the individual,\n(iii) attributable to the individual's being disabled, or\n(iv) which is a qualified special purpose distribution.\n(B) Distributions within nonexclusion period.--A payment or distribution\nfrom a Roth IRA shall not be treated as a qualified distribution...\nif such payment or distribution is made within the 5-taxable year\nperiod beginning with the first taxable year for which the\nindividual made a contribution to a Roth IRA...",
      "code": "variable distributions:\n  imports:\n    - 26/408/d#taxable_ira_distribution\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total IRA Taxable Income\"\n  description: \"Combined taxable income from all IRA distributions\"\n  syntax: python\n  formula: |\n    # Must satisfy 5-year holding period\n    if not is_roth_ira_5_year_satisfied:\n        return False\n    # Must meet one of these conditions:\n    # (i) Age 59.5+\n    if age >= early_withdrawal_penalty_age:\n        return True\n    # (ii) Death\n    if is_roth_death_distribution:\n        return True\n    # (iii) Disability\n    if is_roth_owner_disabled:\n        return True\n    # (iv) First-time homebuyer (up to $10,000 lifetime)\n    if roth_first_home_distribution > 0:\n        return True\n    return False\n  default: 0",
      "path": "cosilico-us/statute/26/408A/d.rac"
    },
    {
      "citation": "26 USC Section 422",
      "title": "Incentive Stock Options",
      "text": "requires that the \"bargain element\" be included in AMTI.",
      "code": "variable iso_bargain_element:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  unit: \"USD\"\n  label: \"ISO Shares Held at Year End\"\n  description: \"Whether ISO shares were held through the end of the tax year\"\n  default: true",
      "path": "cosilico-us/statute/26/422/b.rac"
    },
    {
      "citation": "26 USC Section 469(i)(2)",
      "title": "Depends on Filing Status",
      "text": "(a) Disallowance.--\n(1) In general.--If for any taxable year the taxpayer is described in\nparagraph (2), neither--\n(A) the passive activity loss, nor\n(B) the passive activity credit,\nfor the taxable year shall be allowed.\n(2) Persons described.--The following are described in this paragraph:\n(A) any individual, estate, or trust,\n(B) any closely held C corporation, and\n(C) any personal service corporation.\n(b) Disallowed Loss or Credit Carried to Next Year.--\nExcept as otherwise provided in this section, any loss or credit from\nan activity which is disallowed under subsection (a) shall be treated\nas a deduction or credit allocable to such activity in the next\ntaxable year.\n(c) Passive Activity Defined.--\n(1) In general.--The term 'passive activity' means any activity--\n(A) which involves the conduct of any trade or business, and\n(B) in which the taxpayer does not materially participate.\n(2) Passive activity includes any rental activity.--\nExcept as provided in paragraph (7), the term 'passive activity' includes\nany rental activity.\n(d) Passive Activity Loss and Credit Defined.--\n(1) Passive activity loss.--The term 'passive activity loss' means the\namount (if any) by which--\n(A) the aggregate losses from all passive activities for the taxable year,\nexceed\n(B) the aggregate income from all passive activities for such year.",
      "code": "variable base_rental_real_estate_allowance:\n  imports: [26/1#filing_status]\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Base Rental Real Estate Allowance\"\n  description: \"Base $25,000 allowance amount before phaseout per 26 USC 469(i)(2)\"\n  syntax: python\n  formula: |\n    # Per 469(i)(5)(A): MFS living together gets $0\n    # Per 469(i)(5)(B): MFS living apart gets $12,500\n    # All others get $25,000\n    is_mfs = filing_status == \"married_separate\"\n    lived_apart = lived_apart_from_spouse_all_year\n    # MFS living apart gets $12,500\n    if is_mfs and lived_apart: return allowance_amount_mfs\n    # MFS living together gets $0\n    if is_mfs: return 0\n    # All others get $25,000\n    return allowance_amount\n  default: 0\n\n# Disallowed Rental Real Estate Loss\n# 26 USC Section 469(a)\nvariable disallowed_rental_real_estate_loss:\n  imports:\n    - 26/469#net_rental_real_estate_loss\n    - 26/469#rental_real_estate_loss_allowance\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Disallowed Rental Real Estate Loss\"\n  description: \"Rental real estate loss that is suspended per 26 USC 469(a)\"\n  syntax: python\n  formula: |\n    # Loss that cannot be deducted this year - carries forward\n    return max(0, net_rental_real_estate_loss - rental_real_estate_loss_allowance)\n  default: 0\n\n# Net Rental Real Estate Loss - For Exception Calculation\n# 26 USC Section 469(i)\nvariable net_rental_real_estate_loss:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Net Rental Real Estate Loss\"\n  description: \"Losses from rental real estate activities exceeding income per 26 USC 469(i)\"\n  formula: return max(0, rental_real_estate_loss - rental_real_estate_income)\n  default: 0\n\n# 26 USC Section 469 - Passive Activity Losses and Credits\n#\n\ntext: \"\"\"\n(a) Disallowance.--\n(1) In general.--If for any taxable year the taxpayer is described in\nparagraph (2), neither--\n(A) the passive activity loss, nor\n(B) the passive activity credit,\nfor the taxable year shall be allowed.\n(2) Persons described.--The following are described in this paragraph:\n(A) any individual, estate, or trust,\n(B) any closely held C corporation, and\n(C) any personal service corporation.\n(b) Disallowed Loss or Credit Carried to Next Year.--\nExcept as otherwise provided in this section, any loss or credit from\nan activity which is disallowed under subsection (a) shall be treated\nas a deduction or credit allocable to such activity in the next\ntaxable year.\n(c) Passive Activity Defined.--\n(1) In general.--The term 'passive activity' means any activity--\n(A) which involves the conduct of any trade or business, and\n(B) in which the taxpayer does not materially participate.\n(2) Passive activity includes any rental activity.--\nExcept as provided in paragraph (7), the term 'passive activity' includes\nany rental activity.\n(d) Passive Activity Loss and Credit Defined.--\n(1) Passive activity loss.--The term 'passive activity loss' means the\namount (if any) by which--\n(A) the aggregate losses from all passive activities for the taxable year,\nexceed\n(B) the aggregate income from all passive activities for such year.\n\"\"\"\nvariable passive_loss_limitation:\n  imports:\n    - 26/469#rental_real_estate_loss_allowance as rental_real_estate_allowance\n    - 26/1#filing_status\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  unit: \"\"\n  label: \"Has Passive Activities\"\n  description: \"Whether taxpayer has any passive activities per 26 USC 469(c)\"\n  syntax: python\n  formula: |\n    # Per 469(d)(1): Passive activity loss = losses - income (if positive)\n    # Net income is the reverse: income - losses (if positive)\n    return max(0, passive_activity_income - passive_activity_losses)\n  default: false\n\n\nvariable real_estate_professional:\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  unit: \"\"\n  label: \"Real Estate Professional\"\n  description: \"Whether taxpayer qualifies as real estate professional per 26 USC 469(c)(7)\"\n  syntax: python\n  formula: |\n    # Per 469(c)(7)(B)(ii): More than 750 hours in real property trades/businesses\n    # where taxpayer materially participates\n    hours_in_real_property = hours_in_real_property_trades_businesses\n    materially_participates = materially_participates_in_real_property_business\n    return materially_participates and (hours_in_real_property > hours_threshold)\n  default: false\n\nvariable rental_real_estate_allowance_after_phaseout:\n  imports:\n    - 26/469#base_rental_real_estate_allowance\n    - 26/469#rental_real_estate_allowance_phaseout\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Rental Real Estate Allowance After Phaseout\"\n  description: \"Allowance remaining after AGI-based phaseout per 26 USC 469(i)\"\n  formula: return max(0, base_rental_real_estate_allowance - rental_real_estate_allowance_phaseout)\n  default: 0\n\nvariable rental_real_estate_allowance_phaseout:\n  imports:\n    - 26/62/a#adjusted_gross_income\n    - 26/469#rental_real_estate_phaseout_threshold\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Rental Real Estate Allowance Phaseout\"\n  description: \"Reduction in allowance due to AGI phaseout per 26 USC 469(i)(3)\"\n  syntax: python\n  formula: |\n    # Per 469(i)(3)(A): Reduce by 50% of AGI over threshold\n    excess_agi = max(0, adjusted_gross_income - rental_real_estate_phaseout_threshold)\n    return excess_agi * phaseout_rate\n  default: 0\n\n\nvariable rental_real_estate_exception:\n  imports:\n    - 26/469#net_rental_real_estate_loss\n    - 26/469#rental_real_estate_allowance_after_phaseout\n    - 26/469#is_real_estate_professional\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Rental Real Estate Loss Allowance\"\n  description: \"Amount of rental real estate loss allowed against non-passive income per 26 USC 469(i)\"\n  syntax: python\n  formula: |\n    # Requirements per 469(i):\n    # 1. Natural person (not corporation, trust, or estate - simplified here)\n    # 2. Active participation in rental real estate\n    # Real estate professionals are not subject to passive loss rules for rentals\n    # Per 469(c)(7): Their rental activities are treated as non-passive\n    # So they can deduct unlimited rental losses (no need for this exception)\n    if is_real_estate_professional: return net_rental_real_estate_loss\n    # Active participants get up to $25,000 (or $12,500 MFS) after phaseout\n    # Limited to actual net loss\n    allowance = rental_real_estate_allowance_after_phaseout\n    if actively_participates_in_rental: return min(net_rental_real_estate_loss, allowance)\n    # No active participation - no exception, passive loss rules apply fully\n    return 0\n  default: 0\n\nvariable rental_real_estate_phaseout_threshold:\n  imports: [26/1#filing_status]\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Rental Real Estate Phaseout Threshold\"\n  description: \"Modified AGI threshold where phaseout begins per 26 USC 469(i)(3)\"\n  syntax: python\n  formula: |\n    # Per 469(i)(5)(B): MFS living apart uses $50,000 threshold\n    # All others (including MFS living together, who get $0 anyway) use $100,000\n    is_mfs = filing_status == \"married_separate\"\n    lived_apart = lived_apart_from_spouse_all_year\n    if is_mfs and lived_apart: return phaseout_start_mfs\n    return phaseout_start\n  default: 100000",
      "path": "cosilico-us/statute/26/469.rac"
    },
    {
      "citation": "26 USC Section 55(a)",
      "title": "Alternative Minimum Tax Imposed",
      "text": "There is hereby imposed (in addition to any other tax imposed by this\nsubtitle) a tax equal to the excess (if any) of—\n(1) the tentative minimum tax for the taxable year, over\n(2) the regular tax for the taxable year.",
      "code": "variable amt:\n  imports:\n    - 26/55/b/2#alternative_minimum_taxable_income as amti\n    - 26/1#income_tax_before_credits as regular_tax\n    - 26/1#filing_status\n    - 26/59#amt_foreign_tax_credit\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total Income Tax with AMT\"\n  description: \"Regular tax plus AMT\"\n  syntax: python\n  formula: |\n    # Get base exemption based on filing status\n    # Joint filers and surviving spouses: Section 55(d)(1)(A)\n    # Single and HoH: Section 55(d)(1)(B)\n    # MFS: Section 55(d)(1)(C) - half of joint\n    if filing_status == MARRIED_FILING_JOINTLY: return exemption_joint\n    if filing_status == QUALIFYING_WIDOW: return exemption_joint\n    if filing_status == MARRIED_FILING_SEPARATELY: return exemption_mfs\n    if filing_status == SINGLE: return exemption_single\n    return exemption_single\n  default: 0",
      "path": "cosilico-us/statute/26/55/a.rac"
    },
    {
      "citation": "26 USC Section 55(b)(2)",
      "title": "Alternative Minimum Taxable Income",
      "text": "The term 'alternative minimum taxable income' means the taxable income\nof the taxpayer for the taxable year—\n(A) determined with the adjustments provided in section 56 and section 58, and\n(B) increased by the amount of the items of tax preference described in section 57.",
      "code": "variable amti:\n  imports:\n    - 26/56#amt_adjustments\n    - 26/57#amt_preferences\n    - 26/59#amt_nol_deduction\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Alternative Minimum Taxable Income\"\n  description: \"AMTI computed per Section 55(b)(2) as taxable income plus adjustments and preferences, less AMT NOL\"\n  syntax: python\n  formula: |\n    # Start with regular taxable income\n    base = taxable_income\n    # Add AMT adjustments from Sections 56 and 58\n    adjustments = amt_adjustments\n    # Add tax preference items from Section 57\n    preferences = amt_preferences\n    return max(0, base + adjustments + preferences)\n  default: 0",
      "path": "cosilico-us/statute/26/55/b/2.rac"
    },
    {
      "citation": "26 USC Section 56",
      "title": "Adjustments in Computing Alternative Minimum Taxable Income",
      "text": "In determining the amount of the alternative minimum taxable income for any\ntaxable year, the following adjustments shall apply to taxable income...",
      "code": "variable adjustments:\n  imports:\n    - 26/63/c#standard_deduction\n    - 26/62/a#adjusted_gross_income\n    - 26/1#filing_status\n    - 26/422/b#iso_exercise_bargain_element\n    - 26/58#total_section_58_adjustments as section_58_adjustments\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total AMT Adjustments\"\n  description: \"Sum of all AMT adjustments under Sections 56 and 58\"\n  syntax: python\n  formula: |\n    # State and local taxes (including property taxes) claimed as itemized\n    # deduction must be added back for AMT purposes\n    if uses_standard_deduction: return 0\n    return state_local_taxes\n  default: 0",
      "path": "cosilico-us/statute/26/56.rac"
    },
    {
      "citation": "26 USC Section 57",
      "title": "Items of Tax Preference",
      "text": "For purposes of this part, the items of tax preference determined under\nthis section are—",
      "code": "variable preferences:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total AMT Preference Items\"\n  description: \"Sum of all tax preference items under Section 57\"\n  syntax: python\n  formula: |\n    # The preference amount is the excess of percentage depletion over\n    # the adjusted basis of the property (cost depletion)\n    excess = percentage_depletion - cost_depletion\n    return max(0, excess)\n  default: 0",
      "path": "cosilico-us/statute/26/57.rac"
    },
    {
      "citation": "26 USC Section 58",
      "title": "Denial of Certain Losses",
      "text": "For purposes of this part—",
      "code": "variable denial_of_losses:\n  imports:\n    - 26/1#filing_status\n    - 26/62/a#adjusted_gross_income\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total Section 58 Loss Adjustments\"\n  description: \"Sum of all loss disallowances under Section 58\"\n  syntax: python\n  formula: |\n    # Material participation is determined under Section 469 passive activity rules\n    # Taxpayer must work 500+ hours, be sole participant, or meet other tests\n    # This is a simplification - actual rules are in Section 469 regulations\n    # For now, we assume this is provided as an input\n    return is_material_participant_farming\n  default: 0",
      "path": "cosilico-us/statute/26/58.rac"
    },
    {
      "citation": "26 USC Section 59",
      "title": "Other Definitions and Special Rules",
      "text": "",
      "code": "variable special_rules:\n  imports:\n    - 26/1#filing_status\n    - 26/55/b/2#alternative_minimum_taxable_income as amti\n    - 26/55/a#tentative_minimum_tax\n    - 26/1411/a#net_investment_income_tax as niit\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Regular Tax\"\n  description: \"Regular income tax for Section 55(c) cross-reference\"\n  syntax: python\n  formula: |\n    # For AMT purposes, foreign source income must be recomputed\n    # using AMT adjustments (Section 56) and preferences (Section 57)\n    #\n    # This requires recalculating the foreign source portion of AMTI\n    # rather than using regular tax foreign source income\n    #\n    # Simplified: Assume same ratio of foreign to worldwide income\n    # In practice, would need detailed AMT adjustment allocation\n    if worldwide_income == 0: return 0\n    foreign_ratio = foreign_source_income / worldwide_income\n    return amti * foreign_ratio\n  default: 0",
      "path": "cosilico-us/statute/26/59.rac"
    },
    {
      "citation": "26 USC Section 61(a)",
      "title": "Gross Income Defined",
      "text": "",
      "code": "variable other_income:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: USD\n  label: Other Income\n  description: Miscellaneous income not categorized as wages, interest, dividends, etc.\n\nvariable gross_income:\n  imports:\n    - 26/61/a/1#wages\n    - 26/61/a/1#salaries\n    - 26/61/a/1#tips\n    - 26/1402/a#self_employment_income\n    - 26/61/a/3#gains_from_property\n    - 26/61/a/4#interest_income\n    - 26/61/a/7#dividend_income\n    - 26/61/a/10#pension_income\n    - 26/85/a#unemployment_compensation\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: USD\n  label: Gross Income\n  description: Total gross income from all sources per 26 USC Section 61\n  syntax: python\n  formula: |\n    return wages + salaries + tips + self_employment_income + gains_from_property + interest_income + dividend_income + pension_income + other_income + unemployment_compensation",
      "path": "cosilico-us/statute/26/61/a.rac"
    },
    {
      "citation": "26 USC Section 62(a)(12)",
      "title": "Health Savings Account Deduction",
      "text": "(12) Health savings account deduction.—The deduction allowed by\nsection 223.",
      "code": "variable hsa_deduction:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total HSA Deduction\"\n  description: \"Combined HSA deduction for tax unit\"\n  syntax: python\n  formula: |\n    # Must have HDHP to contribute\n    if not has_hdhp:\n      return 0\n    # Base limit depends on coverage type\n    if hsa_coverage_type == \"self_only\":\n      base_limit = self_only_limit\n    else:\n      base_limit = family_limit\n    # Add catch-up contribution if age 55 or older\n    if age >= catch_up_age:\n      return base_limit + catch_up_amount\n    return base_limit",
      "path": "cosilico-us/statute/26/62/a/12.rac"
    },
    {
      "citation": "26 USC Section 62(a)(17)",
      "title": "Student Loan Interest Deduction",
      "text": "(17) Interest on education loans.—The deduction allowed by section 221.",
      "code": "variable student_loan_interest_deduction:\n  imports: [26/1#filing_status]\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Student Loan Interest Deduction\"\n  description: \"Above-the-line deduction for student loan interest\"\n  syntax: python\n  formula: |\n    # Cannot deduct more than paid or the maximum\n    return min(student_loan_interest_paid, max_deduction)",
      "path": "cosilico-us/statute/26/62/a/17.rac"
    },
    {
      "citation": "26 USC Section 62(a)(2)(D)",
      "title": "Educator Expenses",
      "text": "(2) Certain trade and business deductions of employees.—\n(D) Deduction for certain expenses of eligible educators.—\nThe deductions allowed by section 162 which consist of expenses,\nnot in excess of $300, paid or incurred by an eligible educator—\n(i) by reason of the participation of the educator in professional\ndevelopment courses related to the curriculum in which the\neducator provides instruction or to the students for whom the\neducator provides instruction, and\n(ii) in connection with books, supplies (other than nonathletic\nsupplies for courses of instruction in health or physical\neducation), computer equipment (including related software\nand services), other equipment, and supplementary materials\nused by the eligible educator in the classroom.",
      "code": "variable educator_expense_deduction:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total Educator Expense Deduction\"\n  description: \"Combined educator expense deduction for tax unit (both spouses if applicable)\"\n  syntax: python\n  formula: |\n    # Only eligible educators can claim this deduction\n    if not is_eligible_educator:\n      return 0\n    return educator_expenses",
      "path": "cosilico-us/statute/26/62/a/2/D.rac"
    },
    {
      "citation": "26 USC Section 62(a)(23)",
      "title": "Qualified Tip Income Deduction",
      "text": "(23) Qualified tip income.—In the case of an individual, the deduction\nallowed by section 74A (relating to exclusion for qualified tips).",
      "code": "variable tip_income_deduction:\n  imports:\n    - 26/1#filing_status\n    - 26/62/a#adjusted_gross_income\n    - 26/1402/a#self_employment_income\n  entity: TaxUnit\n  period: Year\n  dtype: Boolean\n  unit: \"USD\"\n  label: \"Tip Income Deduction Available\"\n  description: \"Whether the tip income deduction is available in this tax year\"\n  syntax: python\n  formula: |\n    # For employees, no limit from self-employment\n    # For self-employed, cannot exceed net earnings from trade/business\n    if self_employment_income <= 0: return max_deduction  # Not self-employed, use full cap\n    return min(self_employment_income, max_deduction)",
      "path": "cosilico-us/statute/26/62/a/23.rac"
    },
    {
      "citation": "26 USC Section 62(a)(7)",
      "title": "IRA Deduction",
      "text": "(7) Retirement savings.—The deduction allowed by section 219 (relating\nto deduction for retirement savings).",
      "code": "variable ira_deduction:\n  imports: [26/1#filing_status]\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total IRA Deduction\"\n  description: \"Combined IRA deduction for tax unit\"\n  syntax: python\n  formula: |\n    base_limit = contribution_limit\n    # Add catch-up contribution if age 50 or older\n    if age >= catch_up_age:\n      return base_limit + catch_up_amount\n    return base_limit\n\n\n# Base TCJA values (2018) - contribution limit indexed annually\n# Current indexed values in IRS guidance files\n\nparameter contribution_limit:\n  description: \"IRA regular contribution limit\"\n  unit: \"USD\"\n  indexed_by: statute/26/219/b/5\n  values:\n    2018-01-01: 5500\n\n# Statutory fixed amount - not indexed\nparameter catch_up_amount:\n  description: \"IRA catch-up contribution for age 50+\"\n  unit: \"USD\"\n  values:\n    2006-01-01: 1000\n\n# Statutory age threshold - not indexed\nparameter catch_up_age:\n  description: \"Age at which catch-up contributions allowed\"\n  values:\n    2002-01-01: 50\n\n# Phase-out thresholds - indexed annually\nparameter phaseout_single_start:\n  description: \"IRA phase-out start for single filers covered by employer plan\"\n  unit: \"USD\"\n  indexed_by: statute/26/219/g\n  values:\n    2018-01-01: 63000\n\nparameter phaseout_single_end:\n  description: \"IRA phase-out end for single filers covered by employer plan\"\n  unit: \"USD\"\n  indexed_by: statute/26/219/g\n  values:\n    2018-01-01: 73000\n\nparameter phaseout_joint_start:\n  description: \"IRA phase-out start for joint filers (contributor covered)\"\n  unit: \"USD\"\n  indexed_by: statute/26/219/g\n  values:\n    2018-01-01: 101000\n\nparameter phaseout_joint_end:\n  description: \"IRA phase-out end for joint filers (contributor covered)\"\n  unit: \"USD\"\n  indexed_by: statute/26/219/g\n  values:\n    2018-01-01: 121000\n\nparameter phaseout_spouse_covered_start:\n  description: \"IRA phase-out start when only spouse is covered\"\n  unit: \"USD\"\n  indexed_by: statute/26/219/g\n  values:\n    2018-01-01: 189000\n\nparameter phaseout_spouse_covered_end:\n  description: \"IRA phase-out end when only spouse is covered\"\n  unit: \"USD\"\n  indexed_by: statute/26/219/g\n  values:\n    2018-01-01: 199000\n\n# Statutory fixed threshold - not indexed\nparameter phaseout_mfs_start:\n  description: \"IRA phase-out start for MFS when spouse is covered\"\n  unit: \"USD\"\n  values:\n    2018-01-01: 0\n\nparameter phaseout_mfs_end:\n  description: \"IRA phase-out end for MFS when spouse is covered\"\n  unit: \"USD\"\n  values:\n    2018-01-01: 10000\n\n\ninput traditional_ira_contributions:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Traditional IRA Contributions\"\n  description: \"Contributions made to traditional IRA during the tax year\"\n  default: 0\n\ninput has_retirement_plan_at_work:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"Covered by Employer Retirement Plan\"\n  description: \"Whether the individual is an active participant in an employer retirement plan\"\n  default: False\n\n\nvariable ira_contribution_limit:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"IRA Contribution Limit\"\n  description: \"Maximum allowable IRA contribution including catch-up\"\n  syntax: python\n  formula: |\n    base_limit = contribution_limit\n    # Add catch-up contribution if age 50 or older\n    if age >= catch_up_age:\n      return base_limit + catch_up_amount\n    return base_limit\n\nvariable ira_deduction_before_phaseout:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"IRA Deduction Before Phase-out\"\n  description: \"IRA deduction amount before applying income phase-out\"\n  syntax: python\n  formula: |\n    # Cannot deduct more than contributed or the annual limit\n    return min(traditional_ira_contributions, ira_contribution_limit)\n\nvariable ira_phaseout_ratio:\n  entity: Person\n  period: Year\n  dtype: Rate\n  label: \"IRA Deduction Phase-out Ratio\"\n  description: \"Ratio of IRA deduction that is phased out based on income\"\n  syntax: python\n  formula: |\n    # If not covered by employer plan, no phase-out applies\n    if not has_retirement_plan_at_work:\n      return 0\n    # Determine phase-out range based on filing status\n    start = phaseout_single_start\n    end = phaseout_single_end\n    magi = adjusted_gross_income\n    if magi <= start:\n      return 0  # No phase-out\n    if magi >= end:\n      return 1  # Fully phased out\n    # Proportional phase-out\n    return (magi - start) / (end - start)\n\nvariable ira_deduction:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"IRA Deduction\"\n  description: \"Above-the-line deduction for traditional IRA contributions\"\n  syntax: python\n  formula: |\n    base_deduction = ira_deduction_before_phaseout\n    phaseout = ira_phaseout_ratio\n    # Apply phase-out\n    return base_deduction * (1 - phaseout)\n\nvariable total_ira_deduction:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total IRA Deduction\"\n  description: \"Combined IRA deduction for tax unit\"\n  syntax: python\n  formula: |\n    return sum(members.ira_deduction)\n\n\nexamples:\n  - name: \"Under 50, no employer plan, full contribution\"\n  period: 2018-01\n    inputs:\n      person:\n        age: 35\n        traditional_ira_contributions: 5500\n        has_retirement_plan_at_work: false\n        adjusted_gross_income: 100000\n    outputs:\n      ira_deduction: 5500\n\n  - name: \"Age 50+, catch-up eligible\"\n  period: 2018-01\n    inputs:\n      person:\n        age: 55\n        traditional_ira_contributions: 6500\n        has_retirement_plan_at_work: false\n        adjusted_gross_income: 100000\n    outputs:\n      ira_contribution_limit: 6500\n      ira_deduction: 6500\n\n  - name: \"With employer plan, mid-phaseout\"\n  period: 2018-01\n    inputs:\n      person:\n        age: 40\n        traditional_ira_contributions: 5500\n        has_retirement_plan_at_work: true\n        adjusted_gross_income: 68000  # Midpoint of 63k-73k\n    outputs:\n      ira_phaseout_ratio: 0.5\n      ira_deduction: 2750",
      "path": "cosilico-us/statute/26/62/a/7.rac"
    },
    {
      "citation": "26 USC Section 6401",
      "title": "--- Merged from total_refundable_credits.rac ----",
      "text": "Section 6401(b) defines \"excessive credits\" as credits that exceed tax",
      "code": "variable total_refundable_credits:\n  imports:\n    - 26/32/a/1#earned_income_credit\n    - 26/24/d/1/B#additional_child_tax_credit\n    - 26/25A/a#education_credits_refundable\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total Refundable Credits\"\n  description: \"Sum of refundable credits that can generate refunds per 26 USC Section 6401\"\n  syntax: python\n  formula: |\n    # Sum all refundable credits\n    # These are NOT limited by tax liability and can create refunds\n    return earned_income_credit + additional_child_tax_credit + education_credits_refundable\n  default: 0",
      "path": "cosilico-us/statute/26/6401/a.rac"
    },
    {
      "citation": "26 USC Section 71",
      "title": "Alimony and Separate Maintenance Payments (Pre-2019)",
      "text": "(a) General rule.—Gross income includes amounts received as alimony\nor separate maintenance payments.\n(b) Alimony or separate maintenance payments defined.—For purposes of\nthis section—\n(1) In general.—The term 'alimony or separate maintenance payment'\nmeans any payment in cash if—\n(A) such payment is received by (or on behalf of) a spouse under\na divorce or separation instrument,\n(B) the divorce or separation instrument does not designate such\npayment as a payment which is not includible in gross income\nunder this section and not allowable as a deduction under\nsection 215,\n(C) in the case of an individual legally separated from his spouse\nunder a decree of divorce or of separate maintenance, the payee\nspouse and the payor spouse are not members of the same household\nat the time such payment is made, and\n(D) there is no liability to make any such payment for any period\nafter the death of the payee spouse and there is no liability\nto make any payment (in cash or property) as a substitute for\nsuch payments after the death of the payee spouse.\n(c) Payments to support children.—\n(1) In general.—Subsection (a) shall not apply to that part of any\npayment which the terms of the divorce or separation instrument\nfix (in terms of an amount of money or a part of the payment) as\na sum which is payable for the support of children of the payor\nspouse.",
      "code": "variable alimony_income:\n  imports: [26/1#filing_status]\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Tax Unit Taxable Alimony Income\"\n  description: \"Total alimony includible in gross income for the tax unit\"\n  syntax: python\n  formula: |\n    # Per TCJA: Only pre-2019 divorce instruments result in includible alimony income\n    if not is_pre_2019_divorce_agreement:\n    return 0\n    # Per 26 USC 71(a): Alimony received is gross income for pre-2019 agreements\n    # The alimony_income_inclusion_rate parameter confirms inclusion rules by year\n    # but the controlling factor is the agreement date, not the tax year\n    return alimony_received * alimony_income_inclusion_rate\n  default: 0",
      "path": "cosilico-us/statute/26/71.rac"
    },
    {
      "citation": "26 USC Section 72(t)",
      "title": "Additional Tax on Early Distributions",
      "text": "(t) 10-percent additional tax on early distributions from qualified\nretirement plans.--\n(1) Imposition of additional tax.--If any taxpayer receives any amount\nfrom a qualified retirement plan (as defined in section 4974(c)),\nthe taxpayer's tax under this chapter for the taxable year in which\nsuch amount is received shall be increased by an amount equal to\n10 percent of the portion of such amount which is includible in\ngross income.",
      "code": "variable early_withdrawal:\n  imports:\n    - 26/402/a#taxable_401k_distribution\n    - 26/62/a#adjusted_gross_income\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Early Withdrawal Penalty\"\n  description: \"10% additional tax on early distributions from retirement plans per 72(t)\"\n  syntax: python\n  formula: |\n    # No penalty if no taxable distribution\n    if taxable_401k_distribution <= 0:\n        return False\n    # Exception (A)(i): Age 59-1/2 or older\n    if age >= early_withdrawal_penalty_age:\n        return False\n    # Exception (A)(ii): Death\n    if is_death_distribution:\n        return False\n    # Exception (A)(iii): Disability\n    if is_disabled:\n        return False\n    # Exception (A)(iv): SEPP/72(t) payments\n    if is_sepp_distribution:\n        return False\n    # Exception (A)(vi): QDRO\n    if is_qdro_distribution:\n        return False\n    # Exception (A)(vii): Separation at 55+ (401k only)\n    if is_age_55_separation_distribution:\n        return False\n    # Exception (J): Terminal illness\n    if is_terminal_illness_distribution:\n        return False\n    # If none of the exceptions apply, penalty applies\n    return True\n  default: 0",
      "path": "cosilico-us/statute/26/402/e/4.rac"
    },
    {
      "citation": "26 USC Section 85",
      "title": "Unemployment Compensation in AGI",
      "text": "",
      "code": "variable unemployment_in_agi:\n  imports: [26/85/a#unemployment_compensation]\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Taxable Unemployment Compensation\"\n  description: \"Unemployment compensation included in gross income per 26 USC Section 85\"\n  syntax: python\n  formula: |\n    # Sum unemployment compensation from all members of the tax unit\n    # Post-2020: Full amount is included in gross income\n    return sum(members.unemployment_compensation)\n  default: 0",
      "path": "cosilico-us/statute/26/85.rac"
    },
    {
      "citation": "26 USC Section 85(a)",
      "title": "Unemployment Compensation",
      "text": "(a) General rule.—In the case of an individual, gross income includes\nunemployment compensation.",
      "code": "variable unemployment_compensation:\n  entity: Person\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Unemployment Compensation\"\n  description: \"Unemployment compensation received per 26 USC Section 85(a)\"",
      "path": "cosilico-us/statute/26/85/a.rac"
    },
    {
      "citation": "26 USC Section 86",
      "title": "Tax Unit Social Security Benefits",
      "text": "- 26 USC Section 86(d) - \"social security benefit\" definition",
      "code": "variable tax_unit_social_security:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total Social Security Benefits Received\"\n  description: \"Sum of Social Security and tier 1 railroad retirement benefits received by tax unit members per 26 USC Section 86(d)\"\n  default: 0\n\n\nvariable taxable_social_security:\n  imports:\n    - 26/86#tax_unit_social_security\n    - 26/1#filing_status\n  entity: TaxUnit\n  period: Year\n  dtype: Rate\n  unit: \"percentage\"\n  label: \"Taxable Fraction of Social Security\"\n  description: \"Portion of Social Security benefits included in taxable income\"\n  syntax: python\n  formula: |\n    # Get base amount based on filing status per 86(c)(1)\n    if filing_status == SINGLE:\n        base_amount = base_amount_single\n    elif filing_status == HEAD_OF_HOUSEHOLD:\n        base_amount = base_amount_single\n    elif filing_status == MARRIED_FILING_JOINTLY:\n        base_amount = base_amount_joint\n    elif filing_status == QUALIFYING_WIDOW:\n        base_amount = base_amount_joint\n    else:\n        base_amount = base_amount_mfs\n    excess = max(0, combined_income - base_amount)\n    # Lesser of 50% of benefits or 50% of excess over base\n    half_benefits = tier1_rate * tax_unit_social_security\n    half_excess = tier1_rate * excess\n    return min(half_benefits, half_excess)\n  default: 0",
      "path": "cosilico-us/statute/26/86.rac"
    },
    {
      "citation": "26 USC Section 86(b)",
      "title": "Combined Income",
      "text": "(b) Combined income\nFor purposes of this section, the term \"combined income\" means the sum of-\n(1) the modified adjusted gross income of the taxpayer for such taxable year, plus\n(2) one-half of the social security benefits received during the taxable year.",
      "code": "variable combined_income:\n  imports:\n    - 26/86/b#modified_agi\n    - 26/86#tax_unit_social_security\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Combined Income for Social Security Taxability\"\n  description: \"Modified AGI plus one-half of Social Security benefits per 26 USC Section 86(b)\"\n  syntax: python\n  formula: |\n    # Per Section 86(b)(1), combined income = MAGI + 0.5 * SS benefits\n    return modified_agi + (ss_fraction * tax_unit_social_security)\n\n\nvariable modified_agi:\n  imports:\n    - 26/62/a#adjusted_gross_income\n    - 26/103#tax_exempt_interest\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Modified Adjusted Gross Income for Social Security Taxability\"\n  description: \"AGI plus tax-exempt interest for determining taxable portion of Social Security benefits per 26 USC Section 86(b)(1)\"\n  syntax: python\n  formula: |\n    # Per Section 86(b)(1)(A) and IRS Publication 915:\n    # MAGI = AGI + tax-exempt interest\n    return adjusted_gross_income + tax_exempt_interest",
      "path": "cosilico-us/statute/26/86/b.rac"
    },
    {
      "citation": "42 USC 1382",
      "title": "Supplemental Security Income (SSI)",
      "text": "",
      "code": "variable ssi:\n  entity: Person\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"Supplemental Security Income\"\n  description: \"Monthly SSI payment per 42 USC 1382(b)\"\n  syntax: python\n  formula: |\n    if not is_ssi_categorical_eligible:\n        return 0\n    if not is_ssi_resource_eligible:\n        return 0\n    if not is_ssi_citizenship_eligible:\n        return 0\n    if not is_ssi_residency_eligible:\n        return 0\n    benefit = applicable_fbr - ssi_countable_income\n    return max(0, benefit)\n  default: 0",
      "path": "cosilico-us/statute/42/1382/ssi.rac"
    },
    {
      "citation": "42 USC 1382(a)(1)(A)",
      "title": "Age/Disability Eligibility",
      "text": "every individual who is... (A) is aged, blind, or disabled\nPer 42 USC 1382c(a)(1)(A), \"aged\" means attained age 65",
      "code": "variable age_requirement:\n  imports: [42/1382/parameters/age/threshold#age_threshold]\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"SSI categorical eligibility\"\n  description: \"Individual is aged (65+), blind, or disabled per 42 USC 1382(a)(1)(A)\"\n  formula: return age >= age_threshold\n  default: False\n\n\nvariable citizenship:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"SSI residency eligibility\"\n  description: \"Is resident of the United States per 42 USC 1382c(a)(1)(B)\"\n  formula: return is_us_citizen or is_qualified_alien\n  default: False\n\n\nvariable resource_test:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  unit: \"USD\"\n  label: \"SSI resource eligibility\"\n  description: \"Resources do not exceed limit per 42 USC 1382(a)(3)(B)\"\n  syntax: python\n  formula: |\n    if has_eligible_spouse:\n        return resource_limit_couple\n    return resource_limit_individual\n  default: False",
      "path": "cosilico-us/statute/42/1382/a.rac"
    },
    {
      "citation": "42 USC 1382(b)",
      "title": "Federal Benefit Rate (FBR)",
      "text": "(1) The benefit under this subchapter for an individual who does not\nhave an eligible spouse shall be payable at the rate of...\n(2) The benefit under this subchapter for an individual who has an\neligible spouse shall be payable at the rate of...",
      "code": "variable federal_benefit_rate:\n  entity: Person\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SSI applicable FBR\"\n  description: \"FBR after living arrangement reduction per 42 USC 1382(a)(2)(A)\"\n  syntax: python\n  formula: |\n    if has_eligible_spouse:\n        return fbr_couple\n    return fbr_individual",
      "path": "cosilico-us/statute/42/1382/b.rac"
    },
    {
      "citation": "42 USC 1382a(b)",
      "title": "--- Merged from income_exclusions.rac ----",
      "text": "(b)(2): \"the first $20 of any income\" (general exclusion)\n(b)(4): \"if the individual... is blind or disabled, the first $65\nof earned income... plus one-half of the remainder",
      "code": "variable income_exclusions:\n  entity: Person\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SSI total countable income\"\n  description: \"Sum of countable earned and unearned income per 42 USC 1382a\"\n  formula: return general_exclusion",
      "path": "cosilico-us/statute/42/1382a/a.rac"
    },
    {
      "citation": "42 USC 1382b(a)",
      "title": "--- Merged from resource_exclusions.rac ----",
      "text": "(a) In determining the resources of an individual... there shall\nbe excluded--\n(1) the home\n(2) household goods, personal effects, and an automobile\n(3) property of a trade or business essential for self-support\n(5) life insurance... aggregate face value does not exceed $1,500\n(9) amounts set aside for burial up to $1,500\n(10) burial spaces for the individual and spouse",
      "code": "variable resource_exclusions:\n  entity: Person\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SSI countable resources\"\n  description: \"Total resources minus exclusions per 42 USC 1382b(a)\"\n  syntax: python\n  formula: |\n    # Start with total resources\n    total = total_resources\n    # Exclude home (1)\n    after_home = total - primary_residence_value\n    # Exclude household goods and one automobile (2)\n    after_goods = after_home - household_goods_value - automobile_value\n    # Exclude qualifying burial funds up to limit (9)\n    if has_eligible_spouse:\n        burial_limit = burial_funds_limit_couple\n    else:\n        burial_limit = burial_funds_limit_individual\n    burial_exclusion = min(designated_burial_funds, burial_limit)\n    after_burial = after_goods - burial_exclusion\n    # Exclude life insurance if face value <= $1,500 (5)\n    if life_insurance_face_value <= life_insurance_limit:\n        life_exclusion = life_insurance_cash_value\n    else:\n        life_exclusion = 0\n    after_life = after_burial - life_exclusion\n    return max(0, after_life)",
      "path": "cosilico-us/statute/42/1382b/a.rac"
    },
    {
      "citation": "42 USC 1396a",
      "title": "Medicaid State Plans: Eligibility",
      "text": "(a) A State plan for medical assistance must--\n(10)(A) provide for making medical assistance available...\n(i) to all individuals receiving...supplemental security income...\n(ii) to all qualified pregnant women and children...",
      "code": "variable eligibility:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  syntax: python\n  formula: |\n    # FPL = base for 1 person + additional per person beyond 1\n    base = fpl_by_household_size[1]\n    additional = fpl_by_household_size[\"additional_per_person\"]\n    # Pregnant women count expected children in household size\n    extra_for_pregnancy = sum(members.is_pregnant)\n    effective_size = household_size + extra_for_pregnancy\n    extra_members = max(0, effective_size - 1)\n    return base + (additional * extra_members)\n  default: 0\n\n\n\n# ---- Merged from medicaid.rac ----\n\n# Title 42 USC 1396 - Medicaid (Grants to States for Medical Assistance Programs)\n#\nvariable medicaid:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"Medicaid Eligible\"\n  description: \"Eligible for Medicaid coverage under any pathway\"\n  formula: return medicaid_eligible\n  default: False\n\nvariable chip:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"CHIP Eligible\"\n  description: \"Eligible for Children's Health Insurance Program\"\n  formula: return chip_eligible\n  default: False\n\nvariable public_health_coverage_eligible:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"Public Health Coverage Eligible\"\n  description: \"Eligible for Medicaid or CHIP\"\n  formula: return medicaid_eligible or chip_eligible\n  default: False\n\nvariable household_magi:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"Household MAGI\"\n  description: \"Household Modified Adjusted Gross Income for Medicaid/ACA eligibility\"\n  formula: return magi_income\n  default: 0\n\nvariable household_magi_pct_fpl:\n  entity: Household\n  period: Month\n  dtype: Rate\n  label: \"Household MAGI as % FPL\"\n  description: \"Household MAGI income as percentage of Federal Poverty Level\"\n  formula: return magi_income_pct_fpl\n  default: 0",
      "path": "cosilico-us/statute/42/1396/a.rac"
    },
    {
      "citation": "42 USC 1396a(a)(10)(A)(i)(VIII)",
      "title": "ACA Medicaid Expansion",
      "text": "(VIII) who are described in subsection (k)(2)\n(2) Newly eligible.--An individual is described in this paragraph if\nsuch individual--\n(A) is not under 19 years of age,\n(B) is not described in subclause (I), (II), or (VII) of paragraph (1),\n(C) is not described in any of clauses (i) through (v) of paragraph (10)(A)\n(related to mandatorily covered groups other than newly eligible),\n(D) is not entitled to or enrolled for benefits under part A or B of\ntitle XVIII (Medicare), and\n(E) has household income that does not exceed 133 percent of the\npoverty line applicable to the size of the household.",
      "code": "variable expansion:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"Qualifies for enhanced FMAP\"\n  description: \"Eligible for enhanced federal match under expansion\"\n  syntax: python\n  formula: |\n    # Must be at least 19 (not under 19)\n    if age < age_child_max:\n        return False\n    # Must be under 65 (not Medicare aged)\n    if age >= age_elderly_min:\n        return False\n    return True\n  default: false",
      "path": "cosilico-us/statute/42/1396/d.rac"
    },
    {
      "citation": "42 USC 1396a(e)(14)",
      "title": "Modified Adjusted Gross Income (MAGI)",
      "text": "(14) INCOME DETERMINED USING MODIFIED ADJUSTED GROSS INCOME.--\n(A) In general.-- ...the State shall determine income eligibility\nfor medical assistance... using modified adjusted gross income...",
      "code": "variable income_methodology:\n  imports:\n    - 26/62/a#adjusted_gross_income\n    - 26/103#tax_exempt_interest\n    - 26/86#taxable_social_security\n  entity: Person\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"Countable scholarship income\"\n  description: \"Scholarship income counted under MAGI\"\n  syntax: python\n  formula: |\n    # Start with AGI (26 USC 62)\n    agi = adjusted_gross_income\n    # Add tax-exempt interest (26 USC 103)\n    exempt_interest = tax_exempt_interest\n    # Add non-taxable Social Security benefits\n    # 42 CFR 435.603(e): add back SS that was excluded from gross income\n    total_ss = social_security_benefits\n    taxable_ss = taxable_social_security\n    nontaxable_ss = max(0, total_ss - taxable_ss)\n    # Add back foreign earned income exclusion (26 USC 911)\n    foreign_exclusion = foreign_earned_income_exclusion\n    return agi + exempt_interest + nontaxable_ss + foreign_exclusion\n  default: 0",
      "path": "cosilico-us/statute/42/1396/b.rac"
    },
    {
      "citation": "42 USC 1396a(e)(14)",
      "title": "Modified Adjusted Gross Income (MAGI)",
      "text": "(14) INCOME DETERMINED USING MODIFIED ADJUSTED GROSS INCOME.--\n(A) In general.-- ...the State shall determine income eligibility\nfor medical assistance... using modified adjusted gross income...",
      "code": "variable income_methodology:\n  imports:\n    - 26/62/a#adjusted_gross_income\n    - 26/103#tax_exempt_interest\n    - 26/86#taxable_social_security\n  entity: Person\n  period: Month\n  dtype: Money\n  syntax: python\n  formula: |\n    # Start with AGI (26 USC 62)\n    agi = adjusted_gross_income\n    # Add tax-exempt interest (26 USC 103)\n    exempt_interest = tax_exempt_interest\n    # Add non-taxable Social Security benefits\n    total_ss = social_security_benefits\n    taxable_ss = taxable_social_security\n    nontaxable_ss = max(0, total_ss - taxable_ss)\n    # Foreign earned income exclusion (26 USC 911)\n    # TODO: Add foreign_earned_income_exclusion when implemented\n    return agi + exempt_interest + nontaxable_ss",
      "path": "cosilico-us/statute/42/1396/a/2.rac"
    },
    {
      "citation": "42 USC 1396o",
      "title": "Cost Sharing (Premiums, Deductibles, Copayments)",
      "text": "",
      "code": "variable medicaid_child_cost_share_exempt:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"Child exempt from cost sharing\"\n  description: \"Children under 18 are exempt from cost sharing per 42 USC 1396o(b)(3)(A)\"\n  syntax: python\n  formula: |\n    # Children under child_age_threshold are fully exempt\n    if age < child_age_threshold:\n        return True\n    return False\n  default: True\n\nvariable medicaid_pregnant_cost_share_exempt:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"Pregnant exempt from cost sharing\"\n  description: \"Pregnant women are exempt from cost sharing per 42 USC 1396o(b)(3)(B)\"\n  formula: return is_pregnant\n  default: False\n\nvariable medicaid_institutionalized_cost_share_exempt:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"Institutionalized exempt from cost sharing\"\n  description: \"Institutionalized individuals exempt per 42 USC 1396o(b)(3)(C)\"\n  syntax: python\n  formula: |\n    # Nursing home residents, ICF residents, etc.\n    if is_institutionalized:\n        return True\n    return False\n  default: False\n\nvariable medicaid_hospice_cost_share_exempt:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"Hospice exempt from cost sharing\"\n  description: \"Individuals in hospice exempt per 42 USC 1396o(b)(3)(D)\"\n  formula: return is_hospice_enrolled\n  default: False\n\nvariable medicaid_cost_share_exempt:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"Exempt from cost sharing\"\n  description: \"Individual is fully exempt from Medicaid cost sharing\"\n  syntax: python\n  formula: |\n    # Any exempt category means no cost sharing\n    if medicaid_child_cost_share_exempt:\n        return True\n    if medicaid_pregnant_cost_share_exempt:\n        return True\n    if medicaid_institutionalized_cost_share_exempt:\n        return True\n    if medicaid_hospice_cost_share_exempt:\n        return True\n    return False\n  default: False\n\nvariable medicaid_nominal_cost_share_tier:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"Nominal cost sharing tier\"\n  description: \"Subject to nominal cost sharing only (below 100% FPL)\"\n  syntax: python\n  formula: |\n    income_pct = household.magi_income_pct_fpl\n    return income_pct < nominal_tier_fpl_threshold\n  default: True\n\nvariable medicaid_moderate_cost_share_tier:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"Moderate cost sharing tier\"\n  description: \"Subject to up to 10% cost sharing (100 to 150 percent FPL)\"\n  syntax: python\n  formula: |\n    income_pct = household.magi_income_pct_fpl\n    return income_pct >= nominal_tier_fpl_threshold and income_pct < moderate_tier_fpl_threshold\n  default: False\n\nvariable medicaid_higher_cost_share_tier:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"Higher cost sharing tier\"\n  description: \"Subject to up to 20% cost sharing (above 150% FPL)\"\n  syntax: python\n  formula: |\n    income_pct = household.magi_income_pct_fpl\n    return income_pct >= moderate_tier_fpl_threshold\n  default: False\n\nvariable medicaid_max_copayment_rate:\n  entity: Person\n  period: Month\n  dtype: Rate\n  label: \"Maximum copayment rate\"\n  description: \"Maximum copayment as percentage of service cost\"\n  syntax: python\n  formula: |\n    # Exempt individuals pay nothing\n    if medicaid_cost_share_exempt:\n        return 0\n    # Nominal tier: up to $4 per service (not percentage-based)\n    if medicaid_nominal_cost_share_tier:\n        return 0  # Handled by nominal_copayment instead\n    # 100-150% FPL: up to 10% of service cost\n    if medicaid_moderate_cost_share_tier:\n        return copayment_rate_100_150_fpl\n    # Above 150% FPL: up to 20% of service cost\n    if medicaid_higher_cost_share_tier:\n        return copayment_rate_150_plus_fpl\n    return 0\n  default: 0\n\nvariable medicaid_nominal_copayment:\n  entity: Person\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"Nominal copayment\"\n  description: \"Maximum nominal copayment for individuals below 100% FPL\"\n  syntax: python\n  formula: |\n    # Exempt individuals pay nothing\n    if medicaid_cost_share_exempt:\n        return 0\n    # Only applies to nominal tier\n    if not medicaid_nominal_cost_share_tier:\n        return 0\n    # Federal maximum nominal copayment\n    return nominal_copayment_max\n  default: 0\n\nvariable medicaid_premium_applicable:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"Medicaid premium applicable\"\n  description: \"Whether premiums may be charged for this enrollee\"\n  syntax: python\n  formula: |\n    # Exempt groups cannot be charged premiums\n    if medicaid_cost_share_exempt:\n        return False\n    # Premiums not allowed for mandatory groups below 150% FPL\n    income_pct = household.magi_income_pct_fpl\n    category = medicaid_category\n    # Children, pregnant women: no premiums regardless of income\n    if category == \"infant\":\n        return False\n    if category == \"child_1_5\":\n        return False\n    if category == \"child_6_18\":\n        return False\n    if category == \"pregnant\":\n        return False\n    # Below 150% FPL: no premiums for mandatory groups\n    if income_pct < premium_fpl_threshold:\n        return False\n    # Expansion adults above 150% FPL: state may charge premiums\n    return True\n  default: False\n\nvariable medicaid_max_monthly_premium:\n  entity: Person\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"Maximum Medicaid premium\"\n  description: \"Maximum monthly premium that may be charged\"\n  syntax: python\n  formula: |\n    if not medicaid_premium_applicable:\n        return 0\n    # Premium capped at percentage of income\n    # Varies by state, federal maximum is typically tied to 5% aggregate limit\n    # State-specific implementation needed\n    # Default: no premium (states set their own)\n    return 0\n  default: 0\n\nvariable medicaid_monthly_cost_share_limit:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"Monthly cost sharing limit\"\n  description: \"Maximum total monthly cost sharing for household (5% of income)\"\n  syntax: python\n  formula: |\n    # Total cost sharing (premiums + copays + deductibles) cannot exceed 5% of income\n    monthly_income = magi_income\n    # 5% of monthly household income\n    return monthly_income * aggregate_cost_share_limit\n  default: 0\n\nvariable medicaid_annual_cost_share_limit:\n  entity: Household\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Annual cost sharing limit\"\n  description: \"Maximum total annual cost sharing for household\"\n  formula: return medicaid_monthly_cost_share_limit * months_per_year\n  default: 0\n\nvariable medicaid_emergency_cost_share_exempt:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"Emergency services exempt\"\n  description: \"Emergency services cannot have cost sharing per 42 USC 1396o(b)(2)(D)\"\n  syntax: python\n  formula: |\n    # This is always true - emergency services are always exempt\n    # The variable exists to flag this protection\n    return True\n  default: True\n\nvariable medicaid_preventive_cost_share_exempt:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"Preventive services exempt\"\n  description: \"Preventive services exempt from cost sharing per federal requirements\"\n  syntax: python\n  formula: |\n    # Preventive services are exempt for most Medicaid populations\n    # This includes immunizations, screenings, well-child visits\n    return True\n  default: True",
      "path": "cosilico-us/statute/42/1396/o.rac"
    },
    {
      "citation": "42 USC 1397aa",
      "title": "--- Merged from eligibility.rac ----",
      "text": "SEC. 2110. [42 U.S.C. 1397jj] DEFINITIONS.\n(a) CHILD.--\n(1) IN GENERAL.--Subject to paragraph (2), the term 'child' means an\nindividual under 19 years of age.\n(b) TARGETED LOW-INCOME CHILD.--The term 'targeted low-income child' means\na child--\n(1) who has been determined eligible by the State for child health\nassistance under the State child health plan;\n(2)(A) who is a low-income child, or\n(B) is a child--\n(i) whose family income... exceeds the medicaid applicable income\nlevel..., but\n(ii) does not exceed 50 percentage points above the medicaid\napplicable income level...;\n(3) who is not found to be eligible for medical assistance under\ntitle XIX or... under a waiver...;\n(4) who is not covered under a group health plan or under health\ninsurance coverage...",
      "code": "variable eligibility:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"CHIP Eligible (Any Pathway)\"\n  description: \"Person eligible through any CHIP pathway\"\n  formula: return age < max_age\n  default: CHIPCategory.NONE",
      "path": "cosilico-us/statute/42/1397aa-1397mm/1397aa/a.rac"
    },
    {
      "citation": "42 USC 1397aa",
      "title": "--- Merged from chip.rac ----",
      "text": "SEC. 2101. [42 U.S.C. 1397aa] PURPOSE; STATE CHILD HEALTH PLANS.\n(a) PURPOSE.--The purpose of this title is to provide funds to States\nto enable them to initiate and expand the provision of child health\nassistance to uninsured, low-income children in an effective and\nefficient manner...",
      "code": "variable chip:\n  entity: Household\n  period: Year\n  dtype: Integer\n  unit: \"USD\"\n  label: \"CHIP Coverage Gap Count\"\n  description: \"Number of CHIP-eligible persons facing cost-sharing burden\"\n  syntax: python\n  formula: |\n    # Not eligible: no benefit\n    if not is_chip_eligible:\n        return 0\n    # Eligible: return per-capita benefit value\n    return per_capita_chip_benefit",
      "path": "cosilico-us/statute/42/1397aa-1397mm/a.rac"
    },
    {
      "citation": "42 USC 1397bb",
      "title": "--- Merged from benefits.rac ----",
      "text": "SEC. 2102. [42 U.S.C. 1397bb] STATE CHILD HEALTH PLANS.\n(a) REQUIREMENTS.--A State child health plan shall include a description of--\n(1) the extent to which... the plan meets... the requirements of\nsection 2103;\n...\n(b) GENERAL CONTENTS.--A State child health plan shall include a description,\nconsistent with subsection (a), of--\n(1) the proposed type... of the plan...\n(A) obtain health benefits coverage that meets the requirements of\nsection 2103 through--\n(i) a separate child health program;\n(ii) an expansion of coverage under the State's medicaid plan\nunder title XIX; or\n(iii) a combination of both such program and expansion...",
      "code": "variable benefits:\n  entity: Household\n  period: Year\n  dtype: Boolean\n  unit: \"USD\"\n  label: \"Household Has CHIP Eligible\"\n  description: \"Household contains at least one CHIP-eligible person\"\n  syntax: python\n  formula: |\n    # Only calculate for eligible individuals\n    if not is_chip_eligible:\n        return 0\n    # Get state-specific per-capita value if available\n    # Otherwise use national average from calibration\n    state = household.state_code\n    # Per-capita spending varies by state from ~$2,000 to ~$5,000 annually\n    # This includes medical, dental, vision, and administrative costs\n    #\n    # Note: Actual benefit value to individual may differ from spending due to:\n    # - Adverse selection\n    # - Provider reimbursement rates\n    # - Utilization patterns\n    # - Administrative overhead\n    #\n    # Using calibration data as best available estimate\n    return per_capita_spending",
      "path": "cosilico-us/statute/42/1397aa-1397mm/1397bb/a.rac"
    },
    {
      "citation": "42 USC 1397cc",
      "title": "--- Merged from cost_sharing.rac ----",
      "text": "SEC. 2103. [42 U.S.C. 1397cc] COVERAGE REQUIREMENTS FOR CHILDREN'S HEALTH\nINSURANCE.\n...\n(e) COST-SHARING.--\n(1) DESCRIPTION; GENERAL CONDITIONS.--\n(A) DESCRIPTION.--A State child health plan shall include a\ndescription, consistent with this subsection, of the amount\n(if any) of premiums, deductibles, coinsurance, and other\ncost sharing imposed under the plan.\n...\n(3) LIMITATIONS ON COST SHARING.--\n(A) CHILDREN IN FAMILIES WITH INCOME BELOW 150 PERCENT OF\nPOVERTY LINE.--In the case of children in a family... at or\nbelow 150 percent of the poverty line... the State child\nhealth plan may only impose premiums... that are not in\nexcess of the amounts of... premiums... permitted...\nunder section 1916...\n(B) OTHER CHILDREN.--For children not described in subparagraph\n(A), the State child health plan may not impose any form of\ncost sharing... the cumulative amount of which exceeds\n5 percent of a family's income for the year involved.",
      "code": "variable cost_sharing:\n  entity: Household\n  period: Year\n  dtype: Boolean\n  unit: \"USD\"\n  label: \"CHIP Affordable\"\n  description: \"CHIP cost-sharing is within 5% of household income\"\n  syntax: python\n  formula: |\n    # Only applicable to CHIP-eligible persons\n    if not is_chip_eligible:\n        return False\n    # Check income against cost-sharing exemption threshold\n    income_pct_fpl = medicaid_income_level\n    # Below 150% FPL: exempt from most cost-sharing\n    return income_pct_fpl <= cost_sharing_exempt_threshold",
      "path": "cosilico-us/statute/42/1397aa-1397mm/1397cc/a.rac"
    },
    {
      "citation": "42 USC 1437f(a)",
      "title": "Eligibility for Housing Choice Voucher",
      "text": "The Secretary may enter into annual contributions contracts with\npublic housing agencies pursuant to which such agencies may enter\ninto contracts to make assistance payments to owners...\nadmissions must be \"extremely low income\" (30% AMI or below).",
      "code": "variable hcv_very_low_income_limit:\n  entity: Household\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Very Low Income Limit\"\n  description: \"50% of Area Median Income limit for HCV eligibility\"\n  syntax: python\n  formula: |\n    # Income limit varies by household size\n    # For sizes > max_table_size, add per-person amount\n    limits = parameter(gov.hud.hcv.income_limits.very_low_income)\n    additional = parameter(gov.hud.hcv.income_limits.very_low_income.additional_per_person)\n    if household_size <= max_table_size:\n        return limits[household_size]\n    else:\n        base = limits[max_table_size]\n        extra_members = household_size - max_table_size\n        return base + (additional * extra_members)\n  default: 0\n\nvariable hcv_extremely_low_income_limit:\n  entity: Household\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Extremely Low Income Limit\"\n  description: \"30% of Area Median Income limit for targeting requirement\"\n  syntax: python\n  formula: |\n    limits = parameter(gov.hud.hcv.income_limits.extremely_low_income)\n    additional = parameter(gov.hud.hcv.income_limits.extremely_low_income.additional_per_person)\n    if household_size <= max_table_size:\n        return limits[household_size]\n    else:\n        base = limits[max_table_size]\n        extra_members = household_size - max_table_size\n        return base + (additional * extra_members)\n  default: 0\n\nvariable hcv_low_income_limit:\n  entity: Household\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Low Income Limit\"\n  description: \"80% of Area Median Income limit for continued occupancy\"\n  syntax: python\n  formula: |\n    limits = parameter(gov.hud.hcv.income_limits.low_income)\n    additional = parameter(gov.hud.hcv.income_limits.low_income.additional_per_person)\n    if household_size <= max_table_size:\n        return limits[household_size]\n    else:\n        base = limits[max_table_size]\n        extra_members = household_size - max_table_size\n        return base + (additional * extra_members)\n  default: 0\n\nvariable hcv_income_eligible:\n  entity: Household\n  period: Year\n  dtype: Boolean\n  label: \"HCV Income Eligible\"\n  description: \"Whether household meets 50% AMI income eligibility for HCV\"\n  formula: return hcv_annual_income <= hcv_very_low_income_limit\n  default: False\n\nvariable hcv_extremely_low_income:\n  entity: Household\n  period: Year\n  dtype: Boolean\n  label: \"HCV Extremely Low Income\"\n  description: \"Whether household is at or below 30% AMI for targeting purposes\"\n  formula: return hcv_annual_income <= hcv_extremely_low_income_limit\n  default: False\n\nvariable hcv_family_eligible:\n  entity: Household\n  period: Year\n  dtype: Boolean\n  label: \"HCV Family Composition Eligible\"\n  description: \"Whether household constitutes a family under HCV rules\"\n  syntax: python\n  formula: |\n    # A family includes:\n    # (1) Two or more persons who intend to share residency\n    # (2) Single person who is elderly, disabled, displaced, or other\n    #     category determined by PHA\n    # (3) Remaining member of tenant family\n    # For modeling, we assume any household constitutes a family\n    # PHAs have discretion in family definitions\n    if household_size >= 1:\n        return True\n    return False\n  default: False\n\nvariable hcv_citizenship_eligible:\n  entity: Household\n  period: Year\n  dtype: Boolean\n  label: \"HCV Citizenship/Immigration Eligible\"\n  description: \"Whether at least one household member has eligible immigration status\"\n  syntax: python\n  formula: |\n    # At least one family member must be:\n    # - U.S. citizen\n    # - National\n    # - Eligible immigrant (as defined in 42 USC 1436a)\n    #\n    # For modeling, we check for presence of eligible member\n    if has_eligible_citizen_or_immigrant:\n        return True\n    return False\n  default: False\n\nvariable hcv_eligible:\n  entity: Household\n  period: Year\n  dtype: Boolean\n  label: \"HCV Eligible\"\n  description: \"Whether household meets all HCV eligibility requirements\"\n  syntax: python\n  formula: |\n    # Must meet all eligibility requirements:\n    # (1) Income eligibility (50% AMI)\n    # (2) Family composition\n    # (3) Citizenship/immigration status\n    if hcv_income_eligible and hcv_family_eligible and hcv_citizenship_eligible:\n        return True\n    return False\n  default: False",
      "path": "cosilico-us/statute/42/1437f/a.rac"
    },
    {
      "citation": "42 USC 1437f(o)(2)",
      "title": "Tenant Contribution",
      "text": "The monthly assistance payment... shall be the amount by which the\nrent (including the amount allowed for tenant-paid utilities) for\nthe dwelling unit... exceeds the greatest of--\n(A) 30 percent of the monthly adjusted income of the family;\n(B) 10 percent of the monthly income of the family; or\n(C) if the family is receiving payments for welfare assistance...\nthe portion of such payments which is specifically designated\nby such agency to meet the housing costs of the family.",
      "code": "variable hcv_contribution_30_adjusted:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV 30% Adjusted Income Contribution\"\n  description: \"30% of monthly adjusted income per 24 CFR 5.628(a)(1)\"\n  syntax: python\n  formula: |\n    rate = parameter(gov.hud.hcv.tenant_contribution.income_rate)\n    return round(hcv_monthly_adjusted_income * rate)\n  default: 0\n\nvariable hcv_contribution_10_gross:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV 10% Gross Income Contribution\"\n  description: \"10% of monthly gross income per 24 CFR 5.628(a)(2)\"\n  syntax: python\n  formula: |\n    rate = parameter(gov.hud.hcv.tenant_contribution.gross_income_rate)\n    monthly_gross = hcv_annual_income / months_per_year\n    return round(monthly_gross * rate)\n  default: 0\n\nvariable hcv_welfare_rent:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Welfare Rent\"\n  description: \"Welfare assistance portion designated for housing\"\n  syntax: python\n  formula: |\n    # Welfare rent = portion of welfare designated for housing\n    # Only applies if welfare agency designates housing portion\n    return welfare_housing_portion\n  default: 0\n\nvariable hcv_minimum_rent:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Minimum Rent\"\n  description: \"PHA-determined minimum rent ($0-$50)\"\n  syntax: python\n  formula: |\n    # Using default minimum rent from parameters\n    # PHAs may set lower (including $0) with hardship exemptions\n    return parameter(gov.hud.hcv.tenant_contribution.minimum_rent.default)\n  default: 50\n\nvariable hcv_total_tenant_payment:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Total Tenant Payment\"\n  description: \"Monthly tenant contribution - greatest of 30% adjusted, 10% gross, welfare rent, or minimum rent\"\n  syntax: python\n  formula: |\n    # Per 24 CFR 5.628, TTP = greatest of:\n    # (A) 30% of adjusted monthly income\n    # (B) 10% of monthly gross income\n    # (C) Welfare rent (if applicable)\n    # (D) Minimum rent\n    ttp_adjusted = hcv_contribution_30_adjusted\n    ttp_gross = hcv_contribution_10_gross\n    ttp_welfare = hcv_welfare_rent\n    ttp_minimum = hcv_minimum_rent\n    # Take the greatest\n    ttp = max(ttp_adjusted, ttp_gross)\n    ttp = max(ttp, ttp_welfare)\n    ttp = max(ttp, ttp_minimum)\n    return ttp\n  default: 0\n\nvariable hcv_tenant_rent_to_owner:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Tenant Rent to Owner\"\n  description: \"Amount tenant pays directly to landlord\"\n  syntax: python\n  formula: |\n    # Tenant rent = greater of:\n    # (1) TTP - utility allowance, OR\n    # (2) Gross rent - HAP\n    # First calculate based on TTP\n    rent_from_ttp = max(0, hcv_total_tenant_payment - utility_allowance)\n    # If gross rent exceeds payment standard, tenant pays the excess\n    excess_rent = max(0, gross_rent - payment_standard)\n    rent_with_excess = rent_from_ttp + excess_rent\n    return rent_with_excess\n  default: 0\n\nvariable hcv_utility_reimbursement:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Utility Reimbursement\"\n  description: \"Reimbursement when utility allowance exceeds TTP\"\n  syntax: python\n  formula: |\n    # If utility allowance > TTP, family receives the difference\n    reimbursement = utility_allowance - hcv_total_tenant_payment\n    return max(0, reimbursement)\n  default: 0",
      "path": "cosilico-us/statute/42/1437f/c.rac"
    },
    {
      "citation": "42 USC 1437f(o)(2)",
      "title": "Housing Assistance Payment",
      "text": "",
      "code": "variable hcv_voucher_size:\n  entity: Household\n  period: Year\n  dtype: Integer\n  label: \"HCV Voucher Size\"\n  description: \"Number of bedrooms for voucher based on family composition\"\n  syntax: python\n  formula: |\n    # PHA subsidy standards determine bedroom size\n    # Typical standards:\n    # - Head of household and spouse: 1 bedroom\n    # - Each 2 additional family members: 1 bedroom\n    # - Children of opposite sex may share until certain age\n    # Simplified formula for modeling:\n    # Bedrooms = head_spouse_bedrooms + ceiling((members - base_voucher_bedroom_count) / persons_per_bedroom)\n    if household_size <= base_voucher_bedroom_count:\n        return head_spouse_bedrooms\n    additional_members = household_size - base_voucher_bedroom_count\n    additional_bedrooms = ceil(additional_members / persons_per_bedroom)\n    return head_spouse_bedrooms + additional_bedrooms\n  default: 1\n\nvariable hcv_payment_standard:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Payment Standard\"\n  description: \"Payment standard amount based on voucher bedroom size\"\n  syntax: python\n  formula: |\n    voucher_size = hcv_voucher_size\n    # Look up payment standard by bedroom size from parameter table\n    standards = parameter(gov.hud.hcv.payment_standards.by_bedroom)\n    additional = parameter(gov.hud.hcv.payment_standards.additional_per_bedroom)\n    if voucher_size < max_bedroom_count:\n        return standards[voucher_size]\n    else:\n        # For larger units, use max BR base + additional per bedroom\n        base = standards[max_bedroom_count]\n        return base + ((voucher_size - max_bedroom_count) * additional)\n  default: 0\n\nvariable hcv_gross_rent:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Gross Rent\"\n  description: \"Contract rent plus utility allowance\"\n  syntax: python\n  formula: |\n    # Contract rent = rent paid to owner\n    # Utility allowance = PHA estimate of tenant-paid utilities\n    return contract_rent + utility_allowance\n  default: 0\n\nvariable hcv_housing_assistance_payment:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Housing Assistance Payment\"\n  description: \"Monthly subsidy paid by PHA to landlord\"\n  syntax: python\n  formula: |\n    # First check eligibility\n    if not hcv_eligible:\n        return 0\n    ttp = hcv_total_tenant_payment\n    # HAP = lesser of:\n    # (1) Payment standard minus TTP\n    # (2) Gross rent minus TTP\n    hap_from_standard = hcv_payment_standard - ttp\n    hap_from_rent = hcv_gross_rent - ttp\n    hap = min(hap_from_standard, hap_from_rent)\n    # HAP cannot be negative\n    return max(0, hap)\n  default: 0\n\nvariable hcv_rent_reasonable:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"HCV Rent Reasonable\"\n  description: \"Whether rent is reasonable compared to market\"\n  syntax: python\n  formula: |\n    # Rent reasonableness is determined by PHA comparison\n    # to comparable market units. For modeling, we assume\n    # rent is reasonable if within the reasonableness threshold of payment standard.\n    reasonableness_limit = hcv_payment_standard * rent_reasonableness_threshold\n    if hcv_gross_rent <= reasonableness_limit:\n        return True\n    return False\n  default: True\n\nvariable hcv_initial_affordability_check:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"HCV Initial Affordability Check\"\n  description: \"Whether family share is affordable at initial lease-up (40% limit)\"\n  syntax: python\n  formula: |\n    family_share = hcv_gross_rent - hcv_housing_assistance_payment\n    max_share_rate = parameter(gov.hud.hcv.housing_assistance.maximum_family_share.at_initial_lease)\n    max_share = hcv_monthly_adjusted_income * max_share_rate\n    # Family share at move-in cannot exceed 40% of adjusted income\n    if family_share <= max_share:\n        return True\n    return False\n  default: True\n\nvariable hcv_family_payment:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Family Payment\"\n  description: \"Total amount tenant pays (gross rent minus HAP)\"\n  syntax: python\n  formula: |\n    # Family pays: Gross rent - HAP\n    # Or equivalently: TTP + any excess rent over payment standard\n    family_share = hcv_gross_rent - hcv_housing_assistance_payment\n    return max(0, family_share)\n  default: 0\n\nvariable hcv_payment_to_owner:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"HCV Payment to Owner\"\n  description: \"HAP amount paid directly to landlord\"\n  syntax: python\n  formula: |\n    # HAP paid directly to owner\n    # May be less than full HAP if utility allowance creates reimbursement\n    hap = hcv_housing_assistance_payment\n    # Payment to owner cannot exceed contract rent\n    return min(hap, contract_rent)\n  default: 0\n\nvariable hcv:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"Section 8 Housing Choice Voucher\"\n  description: \"Monthly Housing Choice Voucher benefit (Housing Assistance Payment)\"\n  formula: return hcv_housing_assistance_payment\n  default: 0",
      "path": "cosilico-us/statute/42/1437f/d.rac"
    },
    {
      "citation": "42 USC 1758(b)",
      "title": "Categorical Eligibility for School Meals",
      "text": "verification through \"categorical eligibility\" (also called \"direct certification\"):\n(ii) A child... is a member of a household receiving assistance under\nthe supplemental nutrition assistance program authorized under the Food\nand Nutrition Act of 2008... shall be considered automatically eligible\nfor free lunches and free breakfasts\n(5) A child who is a member of a household receiving assistance under the\nprogram for aid to families with dependent children... who is a foster\nchild whose care and placement is the responsibility of an agency...\n(12)(A) A child who is a member of a household that receives assistance\nunder a program funded by the McKinney-Vento Homeless Assistance Act...\na runaway child... or a migratory child...",
      "code": "variable categorical_eligibility:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  formula: return receives_snap\n\n\nvariable income_eligibility:\n  imports:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  syntax: python\n  formula: |\n    # FPL = base for size 1-max, then additional per person for each beyond max\n    size = min(household_size, fpl_max_size)\n    base = fpl.by_household_size[size]\n    extra_members = max(0, household_size - fpl_max_size)\n    additional = fpl.additional_per_person\n    return base + (additional * extra_members)\n\n\n# ---- Merged from categorical.rac ----\n\n# 42 USC 1758(b) - Categorical Eligibility for School Meals\n#\n\ntext: \"\"\"\nincome verification through \"categorical eligibility\" (direct certification).\n(ii) A child... is a member of a household receiving assistance under\nthe supplemental nutrition assistance program authorized under the Food\nand Nutrition Act of 2008... shall be considered automatically eligible\nfor free lunches and free breakfasts\n(5) A child who is a member of a household... who is a foster child\nwhose care and placement is the responsibility of an agency that\nadministers a State plan under part B or E of title IV of the\nSocial Security Act\n(12)(A) A child who is a member of a household that receives assistance\nunder a program funded by the McKinney-Vento Homeless Assistance Act...\na runaway child... or a migratory child...\n(I) the supplemental nutrition assistance program authorized under\nthe Food and Nutrition Act of 2008 (7 U.S.C. 2011 et seq.)\n\"\"\"\nvariable school_meal_snap_categorically_eligible:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  syntax: python\n  formula: |\n    # Household receives SNAP benefits\n    return household.receives_snap\n\nvariable school_meal_tanf_categorically_eligible:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  syntax: python\n  formula: |\n    # Household receives TANF benefits\n    return household.receives_tanf\n\nvariable school_meal_fdpir_categorically_eligible:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  syntax: python\n  formula: |\n    # Household receives FDPIR (Food Distribution Program on Indian Reservations)\n    return household.receives_fdpir\n\nvariable school_meal_foster_categorically_eligible:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  formula: return is_foster_child\n\nvariable school_meal_homeless_categorically_eligible:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  formula: return is_homeless\n\nvariable school_meal_runaway_categorically_eligible:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  formula: return is_runaway_child\n\nvariable school_meal_migrant_categorically_eligible:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  formula: return is_migratory_child\n\nvariable school_meal_head_start_categorically_eligible:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  formula: return is_head_start_eligible\n\nvariable school_meal_categorically_eligible:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  syntax: python\n  formula: |\n    # 42 USC 1758(b)(2)(C)(ii) - Program participation\n    snap_eligible = school_meal_snap_categorically_eligible\n    tanf_eligible = school_meal_tanf_categorically_eligible\n    fdpir_eligible = school_meal_fdpir_categorically_eligible\n    # 42 USC 1758(b)(5) - Foster children\n    foster_eligible = school_meal_foster_categorically_eligible\n    # 42 USC 1758(b)(12)(A) - Homeless, runaway, migrant\n    homeless_eligible = school_meal_homeless_categorically_eligible\n    runaway_eligible = school_meal_runaway_categorically_eligible\n    migrant_eligible = school_meal_migrant_categorically_eligible\n    # Section 9(b)(2)(A) - Head Start\n    head_start_eligible = school_meal_head_start_categorically_eligible\n    # Any categorical pathway qualifies\n    return (snap_eligible or tanf_eligible or fdpir_eligible or\n            foster_eligible or homeless_eligible or runaway_eligible or\n            migrant_eligible or head_start_eligible)\n\nvariable school_meal_cep_eligible:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  syntax: python\n  formula: |\n    # Student attends a school participating in Community Eligibility Provision\n    return attends_cep_school\n\nvariable school_meal_directly_certified:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  syntax: python\n  formula: |\n    # Direct certification includes categorical eligibility pathways\n    # that can be verified through data matching (SNAP, TANF, FDPIR, foster, homeless, migrant)\n    # but NOT Head Start (which requires separate documentation)\n    snap = school_meal_snap_categorically_eligible\n    tanf = school_meal_tanf_categorically_eligible\n    fdpir = school_meal_fdpir_categorically_eligible\n    foster = school_meal_foster_categorically_eligible\n    homeless = school_meal_homeless_categorically_eligible\n    migrant = school_meal_migrant_categorically_eligible\n    return snap or tanf or fdpir or foster or homeless or migrant\n\n\n# ---- Merged from free_eligibility.rac ----\n\n# 42 USC 1758(b)(1)(A)(i) - Free School Meal Eligibility\n#\n\ntext: \"\"\"\n(A)(i) except as provided in clause (ii), a child shall be served a\nfree lunch if the household income is at or below 130 percent of the\napplicable family size income level contained in the nonfarm income\npoverty guidelines prescribed by the Office of Management and Budget\n\"\"\"\nvariable free_eligibility:\n  entity: Household\n  period: Year\n  dtype: Rate\n  label: \"School Meal FPG Ratio\"\n  description: \"Ratio of household income to Federal Poverty Guidelines\"\n  syntax: python\n  formula: |\n    # Get household's gross annual income\n    household_income = household.gross_income\n    # Get Federal Poverty Level for household size\n    household_size = household.size\n    fpl = federal_poverty_level(household_size)\n    # Calculate income ratio to FPL\n    income_ratio = household_income / fpl\n    # Free meal eligibility: at or below 130% FPL\n    return income_ratio <= free_meal_limit_pct_fpl\n  default: False\n\n\n# ---- Merged from reduced_eligibility.rac ----\n\n# 42 USC 1758(b)(1)(A)(ii) - Reduced-Price School Meal Eligibility\n#\n\ntext: \"\"\"\n(ii) a child shall be served a reduced price lunch or breakfast,\nas the case may be, if the household income is above 130 percent\nbut at or below 185 percent of the applicable family size income\nlevel contained in the nonfarm income poverty guidelines\n\"\"\"\nvariable reduced_eligibility:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"School Meal Eligible Subsidized\"\n  description: \"Whether eligible for any subsidized meals (free OR reduced-price)\"\n  syntax: python\n  formula: |\n    # Get household's gross annual income\n    household_income = household.gross_income\n    # Get Federal Poverty Level for household size\n    household_size = household.size\n    fpl = federal_poverty_level(household_size)\n    # Calculate income ratio to FPL\n    income_ratio = household_income / fpl\n    # Reduced-price eligibility: above 130% but at or below 185% FPL\n    above_free_threshold = income_ratio > free_meal_limit_pct_fpl\n    at_or_below_reduced_threshold = income_ratio <= reduced_price_limit_pct_fpl\n    return above_free_threshold and at_or_below_reduced_threshold\n  default: False\n\n\n# ---- Merged from subsidy.rac ----\n\n# 42 USC 1751 et seq. - School Meal Subsidy Calculation\n#\nvariable subsidy:\n  entity: Household\n  period: Year\n  dtype: Money\n  label: \"Reduced Price School Meals\"\n  description: \"Annual value of REDUCED-PRICE school meals for household\"\n  syntax: python\n  formula: |\n    # Get state group and tier for rate lookup\n    state = household.state\n    tier = household.school_meal_tier\n    is_ak = state == \"AK\"\n    is_hi = state == \"HI\"\n    is_free = tier == FREE\n    is_reduced = tier == REDUCED\n    # Flattened lookup: state x tier combinations\n    if is_ak and is_free:\n        return nslp.alaska.free + sbp.alaska.free\n    elif is_ak and is_reduced:\n        return nslp.alaska.reduced + sbp.alaska.reduced\n    elif is_ak:\n        return nslp.alaska.paid + sbp.alaska.paid\n    elif is_hi and is_free:\n        return nslp.hawaii.free + sbp.hawaii.free\n    elif is_hi and is_reduced:\n        return nslp.hawaii.reduced + sbp.hawaii.reduced\n    elif is_hi:\n        return nslp.hawaii.paid + sbp.hawaii.paid\n    elif is_free:\n        return nslp.contiguous_us.free + sbp.contiguous_us.free\n    elif is_reduced:\n        return nslp.contiguous_us.reduced + sbp.contiguous_us.reduced\n    else:\n        return nslp.contiguous_us.paid + sbp.contiguous_us.paid\n  default: 0\n\n\n# ---- Merged from tier.rac ----\n\n# 42 USC 1758(b)(1) - School Meal Tier Determination\n#\nvariable tier:\n  entity: Person\n  period: Year\n  dtype: Boolean\n  label: \"School Meal Tier Is Subsidized\"\n  description: \"Boolean helper: is this person in a subsidized tier (free or reduced)?\"\n  syntax: python\n  formula: |\n    # Get household income ratio to FPL\n    household_income = household.gross_income\n    household_size = household.size\n    fpl = federal_poverty_level(household_size)\n    income_ratio = household_income / fpl\n    # Check categorical and CEP eligibility (provides free meals)\n    categorical = categorically_eligible\n    cep_school = attends_cep_school\n    # Tier determination with precedence\n    # 1. Categorical/CEP -> FREE\n    if categorical or cep_school:\n        return FREE\n    # 2. Income <= 130% FPL -> FREE\n    if income_ratio <= free_meal_limit_pct_fpl:\n        return FREE\n    # 3. 130% < Income <= 185% FPL -> REDUCED\n    if income_ratio <= reduced_price_limit_pct_fpl:\n        return REDUCED\n    # 4. Income > 185% FPL -> PAID\n    return PAID\n  default: False",
      "path": "cosilico-us/statute/42/1758/b.rac"
    },
    {
      "citation": "42 USC 1786(d)",
      "title": "Eligibility for WIC Program",
      "text": "Persons eligible. - Subject to the availability of funds appropriated for\nthe fiscal year involved and subject to income eligibility standards\nestablished by State agencies under paragraph (2)(A) for local agencies\nor clinics to use in determining eligibility...\n(1) participate in the program only pregnant women, breastfeeding women,\npostpartum women, infants, and children who--\n(A) are income eligible under clause (i) or (ii) of paragraph (2)(A); and\n(B) are determined to be at nutritional risk by a competent professional\nauthority...\n(3) A State agency may not deny services under this section to an otherwise\neligible applicant solely on the basis of the applicant's failure to meet\na residency requirement...",
      "code": "variable eligibility:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  syntax: python\n  formula: |\n    # 42 USC 1786(d)(3) prohibits durational residency requirements\n    # Person must only be physically present in the state where applying\n    # This is typically captured by is_us_resident at federal level\n    if is_us_resident:\n        return True\n    return False",
      "path": "cosilico-us/statute/42/1786/d.rac"
    },
    {
      "citation": "42 USC 1786(d)(1)",
      "title": "Categorical Eligibility for WIC",
      "text": "(1) participate in the program only pregnant women, breastfeeding women,\npostpartum women, infants, and children who--\n(A) are income eligible under clause (i) or (ii) of paragraph (2)(A); and\n(B) are determined to be at nutritional risk...\n(3) \"breastfeeding women\" - up to 1 year postpartum if breastfeeding\n(4) \"child\" - persons 1 through 4 years of age (up to 5th birthday)\n(6) \"infant\" - persons under 1 year of age\n(14) \"postpartum women\" - up to 6 months after pregnancy terminates",
      "code": "variable categorical:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  syntax: python\n  formula: |\n    # 42 USC 1786(b)(3): Breastfeeding women - up to 1 year postpartum\n    # Takes priority over postpartum since it has longer eligibility period\n    if is_breastfeeding and months_postpartum < postpartum_max_months_breastfeeding:\n        return \"breastfeeding_woman\"\n    # 42 USC 1786(d)(1): Pregnant women\n    if is_pregnant:\n        return \"pregnant_woman\"\n    # 42 USC 1786(b)(14): Postpartum women - up to 6 months after pregnancy ends\n    if is_postpartum and months_postpartum < postpartum_max_months_non_breastfeeding:\n        return \"postpartum_woman\"\n    # 42 USC 1786(b)(6): Infants - under 1 year of age\n    if age < infant_max_years:\n        return \"infant\"\n    # 42 USC 1786(b)(4): Children - 1 through 4 years (up to 5th birthday)\n    if age >= infant_max_years and age < child_max_years:\n        return \"child\"\n    # No WIC category applies\n    return \"none\"",
      "path": "cosilico-us/statute/42/1786/d/1.rac"
    },
    {
      "citation": "42 USC 1786(d)(2)",
      "title": "Income Eligibility for WIC",
      "text": "(2)(A) State agencies shall establish income eligibility standards to be\nused in conjunction with the nutrition risk criteria in determining\neligibility of individuals for participation in the program.\n(B) Income eligibility standards established by a State agency under\nsubparagraph (A)... shall be set at or below 185 percent of the poverty\nincome guidelines prescribed by the Office of Management and Budget...\n(C) A member of a family shall be considered income eligible if the\nfamily member... participates in... [SNAP, Medicaid, or TANF]",
      "code": "variable income:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  syntax: python\n  formula: |\n    # FPL based on household size\n    if household_size <= max_table_size:\n        return fpl_monthly.by_household_size[household_size]\n    # For sizes > max_table_size, add per-person amount\n    base = fpl_monthly.by_household_size[max_table_size]\n    additional = fpl_monthly.additional_per_person\n    extra_members = household_size - max_table_size\n    return base + (additional * extra_members)",
      "path": "cosilico-us/statute/42/1786/d/2.rac"
    },
    {
      "citation": "42 USC 1786(d)(2)(C)",
      "title": "Adjunctive Income Eligibility for WIC",
      "text": "(C) A member of a family shall be considered income eligible if the\nfamily member or a parent or caretaker of the participant participates\nin the--\n(i) supplemental nutrition assistance program established under the\nFood and Nutrition Act of 2008 (7 U.S.C. 2011 et seq.);\n(ii) a State program funded under the program of block grants to\nStates for temporary assistance for needy families established\nunder part A of title IV of the Social Security Act; or\n(iii) the program of medical assistance under title XIX of the\nSocial Security Act.\nThis is known as \"adjunctive eligibility\" - participation in SNAP,",
      "code": "variable adjunctive:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  syntax: python\n  formula: |\n    # Person or household receives SNAP benefits\n    if receives_snap:\n        return True\n    if household.receives_snap:\n        return True\n    return False",
      "path": "cosilico-us/statute/42/1786/d/3.rac"
    },
    {
      "citation": "42 USC 1786(f)",
      "title": "WIC Food Packages",
      "text": "The Secretary shall prescribe by regulation... the supplemental foods to\nbe made available in the program under this section.",
      "code": "variable food_package:\n  entity: Household\n  period: Month\n  dtype: Integer\n  syntax: python\n  formula: |\n    # Must be WIC eligible to receive a food package\n    if not is_wic_eligible:\n        return \"none\"\n    category = wic_category\n    # 7 CFR 246.10(c)(1): Food Package III - Children ages 1-4\n    if category == \"child\":\n        return \"III\"\n    # 7 CFR 246.10(c)(4): Food Package IV - Pregnant women\n    if category == \"pregnant_woman\":\n        return \"IV\"\n    # Breastfeeding and postpartum women have multiple package options\n    # based on breastfeeding intensity and duration\n    # 7 CFR 246.10(c)(7): Food Package VII - Fully breastfeeding women\n    if category == \"breastfeeding_woman\" and is_fully_breastfeeding:\n        return \"VII\"\n    elif category == \"breastfeeding_woman\":\n        # Partially breastfeeding - Food Package IV\n        return \"IV\"\n    elif category == \"postpartum_woman\" and is_breastfeeding and is_fully_breastfeeding:\n        # 7 CFR 246.10(c)(6): Food Package VI - Fully breastfeeding postpartum\n        return \"VI\"\n    elif category == \"postpartum_woman\" and is_breastfeeding:\n        # Partially breastfeeding postpartum\n        return \"IV\"\n    elif category == \"postpartum_woman\":\n        # 7 CFR 246.10(c)(5): Food Package V - Non-breastfeeding postpartum\n        return \"V\"\n    elif category == \"infant\" and is_fully_breastfed:\n        # 7 CFR 246.10(c)(1): Package I - Fully breastfed infants\n        return \"I\"\n    elif category == \"infant\":\n        # 7 CFR 246.10(c)(2): Package II - Formula-fed or partially breastfed\n        return \"II\"\n    else:\n        return \"none\"\n  default: \"none\"\n\n\nparameter priority_by_category:\n  values:\n    # TODO: add values\n\nparameter priority_ranges:\n  values:\n    # TODO: add values\n\nvariable priority:\n  imports:\n\nvariable wic_priority_level:\n  entity: Person\n  period: Month\n  dtype: Integer\n  syntax: python\n  formula: |\n    if not is_wic_eligible:\n        return 0\n    category = wic_category\n    # Priority assignment based on category\n    # Using parameters lookup for priority values\n    if category == \"pregnant_woman\":\n        return priority_by_category.pregnant_woman\n    if category == \"breastfeeding_woman\":\n        return priority_by_category.breastfeeding_woman\n    if category == \"infant\":\n        return priority_by_category.infant\n    if category == \"child\":\n        return priority_by_category.child\n    if category == \"postpartum_woman\":\n        return priority_by_category.postpartum_woman\n    return 0\n\nvariable wic_priority_description:\n  entity: Person\n  period: Month\n  dtype: String\n  syntax: python\n  formula: |\n    priority = wic_priority_level\n    if priority == 1:\n        return \"Priority I - High-risk pregnant/breastfeeding women and infants\"\n    if priority == priority_ranges.standard_min - 1:\n        return \"Priority II - Infants of WIC/Medicaid mothers\"\n    if priority == priority_ranges.high_max:\n        return \"Priority III - High-risk children\"\n    if priority == priority_ranges.standard_min:\n        return \"Priority IV - Pregnant/breastfeeding women and infants\"\n    if priority == priority_ranges.standard_max:\n        return \"Priority V - Children at dietary risk\"\n    if priority == priority_ranges.lower_min:\n        return \"Priority VI - Postpartum non-breastfeeding women\"\n    if priority == priority_ranges.lower_max:\n        return \"Priority VII - Homeless/migrant certification\"\n    return \"Not eligible for WIC\"\n\nvariable is_wic_high_priority:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  syntax: python\n  formula: |\n    priority = wic_priority_level\n    return priority >= 1 and priority <= priority_ranges.high_max\n\nvariable is_wic_standard_priority:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  syntax: python\n  formula: |\n    priority = wic_priority_level\n    return priority >= priority_ranges.standard_min and priority <= priority_ranges.standard_max\n\nvariable is_wic_lower_priority:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  syntax: python\n  formula: |\n    priority = wic_priority_level\n    return priority >= priority_ranges.lower_min and priority <= priority_ranges.lower_max",
      "path": "cosilico-us/statute/42/1786/f.rac"
    },
    {
      "citation": "42 USC 607",
      "title": "TANF Work Participation Requirements",
      "text": "(a) Participation rate requirements\n(1) All families\nA State to which a grant is made under section 603 of this title\nfor a fiscal year shall achieve the minimum participation rate...",
      "code": "variable tanf_required_work_hours_weekly:\n  entity: Person\n  period: Week\n  dtype: Integer\n  unit: \"hours\"\n  label: \"TANF Required Weekly Work Hours\"\n  description: \"Weekly work hours required for TANF participation based on family composition\"\n  syntax: python\n  formula: |\n    # Not all TANF recipients have work requirements\n    if tanf_work_requirement_exempt:\n        return 0\n    young_child_age = parameter(gov.hhs.acf.tanf.work.young_child_age_threshold)\n    # 607(c)(1)(A): Single parent or caretaker with child under 6\n    if is_tanf_single_parent and has_child_under_age(young_child_age):\n        return parameter(gov.hhs.acf.tanf.work.hours_single_parent_young_child)\n    # 607(c)(1)(B): General single parent requirement\n    if is_tanf_single_parent:\n        return parameter(gov.hhs.acf.tanf.work.hours_single_parent)\n    # 607(c)(2): Two-parent families\n    if is_tanf_two_parent_family:\n        # 607(c)(2)(B): Higher requirement if receiving federal child care\n        if receives_federal_childcare_assistance:\n            return parameter(gov.hhs.acf.tanf.work.hours_two_parent_with_childcare)\n        elif not receives_federal_childcare_assistance:\n            return parameter(gov.hhs.acf.tanf.work.hours_two_parent)\n    return 0\n  default: 0\n\nvariable tanf_required_work_hours_monthly:\n  entity: Person\n  period: Month\n  dtype: Integer\n  unit: \"hours\"\n  label: \"TANF Required Monthly Work Hours\"\n  description: \"Monthly work hours required (weekly hours * weeks_per_month)\"\n  syntax: python\n  formula: |\n    # Approximate monthly hours from weekly (52 weeks / 12 months)\n    return round(tanf_required_work_hours_weekly * weeks_per_month)  # weeks_per_month ~= 4.33\n  default: 0\n\nvariable tanf_hours_in_core_activities:\n  entity: Person\n  period: Week\n  dtype: Integer\n  unit: \"hours\"\n  label: \"TANF Core Work Activity Hours\"\n  description: \"Hours in core work activities (unsubsidized employment, on-the-job training, etc.)\"\n  syntax: python\n  formula: |\n    # Core activities per 607(d):\n    # (1) Unsubsidized employment\n    # (2) Subsidized private sector employment\n    # (3) Subsidized public sector employment\n    # (4) Work experience\n    # (5) On-the-job training\n    # (6) Job search and job readiness (limited)\n    # (7) Community service programs\n    # (8) Vocational educational training (12-month limit)\n    total = work_hours_unsubsidized + work_hours_subsidized_private\n    total = total + work_hours_subsidized_public + work_hours_work_experience\n    total = total + work_hours_on_the_job_training + work_hours_job_search_limited\n    total = total + work_hours_community_service + work_hours_vocational\n    return total\n  default: 0\n\nvariable tanf_work_requirement_met:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"TANF Work Requirement Met\"\n  description: \"Whether individual meets TANF work participation requirement\"\n  syntax: python\n  formula: |\n    # Exempt individuals automatically meet requirement\n    if tanf_work_requirement_exempt:\n        return True\n    required_hours = tanf_required_work_hours_monthly\n    actual_hours = work_hours_monthly\n    return actual_hours >= required_hours\n  default: true\n\nvariable tanf_work_requirement_exempt:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"TANF Work Requirement Exempt\"\n  description: \"Whether individual is exempt from TANF work requirements\"\n  syntax: python\n  formula: |\n    # 607(c)(2)(B): Caring for child under 6 with unavailable child care\n    # (This is an exemption from full hours, not from work entirely in most states)\n    # States define most exemptions; common federal-recognized exemptions:\n    # - Disabled (unable to work)\n    # - Caring for disabled family member\n    # - Pregnant (third trimester)\n    # - Single parent with infant (varies by state, up to 12 months)\n    # 607(b)(5): Single parent caring for child under 1\n    # State may disregard from participation rate for up to 12 months lifetime\n    if has_child_under_1 and is_single_parent:\n        return tanf_infant_care_exemption_available\n    if is_disabled_unable_to_work:\n        return True\n    if is_caring_for_disabled_family_member:\n        return True\n    if is_pregnant and pregnancy_trimester == 3:\n        return True\n    return False\n  default: false\n\nvariable tanf_teen_parent_education_required:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"TANF Teen Parent Education Required\"\n  description: \"Whether teen parent must attend school or education program\"\n  syntax: python\n  formula: |\n    max_age = parameter(gov.hhs.acf.tanf.age.teen_parent_max_age)\n    # Minor parent without diploma/GED must attend school\n    if age < max_age and has_minor_child and not has_high_school_diploma:\n        return True\n    return False\n  default: false\n\nvariable tanf_teen_parent_education_met:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"TANF Teen Parent Education Requirement Met\"\n  description: \"Whether teen parent meets education/training requirement\"\n  syntax: python\n  formula: |\n    if not tanf_teen_parent_education_required:\n        return True\n    # Must be enrolled in school, GED, or alternative education\n    if is_enrolled_in_school:\n        return True\n    if is_enrolled_in_ged_program:\n        return True\n    if is_enrolled_in_alternative_education:\n        return True\n    return False\n  default: true\n\nvariable tanf_unit_work_requirement_met:\n  entity: TanfUnit\n  period: Month\n  dtype: Boolean\n  label: \"TANF Unit Work Requirement Met\"\n  description: \"Whether all non-exempt adults in TANF unit meet work requirements\"\n  syntax: python\n  formula: |\n    # All non-exempt adults must meet requirements\n    # At least one adult must meet if two-parent family\n    for adult in tanf_unit_adults:\n        if not (tanf_work_requirement_met or tanf_work_requirement_exempt):\n            return False\n    return True\n  default: true",
      "path": "cosilico-us/statute/42/607.rac"
    },
    {
      "citation": "42 USC 607(a)",
      "title": "Work Participation Requirements",
      "text": "(a) Participation rate requirements\n(1) All families\nA State to which a grant is made under section 603 of this title\nfor a fiscal year shall achieve the minimum participation rate\nspecified in the following table for the fiscal year with respect\nto all families receiving assistance under the State program...",
      "code": "variable work_requirements:\n  entity: Family\n  period: Month\n  dtype: Boolean\n  syntax: python\n  formula: |\n    # 607(c)(1)(A): Single parent or head of household with child under threshold age\n    has_young_child = any(children, child.age < child_under_age_threshold)\n    if tanf_head_of_household and has_young_child:\n        return work_activities_hours_reduced  # 20 hours/week\n    # 607(c)(1)(B): General requirement - single parent families\n    if tanf_head_of_household:\n        return work_activities_hours_single_parent  # 30 hours/week\n    # 607(c)(2): Two-parent families\n    if tanf_two_parent_family:\n        return work_activities_hours_two_parent  # 35 hours/week (55 if child care)\n    return 0",
      "path": "cosilico-us/statute/42/607/a.rac"
    },
    {
      "citation": "42 USC 608",
      "title": "TANF Sanctions",
      "text": "",
      "code": "variable tanf_work_sanction_applicable:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"TANF Work Sanction Applicable\"\n  description: \"Whether work requirement sanction applies to individual\"\n  syntax: python\n  formula: |\n    # Sanction applies if:\n    # - Required to participate in work activities\n    # - Failed to participate without good cause\n    # - Has been notified and given opportunity to cure\n    # NOTE: Cannot fully model - requires tracking compliance history\n    # This provides the indicator for when sanction would apply\n    if tanf_work_requirement_exempt:\n        return False\n    if tanf_work_requirement_met:\n        return False\n    # Sanction applies if not meeting requirement and no good cause\n    return not tanf_work_good_cause\n  default: false\n\nvariable tanf_work_sanction_amount:\n  entity: TanfUnit\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"TANF Work Sanction Reduction\"\n  description: \"Monthly benefit reduction due to work requirement non-compliance\"\n  syntax: python\n  formula: |\n    # States choose sanction approach:\n    # 1. Pro-rata: Reduce by non-compliant adult's portion of benefit\n    # 2. Full-family: Terminate entire family benefit\n    # 3. Progressive: Escalate with repeated non-compliance\n    # Count sanctioned adults\n    sanctioned_adults = count(tanf_work_sanction_applicable for adult in tanf_unit_adults)\n    if sanctioned_adults == 0:\n        return 0\n    # Default to pro-rata sanction (adult portion of benefit)\n    # State parameters override this calculation\n    total_adults = count(tanf_unit_adults)\n    adult_share = tanf_benefit_amount * (sanctioned_adults / tanf_unit_size)\n    return adult_share\n  default: 0\n\nvariable tanf_full_family_sanction_applies:\n  entity: TanfUnit\n  period: Month\n  dtype: Boolean\n  label: \"TANF Full-Family Sanction\"\n  description: \"Whether full-family sanction terminates entire benefit\"\n  syntax: python\n  formula: |\n    # State-specific: Some states terminate entire benefit\n    # for work non-compliance\n    # NOTE: State parameter determines this policy\n    # tanf_full_family_sanction_state = state parameter (boolean)\n    if not any(tanf_work_sanction_applicable for adult in tanf_unit_adults):\n        return False\n    return tanf_uses_full_family_work_sanction  # State parameter\n  default: false\n\nvariable tanf_child_support_cooperation_met:\n  entity: TanfUnit\n  period: Month\n  dtype: Boolean\n  label: \"TANF Child Support Cooperation Met\"\n  description: \"Whether unit cooperates with child support enforcement\"\n  syntax: python\n  formula: |\n    # Cooperation required unless good cause exemption\n    # Good cause includes:\n    # - Domestic violence\n    # - Best interests of child would be harmed\n    # - Conception from rape/incest\n    if tanf_child_support_good_cause_exemption:\n        return True\n    # Otherwise must cooperate with:\n    # - Establishing paternity\n    # - Establishing/modifying support orders\n    # - Enforcing support orders\n    return cooperating_with_child_support_enforcement\n  default: true\n\nvariable tanf_child_support_sanction_amount:\n  entity: TanfUnit\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"TANF Child Support Sanction\"\n  description: \"Benefit reduction for child support non-cooperation\"\n  syntax: python\n  formula: |\n    if tanf_child_support_cooperation_met:\n        return 0\n    min_sanction_rate = parameter(gov.hhs.acf.tanf.sanctions.child_support_noncompliance_rate)\n    # Federal minimum: At least 25% reduction\n    # States may impose higher, including full termination\n    return tanf_benefit_amount * min_sanction_rate\n  default: 0\n\nvariable tanf_irp_required:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"TANF Individual Responsibility Plan Required\"\n  description: \"Whether Individual Responsibility Plan is required\"\n  syntax: python\n  formula: |\n    # States may require IRP as condition of benefits\n    # IRP outlines responsibilities and goals\n    # Typically required for non-exempt adults\n    if is_tanf_recipient and not tanf_work_requirement_exempt:\n        return True\n    return False\n  default: false\n\nvariable tanf_irp_compliance:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"TANF IRP Compliance\"\n  description: \"Whether individual complies with Individual Responsibility Plan\"\n  syntax: python\n  formula: |\n    if not tanf_irp_required:\n        return True\n    # Cannot fully model - requires tracking IRP terms and activities\n    # This is an input variable in practice\n    return tanf_irp_terms_met\n  default: true\n\nvariable tanf_sanction_level:\n  entity: Person\n  period: Month\n  dtype: Integer\n  label: \"TANF Sanction Level\"\n  description: \"Current sanction level for progressive sanctions (0-3 typical)\"\n  syntax: python\n  formula: |\n    # Progressive sanctions typically:\n    # Level 0: No sanction\n    # Level 1: 25% reduction, 1 month minimum\n    # Level 2: 50% reduction, 2 months minimum\n    # Level 3: Full benefit, 3 months minimum or until compliance\n    # NOTE: Cannot model - requires tracking sanction history\n    # This would be input data in practice\n    return tanf_sanction_level_input  # Input variable\n  default: 0\n\nvariable tanf_total_sanction_amount:\n  entity: TanfUnit\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"TANF Total Sanctions\"\n  description: \"Combined benefit reduction from all applicable sanctions\"\n  syntax: python\n  formula: |\n    work_sanction = tanf_work_sanction_amount\n    child_support_sanction = tanf_child_support_sanction_amount\n    # Full-family sanction supersedes other sanctions\n    if tanf_full_family_sanction_applies:\n        return tanf_benefit_amount_before_sanctions\n    # Otherwise combine sanctions (capped at benefit amount)\n    total = work_sanction + child_support_sanction\n    return min(total, tanf_benefit_amount_before_sanctions)\n  default: 0\n\nvariable tanf_benefit_after_sanctions:\n  entity: TanfUnit\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"TANF Benefit After Sanctions\"\n  description: \"TANF benefit amount after applying all sanctions\"\n  syntax: python\n  formula: |\n    benefit = tanf_benefit_amount_before_sanctions\n    sanctions = tanf_total_sanction_amount\n    return max(0, benefit - sanctions)\n  default: 0\n\nvariable tanf_work_good_cause:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"TANF Work Good Cause\"\n  description: \"Whether good cause exists for work requirement non-compliance\"\n  syntax: python\n  formula: |\n    # Federal regulations recognize good cause including:\n    # - Child care unavailable (child under 6)\n    # - Domestic violence\n    # - Illness/incapacity (temporary)\n    # - Transportation unavailable\n    # - Other state-defined reasons\n    if child_care_unavailable_good_cause:\n        return True\n    if domestic_violence_waiver:\n        return True\n    if temporary_illness:\n        return True\n    if transportation_unavailable:\n        return True\n    return False\n  default: false\n\nvariable tanf_child_support_good_cause_exemption:\n  entity: TanfUnit\n  period: Month\n  dtype: Boolean\n  label: \"TANF Child Support Good Cause\"\n  description: \"Whether good cause exemption applies for child support cooperation\"\n  syntax: python\n  formula: |\n    # Good cause includes:\n    # - Risk of domestic violence\n    # - Pursuit not in best interest of child\n    # - Child conceived through rape or incest\n    if domestic_violence_risk:\n        return True\n    if child_support_not_in_child_interest:\n        return True\n    if conception_from_assault:\n        return True\n    return False\n  default: false",
      "path": "cosilico-us/statute/42/608.rac"
    },
    {
      "citation": "42 USC 608",
      "title": "TANF Benefit Calculation",
      "text": "",
      "code": "variable benefit_calculation:\n  entity: TanfUnit\n  period: Month\n  dtype: Money\n  syntax: python\n  formula: |\n    return tanf_gross_earned_income + tanf_gross_unearned_income",
      "path": "cosilico-us/statute/42/608/b.rac"
    },
    {
      "citation": "42 USC 608(a)",
      "title": "Prohibitions and Requirements for Eligibility",
      "text": "- 608(a)(1): Definition of \"needy family\" (state-defined)",
      "code": "variable eligibility:\n  imports:\n    - 7/2014/a#snap_eligibility\n  entity: TanfUnit\n  period: Month\n  dtype: Boolean\n  syntax: python\n  formula: |\n    # States set their own need standards\n    # Typical components (state parameters override these):\n    # 1. Gross income test\n    # 2. Net income test (after disregards)\n    # 3. Resource/asset test\n    gross_income_eligible = tanf_gross_income <= tanf_gross_income_limit\n    net_income_eligible = tanf_countable_income <= tanf_need_standard\n    resource_eligible = tanf_countable_resources <= tanf_resource_limit\n    return gross_income_eligible and net_income_eligible and resource_eligible",
      "path": "cosilico-us/statute/42/608/a.rac"
    },
    {
      "citation": "42 USC 608(a)(7)",
      "title": "Time Limits on Federal Assistance",
      "text": "(7) No assistance for more than 5 years\n(A) In general\nA State to which a grant is made under section 603 shall not use\nany part of the grant to provide assistance to a family that\nincludes an adult who has received assistance under any State\nprogram funded under this part attributable to funds provided by\nthe Federal Government... for 60 months (whether or not consecutive)\nafter the date the State program... becomes effective",
      "code": "variable time_limits:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  formula: return federal_time_limit_months  # 60 months",
      "path": "cosilico-us/statute/42/607/b.rac"
    },
    {
      "citation": "42 USC 8624(b)(2)",
      "title": "LIHEAP Eligibility",
      "text": "(2) Except as provided in paragraph (11), the State will make\npayments only with respect to—\n(A) households in which 1 or more individuals are receiving—\n(i) assistance under the State program funded under part A of\ntitle IV of the Social Security Act [TANF];\n(ii) supplemental security income payments under title XVI of\nthe Social Security Act [SSI];\n(iii) food stamps [SNAP] under the Food and Nutrition Act of 2008;\n(iv) payments under section 415, 521, 541, or 542 of title 38\n[veterans benefits]; or\n(B) households with incomes which do not exceed the greater of—\n(i) 150 percent of the poverty level for such State; or\n(ii) 60 percent of the State median income",
      "code": "variable eligibility:\n  entity: Household\n  period: Year\n  dtype: Boolean\n  unit: \"USD\"\n  label: \"LIHEAP eligibility\"\n  description: \"Overall LIHEAP eligibility per 42 USC 8624(b)(2)\"\n  syntax: python\n  formula: |\n    base_fpl = fpl_by_household_size[1]\n    additional_per_person = fpl_by_household_size[\"additional_per_person\"]\n    extra_members = max(0, household_size - 1)\n    fpl = base_fpl + (additional_per_person * extra_members)\n    return fpl * fpl_percentage\n  default: False\n\n\n\n# ---- Merged from liheap.rac ----\n\n# 42 USC 8624 - Low Income Home Energy Assistance Program (LIHEAP)\n#\nvariable liheap:\n  imports:",
      "path": "cosilico-us/statute/42/8624/b.rac"
    },
    {
      "citation": "42 USC 8624(b)(5)",
      "title": "LIHEAP Benefit Calculation",
      "text": "(5) the State will...provide, in a timely manner, that the highest level\nof assistance will be furnished to those households which have the lowest\nincomes and the highest energy costs or needs in relation to income,\ntaking into account family size, except that the State may not differentiate\nin implementing this section between the households described in clauses\n(2)(A) and (2)(B) of this subsection...\n(A) ensure that the highest level of assistance will be provided to—\n(i) households with the lowest incomes that pay a high proportion\nof household income for home energy, taking into account\nhousehold size;\n(ii) households containing the elderly;\n(iii) households with disabled individuals; and\n(iv) households with young children",
      "code": "variable benefit_calculation:\n  entity: Household\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"LIHEAP cooling assistance\"\n  description: \"Home cooling assistance per 42 USC 8624(b)(1)(B)\"\n  syntax: python\n  formula: |\n    # Energy burden = energy costs / income\n    # Handle zero income case\n    if annual_gross_income <= 0:\n        # If no income but has energy costs, burden is effectively infinite\n        # Cap at 1.0 (100%) for calculation purposes\n        return 1.0\n    return min(1.0, annual_energy_costs / annual_gross_income)\n  default: 0",
      "path": "cosilico-us/statute/42/8624/c.rac"
    },
    {
      "citation": "42 USC 9858c(c)(4)",
      "title": "--- Merged from benefit.rac ----",
      "text": "",
      "code": "variable benefit:\n  entity: SPMUnit\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"CCDF Benefit\"\n  description: \"Total annual CCDF child care benefit per 42 USC 9858\"\n  syntax: python\n  formula: |\n    age = this.age\n    is_home_based = this.is_ccdf_home_based\n    age_months = age * months_per_year\n    # Age thresholds vary by provider type\n    # Home-based care typically has different age group cutoffs\n    # Infant: under infant_max_months (center) or (home)\n    if (age_months < infant_max_months_center and not is_home_based) or (age_months < infant_max_months_home and is_home_based):\n        return CCDFAgeGroup.INFANT\n    # Toddler: under toddler_max_months\n    if (age_months < toddler_max_months_center and not is_home_based) or (age_months < toddler_max_months_home and is_home_based):\n        return CCDFAgeGroup.TODDLER\n    # Preschooler: under preschool_max_years\n    if age < preschool_max_years:\n        return CCDFAgeGroup.PRESCHOOLER\n    # School-age: preschool_max_years and above\n    return CCDFAgeGroup.SCHOOL_AGE\n  default: 0\n\n\n# ---- Merged from copayment.rac ----\n\n# 42 USC 9858c(c)(4)(A) - CCDF Copayment (Sliding Fee Scale)\n#\n\nparameter smi_threshold_1:\n  description: \"First SMI bracket threshold\"\n  unit: rate\n  values:\n    2015-01-01: 0.5\n\nparameter smi_threshold_2:\n  description: \"Second SMI bracket threshold\"\n  unit: rate\n  values:\n    2015-01-01: 0.65\n\nparameter smi_threshold_3:\n  description: \"Third SMI bracket threshold\"\n  unit: rate\n  values:\n    2015-01-01: 0.75\n\nparameter smi_threshold_4:\n  description: \"Fourth SMI bracket threshold\"\n  unit: rate\n  values:\n    2015-01-01: 0.85\n\nparameter copay_rate_1:\n  description: \"Copay rate for income at or below first SMI threshold\"\n  unit: rate\n  values:\n    2015-01-01: 0.05\n\nparameter copay_rate_2:\n  description: \"Copay rate for income between first and second SMI threshold\"\n  unit: rate\n  values:\n    2015-01-01: 0.1\n\nparameter copay_rate_3:\n  description: \"Copay rate for income between second and third SMI threshold\"\n  unit: rate\n  values:\n    2015-01-01: 0.15\n\nparameter copay_rate_4:\n  description: \"Copay rate for income between third and fourth SMI threshold\"\n  unit: rate\n  values:\n    2015-01-01: 0.2\n\nparameter copay_rate_5:\n  description: \"Copay rate for income above fourth SMI threshold\"\n  unit: rate\n  values:\n    2015-01-01: 0.25\n\nvariable copayment:\n  imports:\n  entity: SPMUnit\n  period: Year\n  dtype: Boolean\n  unit: \"USD\"\n  label: \"CCDF Copay Exceeds 7% Affordability Standard\"\n  description: \"Copayment exceeds 7% of income affordability guideline\"\n  syntax: python\n  formula: |\n    # Get family income and poverty level\n    family_income = this.ccdf_income\n    poverty_level = this.spm_unit_fpg\n    # Families at or below poverty level should have copay waived\n    # per 42 USC 9858c(c)(4)(A)(i)\n    if family_income <= poverty_level:\n        return 0\n    # Income in excess of poverty level\n    income_above_fpl = max(family_income - poverty_level, 0)\n    # Federal maximum copay guidance: 7% of family income\n    max_copay_rate = maximum_percent_of_income\n    # Calculate copay as percentage of income above FPL\n    # This is a simplified federal framework\n    # States typically use more complex sliding scales with brackets\n    #\n    # Common state approaches:\n    # - Flat percentage of income above FPL (e.g., 10-35%)\n    # - Bracketed schedules based on income ranges\n    # - Per-child fees based on income level\n    # Using income-based sliding scale (simplified)\n    # Higher income = higher copay percentage\n    income_to_smi = this.ccdf_income_to_smi_ratio\n    # Graduated copay rate based on income level\n    # (States set their own rates; this is illustrative)\n    if income_to_smi <= smi_threshold_1:\n        copay_rate = copay_rate_1   # First threshold or below\n    elif income_to_smi <= smi_threshold_2:\n        copay_rate = copay_rate_2   # Between first and second threshold\n    elif income_to_smi <= smi_threshold_3:\n        copay_rate = copay_rate_3   # Between second and third threshold\n    elif income_to_smi <= smi_threshold_4:\n        copay_rate = copay_rate_4   # Between third and fourth threshold\n    elif income_to_smi > smi_threshold_4:\n        copay_rate = copay_rate_5   # Above fourth threshold\n    # Annual copay based on income above FPL\n    calculated_copay = income_above_fpl * copay_rate\n    # Apply maximum copay cap (7% of total income per federal guidance)\n    max_copay = family_income * max_copay_rate\n    # Ensure minimum fee (e.g., $1/week typical)\n    min_annual_fee = minimum_weekly_fee * weeks_per_year\n    # Copay is minimum of calculated and max, but at least the minimum fee\n    copay_before_floor = min(calculated_copay, max_copay)\n    return max(copay_before_floor, min_annual_fee)\n\n\n# ---- Merged from eligibility.rac ----\n\n# 42 USC 9858 - Child Care and Development Fund (CCDF) Eligibility\n#\nvariable eligibility:\n  imports:\n  entity: SPMUnit\n  period: Year\n  dtype: Integer\n  unit: \"USD\"\n  label: \"Number of CCDF Eligible Children\"\n  description: \"Count of children eligible for CCDF in the assistance unit\"\n  syntax: python\n  formula: |\n    age = this.age\n    # Standard age limit: under 13\n    standard_limit = maximum_age\n    # Extended limit for children with disabilities: under 19\n    disability_limit = maximum_age_with_disability\n    # Check if child has a disability\n    has_disability = this.is_disabled\n    # Age eligible if under standard limit, or under disability limit with disability\n    if has_disability:\n        age_limit = disability_limit\n    elif not has_disability:\n        age_limit = standard_limit\n    return age < age_limit\n\n\n# ---- Merged from index.rac ----\n\n# 42 USC 9858 - Child Care and Development Fund (CCDF)\n#",
      "path": "cosilico-us/statute/42/9858/a.rac"
    },
    {
      "citation": "47 USC 1752(a)(6)(B)",
      "title": "(F) - ACP Combined Categorical Eligibility",
      "text": "(6) ELIGIBLE HOUSEHOLD.—The term 'eligible household' means...\na household in which—\n(A) at least 1 member of the household meets the qualifications in\nsubsection (a) or (b) of section 54.409... [income or categorical]",
      "code": "variable acp_categorically_eligible:\n  imports:\n    - 47/1752/a/6#acp_school_meal_eligible\n    - 47/1752/a/6#acp_pell_grant_eligible\n    - 47/1752/a/6#acp_wic_eligible\n    - 47/1752/a/6#acp_lifeline_categorical_eligible\n    - 47/1752/a/6#acp_tribal_program_eligible\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"ACP Categorically Eligible\"\n  description: \"Eligible through any qualifying program per 47 USC 1752(a)(6)(B)-(F)\"\n  syntax: python\n  formula: |\n    school_meal = acp_school_meal_eligible\n    pell = acp_pell_grant_eligible\n    wic = acp_wic_eligible\n    lifeline = acp_lifeline_categorical_eligible\n    tribal = acp_tribal_program_eligible\n    return school_meal or pell or wic or lifeline or tribal\n  default: false\n\n# 47 USC 1752(a)(6) - Overall ACP Eligibility\n#\n\ntext: \"\"\"\n(6) ELIGIBLE HOUSEHOLD.—The term 'eligible household' means...\na household in which—\n(A) at least 1 member of the household meets the qualifications in\nsubsection (a) or (b) of section 54.409... [income or categorical]\n\"\"\"\nvariable acp_eligible:\n  imports:\n    - 47/1752/a/6#acp_income_eligible\n    - 47/1752/a/6#acp_categorically_eligible\n    - 47/1752/parameters/benefit_amount/standard#acp_standard_benefit\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"ACP Eligible\"\n  description: \"Overall Affordable Connectivity Program eligibility per 47 USC 1752(a)(6)\"\n  syntax: python\n  formula: |\n    # Check if program is active (benefit amount > 0)\n    if acp_standard_benefit <= 0:\n    return false\n    # Eligible if income-based OR categorically eligible\n    return acp_income_eligible or acp_categorically_eligible\n  default: false\n\nvariable acp_fpl_threshold:\n  imports:\n    - 47/1752/parameters/income/fpg_limit#fpg_limit\n    - 7/2014/c/fpl_by_household_size#fpl_by_household_size\n    - 47/1752/parameters/months_per_year#months_per_year\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"ACP FPL Income Limit\"\n  description: \"200% of Federal Poverty Level for household size per 47 USC 1752(a)(6)(A)\"\n  syntax: python\n  formula: |\n    base_fpl = fpl_by_household_size[1]\n    additional_per_person = fpl_by_household_size[\"additional_per_person\"]\n    extra_members = max(0, household_size - 1)\n    annual_fpl = base_fpl + (additional_per_person * extra_members)\n    # Return monthly threshold at 200% FPL\n    return (annual_fpl * fpg_limit) / months_per_year\n  default: 0\n\n\nvariable acp_income_eligible:\n  imports: [47/1752/a/6#acp_fpl_threshold]\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"ACP Income Eligible\"\n  description: \"Household income at or below 200% FPL per 47 USC 1752(a)(6)(A)\"\n  syntax: python\n  formula: |\n    # Use gross income per 47 CFR 54.400(f)\n    return gross_income <= acp_fpl_threshold\n  default: false\n\nvariable acp_lifeline_categorical_eligible:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"ACP Lifeline Categorical Eligibility\"\n  description: \"Eligible through Lifeline qualifying program participation per 47 CFR 54.409(b)\"\n  syntax: python\n  formula: |\n    # Lifeline qualifying programs per 47 CFR 54.409(b)\n    snap = any(members.receives_snap)\n    medicaid = any(members.receives_medicaid)\n    ssi = any(members.receives_ssi)\n    section_8 = any(members.receives_section_8)\n    veterans_pension = any(members.receives_veterans_pension)\n    return snap or medicaid or ssi or section_8 or veterans_pension\n  default: false\n\nvariable acp_on_tribal_land:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"ACP Household on Tribal Land\"\n  description: \"Household located on Tribal land for enhanced benefit per 47 USC 1752(a)(7)\"\n  formula: return is_on_tribal_land\n  default: false\n\n\nvariable acp_pell_grant_eligible:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"ACP Pell Grant Eligibility\"\n  description: \"Eligible through Federal Pell Grant receipt per 47 USC 1752(a)(6)(C)\"\n  syntax: python\n  formula: |\n    # At least one member received Pell Grant in current award year\n    return any(members.receives_pell_grant)\n  default: false\n\n\nvariable acp_school_meal_eligible:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"ACP School Meal Eligibility\"\n  description: \"Eligible through free or reduced price school lunch/breakfast per 47 USC 1752(a)(6)(B)\"\n  syntax: python\n  formula: |\n    # At least one member approved for free or reduced price meals\n    return any(members.receives_free_school_meals) or any(members.receives_reduced_price_school_meals)\n  default: false\n\n\nvariable acp_tribal_program_eligible:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"ACP Tribal Program Eligibility\"\n  description: \"Eligible through tribal-specific programs per 47 CFR 54.409(b)(4)\"\n  syntax: python\n  formula: |\n    fdpir = any(members.receives_fdpir)\n    bia = any(members.receives_bia_general_assistance)\n    tribal_tanf = any(members.receives_tribal_tanf)\n    head_start = any(members.receives_head_start)\n    return fdpir or bia or tribal_tanf or head_start\n  default: false\n\n\nvariable acp_wic_eligible:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"ACP WIC Eligibility\"\n  description: \"Eligible through WIC participation per 47 USC 1752(a)(6)(E)\"\n  syntax: python\n  formula: |\n    # At least one member receives WIC\n    return any(members.receives_wic)\n  default: false",
      "path": "cosilico-us/statute/47/1752/a/6.rac"
    },
    {
      "citation": "47 USC 1752(a)(7)",
      "title": "ACP Annual Benefit Value",
      "text": "...a monthly discount...in an amount equal to such amount charged,\nbut not more than $30, or, if an internet service offering is\nprovided to an eligible household on Tribal land, not more than $75.",
      "code": "variable acp_annual_benefit:\n  imports:\n    - 47/1752/a/7#acp_benefit\n  entity: Household\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"ACP Annual Benefit\"\n  description: \"Annualized ACP benefit for household\"\n  syntax: python\n  formula: |\n    # Sum monthly benefits across the year\n    # Note: ACP benefit ended April 2024\n    return acp_benefit * months_per_year\n  default: 0\n\n# 47 USC 1752(a)(7) - ACP Monthly Benefit Amount\n#\n\ntext: \"\"\"\n...a monthly discount...in an amount equal to such amount charged,\nbut not more than $30, or, if an internet service offering is\nprovided to an eligible household on Tribal land, not more than $75.\n\"\"\"\nvariable acp_benefit:\n  imports:\n    - 47/1752/a/6#acp_eligible\n    - 47/1752/a/7#acp_max_benefit\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"ACP Monthly Benefit\"\n  description: \"Monthly discount equal to amount charged, up to maximum per 47 USC 1752(a)(7)\"\n  syntax: python\n  formula: |\n    # Must be eligible to receive benefit\n    if not acp_eligible:\n    return 0\n    # Benefit is lesser of actual charge or maximum benefit\n    # \"in an amount equal to such amount charged, but not more than...\"\n    max_benefit = acp_max_benefit\n    actual_charge = broadband_monthly_charge\n    return min(actual_charge, max_benefit)\n  default: 0\n\n\nvariable acp_max_benefit:\n  imports:\n    - 47/1752/a/6#acp_on_tribal_land\n    - 47/1752/parameters/benefit_amount/standard#standard_benefit\n    - 47/1752/parameters/benefit_amount/tribal#tribal_benefit\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"ACP Maximum Monthly Benefit\"\n  description: \"Maximum monthly benefit: $75 on Tribal land, $30 otherwise per 47 USC 1752(a)(7)\"\n  syntax: python\n  formula: |\n    if acp_on_tribal_land:\n    return tribal_benefit\n    return standard_benefit\n  default: 0",
      "path": "cosilico-us/statute/47/1752/a/7.rac"
    },
    {
      "citation": "47 USC 1752(a)(8)(A)",
      "title": "ACP Device Copay Validation",
      "text": "...if the charge to such eligible household is more than $10\nbut less than $50 for such connected device...",
      "code": "variable acp_device_copay_valid:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"ACP Device Copay Valid\"\n  description: \"Device copay is more than $10 but less than $50 per 47 USC 1752(a)(8)\"\n  syntax: python\n  formula: |\n    # Copay must be > $10 and < $50\n    copay = connected_device_copay\n    return copay > min_copay and copay < max_copay\n  default: false\n\n\nvariable acp_device_eligible:\n  imports:\n    - 47/1752/a/6#acp_eligible\n    - 47/1752/a/8#acp_device_received\n    - 47/1752/a/8#acp_device_copay_valid\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"ACP Connected Device Eligible\"\n  description: \"Eligible for connected device subsidy per 47 USC 1752(a)(8)\"\n  syntax: python\n  formula: |\n    # Must be ACP eligible\n    if not acp_eligible:\n    return false\n    # Check if program is active\n    if max_reimbursement <= 0:\n    return false\n    # Cannot have already received a device\n    if acp_device_received:\n    return false\n    # Copay must be in valid range\n    if not acp_device_copay_valid:\n    return false\n    return true\n  default: false\n\n\nvariable acp_device_received:\n  entity: Household\n  period: Year\n  dtype: Boolean\n  label: \"ACP Device Already Received\"\n  description: \"Whether household has previously received subsidized connected device\"\n  syntax: python\n  formula: |\n    # Input variable - tracked externally via National Lifeline Database\n    return has_received_acp_device\n  default: false\n\n\nvariable acp_device_subsidy:\n  imports:\n    - 47/1752/a/8#acp_device_eligible\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"ACP Connected Device Subsidy\"\n  description: \"One-time subsidy up to $100 for connected device per 47 USC 1752(a)(8)\"\n  syntax: python\n  formula: |\n    # Must be eligible for device subsidy\n    if not acp_device_eligible:\n    return 0\n    # Subsidy is up to $100\n    return max_reimbursement\n  default: 0",
      "path": "cosilico-us/statute/47/1752/a/8.rac"
    },
    {
      "citation": "47 USC 1752(b)(3)",
      "title": "ACP Already Receiving Benefit",
      "text": "(3) LIMITATION.—An eligible household may receive only 1 affordable\nconnectivity benefit under this section.",
      "code": "variable acp_already_receiving:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"ACP Already Receiving Benefit\"\n  description: \"Household already enrolled in ACP with another provider\"\n  syntax: python\n  formula: |\n    # Input variable tracked via National Lifeline Accountability Database\n    return is_enrolled_in_acp\n  default: false\n\n\nvariable acp_enrollment_eligible:\n  imports:\n    - 47/1752/a/6#acp_eligible\n    - 47/1752/b#acp_already_receiving\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"ACP Enrollment Eligible\"\n  description: \"Eligible to enroll in ACP (meets requirements and not already receiving)\"\n  syntax: python\n  formula: |\n    # Must be eligible for ACP\n    if not acp_eligible:\n    return false\n    # Cannot already be receiving benefit\n    if acp_already_receiving:\n    return false\n    return true\n  default: false\n\n\n# ---- Merged from acp_total_value.rac ----\n\n# 47 USC 1752 - Total ACP Value\n#\nvariable acp_total_value:\n  imports:\n    - 47/1752/a/7#acp_annual_benefit\n    - 47/1752/a/8#acp_device_subsidy\n  entity: Household\n  period: Year\n  dtype: Money\n  unit: \"USD\"\n  label: \"Total ACP Value\"\n  description: \"Total annual value of ACP benefits (broadband + device)\"\n  syntax: python\n  formula: |\n    # Annual broadband benefit\n    broadband_value = acp_annual_benefit\n    # One-time device subsidy (if eligible)\n    device_value = acp_device_subsidy\n    return broadband_value + device_value\n  default: 0",
      "path": "cosilico-us/statute/47/1752/b.rac"
    },
    {
      "citation": "7 USC Section 2014(a)",
      "title": "Eligible Households",
      "text": "(a) Eligible households shall meet the income and other eligibility\nrequirements of this section.",
      "code": "variable snap_categorically_eligible:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"SNAP Categorically Eligible\"\n  description: \"Whether household is categorically eligible through receipt of TANF, SSI, or GA\"\n  syntax: python\n  formula: |\n    # Section 2014(a) + Section 2014(j): SSI and TANF recipients\n    return receives_ssi or receives_tanf or receives_general_assistance\n  default: false\n\nvariable snap_eligible:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"SNAP Eligible\"\n  description: \"Whether household meets all SNAP eligibility requirements\"\n  syntax: python\n  formula: |\n    # Section 2014(a): Categorically eligible households bypass certain tests\n    if snap_categorically_eligible:\n        # Still must pass net income test in most states\n        # (Some states with BBCE waive this too, but federal baseline requires it)\n        return snap_net_income_eligible\n    # Regular eligibility: must pass all three tests\n    return snap_gross_income_eligible and snap_net_income_eligible and snap_resource_eligible\n  default: false",
      "path": "cosilico-us/statute/7/2014/a.rac"
    },
    {
      "citation": "7 USC Section 2014(c)",
      "title": "Income Eligibility Standards",
      "text": "(2) households... shall have... gross income that does not exceed\n130 percent of the poverty line... and net income that does not\nexceed 100 percent of the poverty line\n(2) Elderly and disabled exemption from gross income test",
      "code": "variable snap_fpl_monthly:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Monthly FPL\"\n  description: \"Monthly Federal Poverty Level for household, scaled by size\"\n  syntax: python\n  formula: |\n    # FPL = base for 1 person + additional per person beyond 1\n    base = parameter(\"gov.hhs.fpl.base\")\n    additional = parameter(\"gov.hhs.fpl.additional_per_person\")\n    extra_members = max(0, household_size - 1)\n    return base + (additional * extra_members)\n  default: 0\n\nvariable snap_gross_income_eligible:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"SNAP Gross Income Eligible\"\n  description: \"Whether household passes 130% FPL gross income test (elderly/disabled exempt)\"\n  syntax: python\n  formula: |\n    limit_pct = parameter(\"gov.usda.fns.snap.income.gross_income_limit_pct\")\n    # Section 2014(c)(2): Elderly/disabled exempt from gross income test\n    if has_elderly_disabled:\n        return True\n    gross_limit = snap_fpl_monthly * limit_pct\n    return gross_income <= gross_limit\n  default: false\n\nvariable snap_net_income_eligible:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"SNAP Net Income Eligible\"\n  description: \"Whether household passes 100% FPL net income test after deductions\"\n  syntax: python\n  formula: |\n    limit_pct = parameter(\"gov.usda.fns.snap.income.net_income_limit_pct\")\n    net_limit = snap_fpl_monthly * limit_pct\n    return snap_net_income <= net_limit\n  default: false",
      "path": "cosilico-us/statute/7/2014/c.rac"
    },
    {
      "citation": "7 USC Section 2014(e)",
      "title": "Deductions from Income",
      "text": "",
      "code": "variable snap_standard_deduction:\n  imports: [26/1#cut]\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Standard Deduction\"\n  description: \"Monthly standard deduction based on household size\"\n  syntax: python\n  formula: |\n    # Standard deduction varies by household size: 1-3 same, 4, 5, 6+ maximum\n    # Use cut() to look up amount from schedule by household size\n    return cut(household_size, standard_deduction_schedule)\n  default: 0\n\nvariable snap_earned_income_deduction:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Earned Income Deduction\"\n  description: \"20% of gross earned income deducted before other calculations\"\n  syntax: python\n  formula: |\n    rate = parameter(\"gov.usda.fns.snap.deductions.earned_income_rate\")\n    return earned_income * rate\n  default: 0\n\nvariable snap_pre_shelter_deductions:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Pre-Shelter Deductions\"\n  description: \"Sum of all deductions before excess shelter calculation\"\n  syntax: python\n  formula: |\n    # Sum all deductions that apply before shelter\n    earned_ded = snap_earned_income_deduction\n    std_ded = snap_standard_deduction\n    care_ded = snap_dependent_care_deduction\n    support_ded = snap_child_support_deduction\n    medical_ded = snap_medical_expense_deduction\n    return earned_ded + std_ded + care_ded + support_ded + medical_ded\n  default: 0\n\nvariable snap_adjusted_income:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Adjusted Income\"\n  description: \"Gross income minus pre-shelter deductions, used for shelter calculation\"\n  formula: return max(0, gross_income - snap_pre_shelter_deductions)\n  default: 0\n\nvariable snap_shelter_deduction:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Shelter Deduction\"\n  description: \"Deduction for shelter costs exceeding 50% of adjusted income\"\n  syntax: python\n  formula: |\n    # Section 2014(e)(6)(A): Excess = shelter costs - 50% of adjusted income\n    adjusted = snap_adjusted_income\n    excess = shelter_costs - (adjusted * excess_shelter_rate)\n    if excess <= 0:\n        return 0\n    # Section 2014(e)(6)(C): No cap for elderly/disabled households\n    if has_elderly_disabled:\n        return excess\n    # Section 2014(e)(6)(B): Cap for non-elderly/disabled households\n    cap = parameter(\"gov.usda.fns.snap.deductions.shelter.cap\")\n    return min(excess, cap)\n  default: 0\n\nvariable snap_net_income:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Net Income\"\n  description: \"Monthly income after all SNAP deductions, used for benefit calculation\"\n  syntax: python\n  formula: |\n    adjusted = snap_adjusted_income\n    shelter_ded = snap_shelter_deduction\n    return max(0, adjusted - shelter_ded)\n  default: 0\n\nvariable snap_total_deductions:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Total Deductions\"\n  description: \"Sum of all SNAP income deductions\"\n  formula: return snap_pre_shelter_deductions + snap_shelter_deduction\n  default: 0",
      "path": "cosilico-us/statute/7/2014/e.rac"
    },
    {
      "citation": "7 USC Section 2014(e)(3)",
      "title": "Dependent Care Deduction",
      "text": "(3) payments necessary for the care of a dependent, including child care\npayments for dependents, when necessary for a household member to accept\nor continue employment, or training or education that is preparatory to\nemployment",
      "code": "variable snap_dependent_care_deduction:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Dependent Care Deduction\"\n  description: \"Deduction for dependent care expenses necessary for work or training\"\n  syntax: python\n  formula: |\n    # Section 2014(e)(3): Actual dependent care costs necessary for work/training\n    # Includes child care, care for elderly/disabled dependents\n    # No federal cap on this deduction\n    return dependent_care_expenses\n  default: 0",
      "path": "cosilico-us/statute/7/2014/e/3.rac"
    },
    {
      "citation": "7 USC Section 2014(e)(4)",
      "title": "Child Support Deduction",
      "text": "(4) legally obligated and actually paid child support payments",
      "code": "variable snap_child_support_deduction:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Child Support Deduction\"\n  description: \"Deduction for legally obligated child support payments actually made\"\n  syntax: python\n  formula: |\n    # Section 2014(e)(4): Legally obligated child support payments actually made\n    # No cap on this deduction\n    return child_support_paid\n  default: 0",
      "path": "cosilico-us/statute/7/2014/e/4.rac"
    },
    {
      "citation": "7 USC Section 2014(e)(5)",
      "title": "Medical Expense Deduction",
      "text": "(5) that portion of actual costs of medical expenses in excess of $35 per month,\nfor any elderly or disabled member, including transportation costs necessary\nto secure medical treatment or services",
      "code": "variable snap_medical_expense_deduction:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Medical Expense Deduction\"\n  description: \"Deduction for medical expenses over $35/month for elderly/disabled members\"\n  syntax: python\n  formula: |\n    # Only available for elderly/disabled households\n    if not has_elderly_disabled:\n        return 0\n    # Section 2014(e)(5): Deduct expenses in excess of threshold\n    threshold = parameter(\"gov.usda.fns.snap.deductions.medical.threshold\")\n    excess = medical_expenses - threshold\n    return max(0, excess)\n  default: 0",
      "path": "cosilico-us/statute/7/2014/e/5.rac"
    },
    {
      "citation": "7 USC Section 2014(g)",
      "title": "Allowable Financial Resources",
      "text": "(1) The Secretary shall prescribe the types and allowable amounts of financial\nresources (liquid and nonliquid assets) an eligible household may own...\n(1)(B) ...increased for households with elderly or disabled members",
      "code": "variable snap_countable_resources:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Countable Resources\"\n  description: \"Total countable resources for SNAP after applying exclusions\"\n  syntax: python\n  formula: |\n    # Start with liquid assets\n    liquid = bank_accounts + cash_on_hand\n    # Add non-exempt financial assets\n    financial = stocks + bonds + other_financial_assets\n    # Section 2014(g)(2)(B): One vehicle excluded up to fair market value limit\n    vehicle_exclusion = parameter(\"gov.usda.fns.snap.resources.vehicle_exclusion\")\n    vehicle_excess = max(0, vehicle_fair_market_value - vehicle_exclusion)\n    return liquid + financial + vehicle_excess\n  default: 0\n\nvariable snap_resource_eligible:\n  entity: Household\n  period: Month\n  dtype: Boolean\n  label: \"SNAP Resource Eligible\"\n  description: \"Whether household's countable resources are within SNAP limits\"\n  syntax: python\n  formula: |\n    base_limit = parameter(\"gov.usda.fns.snap.resources.limit\")\n    elderly_disabled_limit = parameter(\"gov.usda.fns.snap.resources.elderly_disabled_limit\")\n    # Section 2014(g)(1)(B): Higher limit for elderly/disabled households\n    if has_elderly_disabled:\n        limit = elderly_disabled_limit\n    else:\n        limit = base_limit\n    return snap_countable_resources <= limit\n  default: false",
      "path": "cosilico-us/statute/7/2014/g.rac"
    },
    {
      "citation": "7 USC Section 2015(d)",
      "title": "Work Requirements",
      "text": "",
      "code": "variable is_snap_abawd:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"Subject to SNAP ABAWD Requirements\"\n  description: \"Whether individual is an Able-Bodied Adult Without Dependents subject to work requirements\"\n  syntax: python\n  formula: |\n    # Section 2015(o)(2): Definition of ABAWD\n    # - Aged 18-54 (as of 2025 phase-in per Fiscal Responsibility Act)\n    # - Not disabled\n    # - Not responsible for dependent child\n    # - Not pregnant\n    # - Not exempt from work registration\n    min_age = parameter(\"gov.usda.fns.snap.abawd.min_age\")\n    max_age = parameter(\"gov.usda.fns.snap.abawd.max_age\")\n    in_age_range = age >= min_age and age <= max_age\n    is_exempt = is_disabled or is_pregnant or has_dependent_child\n    return in_age_range and not is_exempt\n  default: false\n\nvariable snap_abawd_work_requirement_met:\n  entity: Person\n  period: Month\n  dtype: Boolean\n  label: \"SNAP ABAWD Work Requirement Met\"\n  description: \"Whether ABAWD individual meets 80 hour/month work requirement\"\n  syntax: python\n  formula: |\n    # Not subject to ABAWD rules = automatically meets requirement\n    if not is_snap_abawd:\n        return True\n    # Section 2015(o)(2): Must work 80+ hours/month\n    # or participate in qualifying work program\n    hours_required = parameter(\"gov.usda.fns.snap.abawd.work_hours\")\n    working = work_hours_monthly >= hours_required\n    in_program = in_snap_employment_training\n    return working or in_program\n  default: true",
      "path": "cosilico-us/statute/7/2015/d.rac"
    },
    {
      "citation": "7 USC Section 2017(a)",
      "title": "Value of Allotment",
      "text": "The value of the allotment... shall be equal to the cost of the\nthrifty food plan... reduced by an amount equal to 30 per centum\nof the household's income",
      "code": "variable snap_max_allotment:\n  imports: [26/1#cut]\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Maximum Allotment\"\n  description: \"Maximum monthly SNAP benefit based on Thrifty Food Plan for household size\"\n  syntax: python\n  formula: |\n    # Maximum allotments by household size (48 states + DC)\n    # Sizes 1-8 have specific amounts; beyond max_schedule_size, add per-person increment\n    if household_size <= max_schedule_size:\n        # Look up from schedule\n        return cut(household_size, max_allotment_schedule)\n    else:\n        # Beyond max schedule size: base amount + additional per extra member\n        base = cut(max_schedule_size, max_allotment_schedule)\n        extra_members = household_size - max_schedule_size\n        return base + (additional_per_person * extra_members)\n  default: 0\n\nvariable snap_expected_contribution:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Expected Contribution\"\n  description: \"Expected household contribution toward food costs (30% of net income)\"\n  syntax: python\n  formula: |\n    rate = parameter(\"gov.usda.fns.snap.allotment.contribution_rate\")\n    return round(snap_net_income * rate)\n  default: 0\n\nvariable snap_calculated_benefit:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Calculated Benefit\"\n  description: \"SNAP benefit calculated as maximum allotment minus expected contribution\"\n  formula: return snap_max_allotment - snap_expected_contribution\n  default: 0\n\nvariable snap_minimum_benefit:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Minimum Benefit\"\n  description: \"Minimum monthly SNAP benefit for 1-2 person households\"\n  syntax: python\n  formula: |\n    # Minimum benefit only applies to households at or below minimum_benefit_max_size\n    if household_size <= minimum_benefit_max_size:\n        return minimum_amount\n    else:\n        return 0\n  default: 0\n\nvariable snap_allotment:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Allotment\"\n  description: \"Final monthly SNAP benefit amount\"\n  syntax: python\n  formula: |\n    # Must be eligible to receive benefits\n    if not snap_eligible:\n        return 0\n    calculated = snap_calculated_benefit\n    minimum = snap_minimum_benefit\n    maximum = snap_max_allotment\n    # Apply minimum benefit floor for 1-2 person households\n    benefit = max(calculated, minimum)\n    # Cannot exceed maximum allotment\n    return max(0, min(benefit, maximum))\n  default: 0\n\n\nparameter max_allotment_schedule:\n  description: \"Maximum monthly SNAP allotment by household size\"\n  unit: USD\n  source: \"USDA FNS annual COLA memo\"\n  reference: \"7 USC 2017(a)\"\n  values:\n    2024-10-01: [292, 536, 768, 975, 1158, 1390, 1536, 1756]\n    2023-10-01: [291, 535, 766, 973, 1155, 1386, 1532, 1751]\n    2022-10-01: [281, 516, 740, 939, 1116, 1339, 1480, 1691]\n\nparameter additional_per_person:\n  description: \"Additional allotment per person beyond 8-person household\"\n  unit: USD\n  source: \"USDA FNS\"\n  values:\n    2024-10-01: 220\n    2023-10-01: 219\n    2022-10-01: 211\n\nparameter contribution_rate:\n  description: \"Household contribution as share of net income\"\n  source: \"7 USC 2017(a)\"\n  values:\n    1977-01-01: 0.30\n\nparameter minimum_benefit:\n  description: \"Minimum benefit for 1-2 person households\"\n  unit: USD\n  values:\n    2024-10-01: 23\n    2023-10-01: 23\n    2022-10-01: 23\n\nparameter minimum_benefit_max_size:\n  description: \"Maximum household size eligible for minimum benefit\"\n  values:\n    1977-01-01: 2\n\n\nvariable snap_max_allotment:\n  imports: [7/2014#household_size]\n  entity: Household\n  period: Month\n  dtype: Money\n  description: \"Maximum monthly SNAP benefit based on Thrifty Food Plan\"\n  syntax: python\n  formula: |\n    if household_size <= max_schedule_size:\n        return max_allotment_schedule[household_size - 1]\n    base = max_allotment_schedule[max_schedule_size - 1]\n    extra = household_size - max_schedule_size\n    return base + additional_per_person * extra\n  tests:\n    - inputs: {household_size: 1}\n      expect: 291\n    - inputs: {household_size: 4}\n      expect: 973\n    - inputs: {household_size: 10}\n      expect: 2189\n\nvariable snap_expected_contribution:\n  imports: [7/2014/e#snap_net_income]\n  entity: Household\n  period: Month\n  dtype: Money\n  description: \"30% of net income per 7 USC 2017(a)\"\n  formula: return snap_net_income * contribution_rate\n  tests:\n    - inputs: {snap_net_income: 0}\n      expect: 0\n    - inputs: {snap_net_income: 500}\n      expect: 150\n    - inputs: {snap_net_income: 1000}\n      expect: 300\n\nvariable snap_calculated_benefit:\n  entity: Household\n  period: Month\n  dtype: Money\n  description: \"Maximum allotment minus expected contribution\"\n  formula: return snap_max_allotment - snap_expected_contribution\n\nvariable snap_minimum_benefit:\n  entity: Household\n  period: Month\n  dtype: Money\n  description: \"Minimum benefit for 1-2 person households\"\n  syntax: python\n  formula: |\n    if household_size <= minimum_benefit_max_size:\n        return minimum_benefit\n    return 0\n  tests:\n    - inputs: {household_size: 1}\n      expect: 23\n    - inputs: {household_size: 2}\n      expect: 23\n    - inputs: {household_size: 3}\n      expect: 0\n\nvariable snap_allotment:\n  imports: [7/2014/a#snap_eligible]\n  entity: Household\n  period: Month\n  dtype: Money\n  description: \"Final monthly SNAP benefit per 7 USC 2017(a)\"\n  syntax: python\n  formula: |\n    if not snap_eligible:\n        return 0\n    calculated = snap_calculated_benefit\n    minimum = snap_minimum_benefit\n    maximum = snap_max_allotment\n    benefit = max(calculated, minimum)\n    return max(0, min(benefit, maximum))\n  tests:\n    - name: \"Single person, no income\"\n      inputs: {household_size: 1, snap_net_income: 0, snap_eligible: true}\n      expect: 291\n    - name: \"Family of 4, $500 net income\"\n      inputs: {household_size: 4, snap_net_income: 500, snap_eligible: true}\n      expect: 823\n    - name: \"Minimum benefit kicks in\"\n      inputs: {household_size: 1, snap_net_income: 900, snap_eligible: true}\n      expect: 23\n    - name: \"Not eligible\"\n      inputs: {snap_eligible: false}\n      expect: 0\n\n\nparameters:\n  # Maximum allotment schedule by household size (FY2024)\n  # Index 0 = size 1, Index 1 = size 2, etc.\n  max_allotment_schedule:\n    2023-10-01: [291, 535, 766, 973, 1155, 1386, 1532, 1751]\n\n  # Maximum size in schedule (for bounds checking)\n  max_schedule_size:\n    2023-10-01: 8\n\n  # Additional amount per person beyond schedule\n  additional_per_person:\n    2023-10-01: 219\n\n  # Contribution rate (30% of net income)\n  contribution_rate:\n    1977-01-01: 0.30\n\n  # Minimum benefit (8% of 1-person max, rounded)\n  minimum_benefit:\n    2023-10-01: 23\n\n  # Maximum household size for minimum benefit\n  minimum_benefit_max_size:\n    1977-01-01: 2\n\n\nvariable snap_max_allotment:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Maximum Allotment\"\n  description: \"Maximum monthly SNAP benefit based on Thrifty Food Plan\"\n  syntax: python\n  formula: |\n    size = household_size\n    # Lookup from schedule (index = size - 1)\n    if size <= max_schedule_size:\n        return max_allotment_schedule[size - 1]\n    # Beyond schedule: base + additional per extra member\n    base = max_allotment_schedule[max_schedule_size - 1]\n    extra_members = size - max_schedule_size\n    return base + (additional_per_person * extra_members)\n\nvariable snap_expected_contribution:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Expected Contribution\"\n  description: \"30% of net income per 7 USC 2017(a)\"\n  formula: return snap_net_income * contribution_rate\n\nvariable snap_calculated_benefit:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Calculated Benefit\"\n  description: \"Maximum allotment minus expected contribution\"\n  formula: return snap_max_allotment - snap_expected_contribution\n\nvariable snap_minimum_benefit:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Minimum Benefit\"\n  description: \"Minimum benefit for 1-2 person households\"\n  syntax: python\n  formula: |\n    if household_size <= minimum_benefit_max_size:\n        return minimum_benefit\n    return 0\n\nvariable snap_allotment:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Allotment\"\n  description: \"Final monthly SNAP benefit per 7 USC 2017(a)\"\n  syntax: python\n  formula: |\n    if not snap_eligible:\n        return 0\n    calculated = snap_calculated_benefit\n    minimum = snap_minimum_benefit\n    maximum = snap_max_allotment\n    # Apply minimum floor, cap at maximum\n    benefit = max(calculated, minimum)\n    return max(0, min(benefit, maximum))\n\n\nexamples:\n  - name: \"Single person, no income\"\n    inputs:\n      household:\n        household_size: 1\n        snap_net_income: 0\n        snap_eligible: true\n    outputs:\n      snap_max_allotment: 291\n      snap_expected_contribution: 0\n      snap_allotment: 291\n\n  - name: \"Family of 4, $500 net income\"\n    inputs:\n      household:\n        household_size: 4\n        snap_net_income: 500\n        snap_eligible: true\n    outputs:\n      snap_max_allotment: 973\n      snap_expected_contribution: 150\n      snap_allotment: 823\n\n  - name: \"Single person, benefit below minimum\"\n    inputs:\n      household:\n        household_size: 1\n        snap_net_income: 900\n        snap_eligible: true\n    outputs:\n      snap_calculated_benefit: 21\n      snap_minimum_benefit: 23\n      snap_allotment: 23\n\n  - name: \"Not eligible\"\n    inputs:\n      household:\n        household_size: 4\n        snap_net_income: 0\n        snap_eligible: false\n    outputs:\n      snap_allotment: 0",
      "path": "cosilico-us/statute/7/2017/a.rac"
    },
    {
      "citation": "Employment Insurance Act - EI Premiums and Benefits",
      "title": "EI Premiums and Benefits",
      "text": "",
      "code": "variable is_quebec_resident {\n  entity Person\n  period Year\n  dtype Bool\n  label \"Is Quebec Resident\"\n  description \"Whether the person is a Quebec resident (subject to QPIP instead of EI parental)\"\n  reference \"EI Regulations\"\n\n  formula {\n    return province == \"QC\"\n  }\n\n  default false\n}\n\n# EI premium rate\nvariable ei_premium_rate {\n  entity Person\n  period Year\n  dtype Rate\n  label \"EI Premium Rate\"\n  description \"Applicable EI employee premium rate\"\n  reference \"EI Act Section 67\"\n\n  formula {\n    if is_quebec_resident then\n      return parameter(gov.servicecanada.ei.premium.employee_rate_quebec)\n    else\n      return parameter(gov.servicecanada.ei.premium.employee_rate)\n  }\n\n  default 0\n}\n\n# Insurable earnings (capped)\nvariable ei_insurable_earnings {\n  entity Person\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"EI Insurable Earnings\"\n  description \"Earnings subject to EI premiums (capped at MIE)\"\n  reference \"EI Act Section 4\"\n\n  formula {\n    let mie = parameter(gov.servicecanada.ei.max_insurable_earnings.annual)\n    return min(insurable_earnings, mie)\n  }\n\n  default 0\n}\n\n# Employee EI premium\nvariable ei_employee_premium {\n  entity Person\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"EI Employee Premium\"\n  description \"Annual EI premium paid by employee\"\n  reference \"EI Act Section 67\"\n\n  formula {\n    return ei_insurable_earnings * ei_premium_rate\n  }\n\n  default 0\n}\n\n# Employer EI premium\nvariable ei_employer_premium {\n  entity Person\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"EI Employer Premium\"\n  description \"Annual EI premium paid by employer (1.4x employee premium)\"\n  reference \"EI Act Section 68\"\n\n  formula {\n    let multiplier = parameter(gov.servicecanada.ei.premium.employer_multiplier)\n    return ei_employee_premium * multiplier\n  }\n\n  default 0\n}\n\n# ==========================================================================\n# EI ELIGIBILITY\n# ==========================================================================\n\n# Insurable hours in last 52 weeks\nvariable insurable_hours_last_52_weeks {\n  entity Person\n  period Year\n  dtype Count\n  label \"Insurable Hours\"\n  description \"Number of insurable hours worked in the last 52 weeks\"\n  reference \"EI Act Section 7\"\n\n  # Input variable\n  default 0\n}\n\n# Regional unemployment rate\nvariable regional_unemployment_rate {\n  entity Person\n  period Year\n  dtype Rate\n  label \"Regional Unemployment Rate\"\n  description \"Unemployment rate in the economic region\"\n  reference \"EI Act Section 7, Schedule I\"\n\n  # Input variable - varies by region\n  default 0.06\n}\n\n# Hours required for regular EI (varies by regional unemployment)\nvariable ei_hours_required {\n  entity Person\n  period Year\n  dtype Count\n  label \"EI Hours Required\"\n  description \"Insurable hours required for regular EI based on regional unemployment\"\n  reference \"EI Act Section 7, Schedule I\"\n\n  formula {\n    let rate = regional_unemployment_rate\n\n    # Hours requirement varies by unemployment rate:\n    # 6% or less: 700 hours\n    # 6.1%-7%: 665 hours\n    # 7.1%-8%: 630 hours\n    # 8.1%-9%: 595 hours\n    # 9.1%-10%: 560 hours\n    # 10.1%-11%: 525 hours\n    # 11.1%-12%: 490 hours\n    # 12.1%-13%: 455 hours\n    # 13.1%+: 420 hours\n\n    match {\n      case rate <= 0.06 => 700\n      case rate <= 0.07 => 665\n      case rate <= 0.08 => 630\n      case rate <= 0.09 => 595\n      case rate <= 0.10 => 560\n      case rate <= 0.11 => 525\n      case rate <= 0.12 => 490\n      case rate <= 0.13 => 455\n      else => 420\n    }\n  }\n\n  default 700\n}\n\n# Is eligible for regular EI\nvariable is_ei_eligible {\n  entity Person\n  period Year\n  dtype Bool\n  label \"EI Eligible\"\n  description \"Whether the person is eligible for regular EI benefits\"\n  reference \"EI Act Section 7\"\n\n  formula {\n    let hours_required = ei_hours_required\n    let hours_worked = insurable_hours_last_52_weeks\n    let reason = variable(ei_claim_reason)\n\n    # Must have sufficient hours\n    if hours_worked < hours_required then\n      return false\n\n    # Cannot have quit without just cause or been fired for misconduct\n    if reason == \"quit_without_cause\" or reason == \"misconduct\" then\n      return false\n\n    return true\n  }\n\n  default false\n}\n\n# ==========================================================================\n# EI BENEFITS CALCULATION\n# ==========================================================================\n\n# Average weekly insurable earnings\nvariable ei_average_weekly_earnings {\n  entity Person\n  period Week\n  dtype Money\n  unit \"CAD\"\n  label \"EI Average Weekly Earnings\"\n  description \"Average weekly insurable earnings used to calculate benefits\"\n  reference \"EI Act Section 14\"\n\n  formula {\n    # Uses best weeks (number varies by regional unemployment rate)\n    # Simplified: use average of insurable earnings\n    let annual = ei_insurable_earnings\n    return annual / 52\n  }\n\n  default 0\n}\n\n# EI benefit rate (base or with family supplement)\nvariable ei_benefit_rate {\n  entity Person\n  period Year\n  dtype Rate\n  label \"EI Benefit Rate\"\n  description \"Percentage of earnings for EI benefit (55% base, up to 80% with family supplement)\"\n  reference \"EI Act Section 14, 16\"\n\n  formula {\n    let base_rate = parameter(gov.servicecanada.ei.benefit.standard_rate)\n    let max_rate = parameter(gov.servicecanada.ei.benefit.family_supplement_max_rate)\n    let income_threshold = parameter(gov.servicecanada.ei.family_supplement.income_threshold)\n\n    # Family supplement for low-income families with children\n    if num_children > 0 and family_net_income <= income_threshold then\n      # Graduated increase up to 80%\n      return max_rate\n    else\n      return base_rate\n  }\n\n  default 0.55\n}\n\n# Weekly EI benefit amount\nvariable ei_weekly_benefit {\n  entity Person\n  period Week\n  dtype Money\n  unit \"CAD\"\n  label \"EI Weekly Benefit\"\n  description \"Weekly Employment Insurance benefit amount\"\n  reference \"EI Act Section 14\"\n\n  formula {\n    if not is_ei_eligible then\n      return 0\n\n    let avg_earnings = ei_average_weekly_earnings\n    let rate = ei_benefit_rate\n    let max_weekly = parameter(gov.servicecanada.ei.benefit.max_weekly)\n\n    let benefit = avg_earnings * rate\n    return min(benefit, max_weekly)\n  }\n\n  default 0\n}\n\n# ==========================================================================\n# BENEFIT DURATION\n# ==========================================================================\n\n# Maximum weeks of regular EI\nvariable ei_max_weeks {\n  entity Person\n  period Year\n  dtype Count\n  label \"EI Maximum Weeks\"\n  description \"Maximum weeks of regular EI benefits based on hours and regional unemployment\"\n  reference \"EI Act Section 12, Schedule I\"\n\n  formula {\n    let hours = insurable_hours_last_52_weeks\n    let rate = regional_unemployment_rate\n    let max_regular = parameter(gov.servicecanada.ei.duration.regular_max_weeks)\n\n    # Weeks calculation based on hours and unemployment rate\n    # Higher hours and higher unemployment = more weeks\n    # Simplified calculation\n    let base_weeks = (hours / 35) + ((rate - 0.06) * 100)\n    let weeks = clamp(base_weeks, 14, max_regular)\n\n    return floor(weeks)\n  }\n\n  default 14\n}\n\n# ==========================================================================\n# SPECIAL BENEFITS\n# ==========================================================================\n\n# EI claim reason\nvariable ei_claim_reason {\n  entity Person\n  period Year\n  dtype Enum(job_loss, quit_with_cause, quit_without_cause, misconduct, maternity, parental, sickness, caregiving)\n  label \"EI Claim Reason\"\n  description \"Reason for EI claim\"\n  reference \"EI Act\"\n\n  # Input variable\n  default job_loss\n}\n\n# Is claiming maternity benefits\nvariable is_maternity_claim {\n  entity Person\n  period Year\n  dtype Bool\n  label \"Is Maternity Claim\"\n  description \"Whether claiming EI maternity benefits\"\n  reference \"EI Act Section 22\"\n\n  formula {\n    return ei_claim_reason == \"maternity\"\n  }\n\n  default false\n}\n\n# Maternity benefit weeks\nvariable ei_maternity_weeks {\n  entity Person\n  period Year\n  dtype Count\n  label \"EI Maternity Weeks\"\n  description \"Maximum weeks of maternity benefits\"\n  reference \"EI Act Section 22\"\n\n  formula {\n    if not is_maternity_claim then\n      return 0\n\n    return parameter(gov.servicecanada.ei.duration.maternity_weeks)\n  }\n\n  default 0\n}\n\n# Sickness benefit weeks\nvariable ei_sickness_weeks {\n  entity Person\n  period Year\n  dtype Count\n  label \"EI Sickness Weeks\"\n  description \"Maximum weeks of sickness benefits\"\n  reference \"EI Act Section 12\"\n\n  formula {\n    if ei_claim_reason != \"sickness\" then\n      return 0\n\n    return parameter(gov.servicecanada.ei.duration.sickness_weeks)\n  }\n\n  default 0\n}\n\n# Parental benefit option\nvariable parental_benefit_option {\n  entity Person\n  period Year\n  dtype Enum(standard, extended)\n  label \"Parental Benefit Option\"\n  description \"Choice between standard (55%, 40 weeks) or extended (33%, 69 weeks) parental benefits\"\n  reference \"EI Act Section 23\"\n\n  # Input variable\n  default standard\n}\n\n# Parental benefit weeks\nvariable ei_parental_weeks {\n  entity Person\n  period Year\n  dtype Count\n  label \"EI Parental Weeks\"\n  description \"Maximum weeks of parental benefits\"\n  reference \"EI Act Section 23\"\n\n  formula {\n    if ei_claim_reason != \"parental\" then\n      return 0\n\n    if parental_benefit_option == \"extended\" then\n      return parameter(gov.servicecanada.ei.duration.parental_extended_weeks)\n    else\n      return parameter(gov.servicecanada.ei.duration.parental_standard_weeks)\n  }\n\n  default 0\n}\n\n# Parental benefit rate (varies by option)\nvariable ei_parental_rate {\n  entity Person\n  period Year\n  dtype Rate\n  label \"EI Parental Rate\"\n  description \"Benefit rate for parental benefits (55% standard, 33% extended)\"\n  reference \"EI Act Section 23\"\n\n  formula {\n    if parental_benefit_option == \"extended\" then\n      return parameter(gov.servicecanada.ei.benefit.extended_parental_rate)\n    else\n      return parameter(gov.servicecanada.ei.benefit.standard_rate)\n  }\n\n  default 0.55\n}",
      "path": "cosilico-ca/statute/EI/ei.cosilico"
    },
    {
      "citation": "Income Tax Act Section 122.5 - GST/HST Credit",
      "title": "GST/HST Credit",
      "text": "",
      "code": "variable num_gst_qualified_dependants {\n  entity TaxUnit\n  period Year\n  dtype Count\n  label \"GST/HST Qualified Dependants\"\n  description \"Number of children under 19 who are qualified dependants for GST/HST credit\"\n  reference \"ITA 122.5(1) definition of 'qualified dependant'\"\n\n  formula {\n    let max_age = parameter(gov.cra.gst_hst.age.child_maximum)\n    return tax_unit.members.count(where: age < max_age)\n  }\n\n  default 0\n}\n\n# Is eligible for GST/HST credit\nvariable is_gst_hst_eligible {\n  entity Person\n  period Year\n  dtype Bool\n  label \"GST/HST Credit Eligible\"\n  description \"Whether the individual is eligible to receive the GST/HST credit\"\n  reference \"ITA 122.5(2)\"\n\n  formula {\n    let min_age = parameter(gov.cra.gst_hst.age.minimum)\n\n    # Must be Canadian resident\n    if not is_canadian_resident then\n      return false\n\n    # Must be 19+ OR have spouse/common-law partner OR have child OR previously married\n    if age >= min_age then\n      return true\n\n    if is_married_or_common_law then\n      return true\n\n    if variable(has_children) then\n      return true\n\n    return false\n  }\n\n  default false\n}\n\n# GST/HST credit base amount (before phase-out)\nvariable gst_hst_credit_maximum {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"GST/HST Maximum Credit\"\n  description \"Maximum GST/HST credit before income-based reduction\"\n  reference \"ITA 122.5(3)\"\n\n  formula {\n    let individual_amount = parameter(gov.cra.gst_hst.amount.individual)\n    let spouse_amount = parameter(gov.cra.gst_hst.amount.spouse)\n    let child_amount = parameter(gov.cra.gst_hst.amount.child)\n    let single_supplement = parameter(gov.cra.gst_hst.amount.single_supplement)\n\n    let base = individual_amount\n\n    if is_married_or_common_law then\n      # Add spouse amount\n      let with_spouse = base + spouse_amount\n      # Add child amounts\n      return with_spouse + (num_children_under_19 * child_amount)\n    else\n      if num_children_under_19 > 0 then\n        # Single parent: first child replaces spouse amount\n        let with_first_child = base + spouse_amount\n        # Additional children get child amount\n        let additional_children = max(0, num_children_under_19 - 1)\n        return with_first_child + (additional_children * child_amount)\n      else\n        # Single with no dependants - may get single supplement\n        if variable(qualifies_for_single_supplement) then\n          return base + single_supplement\n        else\n          return base\n  }\n\n  default 0\n}\n\n# GST/HST credit income threshold\nvariable gst_hst_threshold {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"GST/HST Income Threshold\"\n  description \"Income threshold above which GST/HST credit is reduced\"\n  reference \"ITA 122.5(3)\"\n\n  formula {\n    let individual_threshold = parameter(gov.cra.gst_hst.threshold.individual)\n    let family_threshold = parameter(gov.cra.gst_hst.threshold.family)\n\n    # Family threshold applies if married or has children\n    if is_married_or_common_law or num_children_under_19 > 0 then\n      return family_threshold\n    else\n      return individual_threshold\n  }\n\n  default 0\n}\n\n# GST/HST credit reduction\nvariable gst_hst_credit_reduction {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"GST/HST Credit Reduction\"\n  description \"Reduction in GST/HST credit based on income above threshold\"\n  reference \"ITA 122.5(3)\"\n\n  formula {\n    let phaseout_rate = parameter(gov.cra.gst_hst.phaseout.rate)\n    let threshold = gst_hst_threshold\n    let income = adjusted_family_net_income\n\n    if income <= threshold then\n      return 0\n\n    return (income - threshold) * phaseout_rate\n  }\n\n  default 0\n}\n\n# Annual GST/HST credit\nvariable gst_hst_credit {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"GST/HST Credit\"\n  description \"Annual GST/HST credit payable to eligible individuals and families\"\n  reference (\n    \"ITA 122.5\",\n    \"https://www.canada.ca/en/revenue-agency/services/child-family-benefits/goods-services-tax-harmonized-sales-tax-gst-hst-credit.html\"\n  )\n\n  formula {\n    # Check eligibility of primary filer\n    if not tax_unit.members.any(is_gst_hst_eligible) then\n      return 0\n\n    let maximum = gst_hst_credit_maximum\n    let reduction = gst_hst_credit_reduction\n\n    return max(0, maximum - reduction)\n  }\n\n  default 0\n}\n\n# Quarterly GST/HST credit payment\nvariable gst_hst_credit_quarterly {\n  entity TaxUnit\n  period Quarter\n  dtype Money\n  unit \"CAD\"\n  label \"GST/HST Quarterly Payment\"\n  description \"Quarterly GST/HST credit payment (July, October, January, April)\"\n  reference \"ITA 122.5(3.1)\"\n\n  formula {\n    return gst_hst_credit / 4\n  }\n\n  default 0\n}\n\n# Single supplement eligibility\nvariable qualifies_for_single_supplement {\n  entity TaxUnit\n  period Year\n  dtype Bool\n  label \"Qualifies for Single Supplement\"\n  description \"Whether the individual qualifies for the additional single supplement\"\n  reference \"ITA 122.5(3)(b.1)\"\n\n  formula {\n    # Single supplement available if:\n    # - Not married/common-law\n    # - No qualified dependants\n    # - Income below threshold\n    return not is_married_or_common_law and num_children_under_19 == 0\n  }\n\n  default false\n}",
      "path": "cosilico-ca/statute/ITA/122.5/gst_hst_credit.cosilico"
    },
    {
      "citation": "Income Tax Act Section 122.6 - CCB Definitions",
      "title": "CCB Definitions",
      "text": "",
      "code": "variable adjusted_family_net_income {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"Adjusted Family Net Income\"\n  description \"Sum of net income of the eligible individual and their cohabiting spouse or common-law partner, used for CCB income testing\"\n  reference \"ITA 122.6 definition of 'adjusted income'\"\n\n  formula {\n    return individual_net_income + spouse_net_income\n  }\n\n  default 0\n}\n\n# Is child a qualified dependant (under 18)\nvariable is_qualified_dependant {\n  entity Person\n  period Year\n  dtype Bool\n  label \"Is Qualified Dependant\"\n  description \"Whether the person is a qualified dependant for CCB purposes (under 18 and residing with eligible individual)\"\n  reference \"ITA 122.6 definition of 'qualified dependant'\"\n\n  formula {\n    let max_age = parameter(gov.cra.ccb.age_threshold.maximum)\n    return child_age < max_age\n  }\n\n  default false\n}\n\n# Count of qualified dependants under age 6\nvariable num_qualified_dependants_under_6 {\n  entity TaxUnit\n  period Year\n  dtype Count\n  label \"Qualified Dependants Under 6\"\n  description \"Number of qualified dependants under age 6 at the beginning of the month\"\n  reference \"ITA 122.61(1)(a)\"\n\n  formula {\n    let young_age = parameter(gov.cra.ccb.age_threshold.young_child)\n    return tax_unit.members.count(where: is_qualified_dependant and child_age < young_age)\n  }\n\n  default 0\n}\n\n# Count of qualified dependants age 6 to 17\nvariable num_qualified_dependants_6_to_17 {\n  entity TaxUnit\n  period Year\n  dtype Count\n  label \"Qualified Dependants 6-17\"\n  description \"Number of qualified dependants aged 6 to 17 at the beginning of the month\"\n  reference \"ITA 122.61(1)(a)\"\n\n  formula {\n    let young_age = parameter(gov.cra.ccb.age_threshold.young_child)\n    let max_age = parameter(gov.cra.ccb.age_threshold.maximum)\n    return tax_unit.members.count(where: is_qualified_dependant and child_age >= young_age and child_age < max_age)\n  }\n\n  default 0\n}\n\n# Is eligible individual (primary caregiver)\nvariable is_eligible_individual {\n  entity Person\n  period Year\n  dtype Bool\n  label \"Is Eligible Individual\"\n  description \"Whether the person is an eligible individual (primarily responsible for care and upbringing of the child)\"\n  reference \"ITA 122.6 definition of 'eligible individual'\"\n\n  formula {\n    # Eligible individual must:\n    # (a) reside with the qualified dependant\n    # (b) be a Canadian citizen, permanent resident, protected person, or temporary resident with 18 months residence\n    # (c) be primarily responsible for care and upbringing (presumed to be female parent unless otherwise stated)\n    # For simplicity, this is an input variable\n    return variable(is_primary_caregiver)\n  }\n\n  default false\n}\n\n# Shared custody indicator\nvariable is_shared_custody {\n  entity TaxUnit\n  period Year\n  dtype Bool\n  label \"Is Shared Custody\"\n  description \"Whether the qualified dependant lives equally with both parents (shared custody arrangement)\"\n  reference \"ITA 122.6 definition of 'shared-custody parent'\"\n\n  # This is an input - parents must each receive 50% of CCB when custody is shared\n  # A shared-custody parent is one where the qualified dependant resides with\n  # both parents on an equal or near equal basis\n\n  default false\n}\n\n# Primary caregiver indicator (input)\nvariable is_primary_caregiver {\n  entity Person\n  period Year\n  dtype Bool\n  label \"Is Primary Caregiver\"\n  description \"Whether the person is primarily responsible for the care and upbringing of the child\"\n  reference \"ITA 122.6 definition of 'eligible individual' paragraph (b)\"\n\n  # Input variable - presumed to be the female parent unless:\n  # - a form is filed specifying otherwise\n  # - the male parent is the sole parent residing with the child\n  # - both parents reside with the child and the female parent files a notice\n\n  default false\n}",
      "path": "cosilico-ca/statute/ITA/122.6/definitions.cosilico"
    },
    {
      "citation": "Income Tax Act Section 122.61 - Canada Child Benefit",
      "title": "Canada Child Benefit",
      "text": "",
      "code": "variable num_qualified_dependants {\n  entity TaxUnit\n  period Year\n  dtype Count\n  label \"Number of Qualified Dependants\"\n  description \"Total number of children under 18 for whom the individual is an eligible individual\"\n  reference \"ITA 122.6 definition of 'qualified dependant'\"\n\n  formula {\n    return num_children_under_6 + num_children_6_to_17\n  }\n\n  default 0\n}\n\n# Maximum CCB amount before income reduction\nvariable ccb_maximum_amount {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CCB Maximum Amount\"\n  description \"Maximum annual CCB amount based on number and ages of qualified dependants\"\n  reference \"ITA 122.61(1)(a)\"\n\n  formula {\n    let max_under_6 = parameter(gov.cra.ccb.max_amount.under_6)\n    let max_6_to_17 = parameter(gov.cra.ccb.max_amount.age_6_to_17)\n\n    return (num_children_under_6 * max_under_6) + (num_children_6_to_17 * max_6_to_17)\n  }\n\n  default 0\n}\n\n# First zone reduction rate (depends on number of children)\nvariable ccb_first_zone_rate {\n  entity TaxUnit\n  period Year\n  dtype Rate\n  label \"CCB First Zone Reduction Rate\"\n  description \"Reduction rate in first income zone, varies by number of children\"\n  reference \"ITA 122.61(1)(a)(ii)\"\n\n  formula {\n    let rate_1_child = parameter(gov.cra.ccb.reduction_rate.first_zone.one_child)\n    let rate_2_plus = parameter(gov.cra.ccb.reduction_rate.first_zone.two_plus_children)\n\n    if num_qualified_dependants == 1 then\n      return rate_1_child\n    else\n      return rate_2_plus\n  }\n\n  default 0\n}\n\n# Second zone reduction rate (depends on number of children)\nvariable ccb_second_zone_rate {\n  entity TaxUnit\n  period Year\n  dtype Rate\n  label \"CCB Second Zone Reduction Rate\"\n  description \"Reduction rate in second income zone, varies by number of children\"\n  reference \"ITA 122.61(1)(a)(iii)\"\n\n  formula {\n    let rate_1_child = parameter(gov.cra.ccb.reduction_rate.second_zone.one_child)\n    let rate_2_plus = parameter(gov.cra.ccb.reduction_rate.second_zone.two_plus_children)\n\n    if num_qualified_dependants == 1 then\n      return rate_1_child\n    else\n      return rate_2_plus\n  }\n\n  default 0\n}\n\n# First zone income reduction amount\nvariable ccb_first_zone_reduction {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CCB First Zone Reduction\"\n  description \"Reduction in CCB based on income in first reduction zone\"\n  reference \"ITA 122.61(1)(a)(ii)\"\n\n  formula {\n    let threshold_1 = parameter(gov.cra.ccb.income_threshold.first)\n    let threshold_2 = parameter(gov.cra.ccb.income_threshold.second)\n    let afni = adjusted_family_net_income\n\n    # No reduction if below first threshold\n    if afni <= threshold_1 then\n      return 0\n\n    # Calculate income in first zone (capped at second threshold)\n    let first_zone_income = min(afni, threshold_2) - threshold_1\n    return first_zone_income * ccb_first_zone_rate\n  }\n\n  default 0\n}\n\n# Second zone income reduction amount\nvariable ccb_second_zone_reduction {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CCB Second Zone Reduction\"\n  description \"Reduction in CCB based on income in second reduction zone\"\n  reference \"ITA 122.61(1)(a)(iii)\"\n\n  formula {\n    let threshold_2 = parameter(gov.cra.ccb.income_threshold.second)\n    let afni = adjusted_family_net_income\n\n    # No reduction if below second threshold\n    if afni <= threshold_2 then\n      return 0\n\n    let second_zone_income = afni - threshold_2\n    return second_zone_income * ccb_second_zone_rate\n  }\n\n  default 0\n}\n\n# Total income reduction\nvariable ccb_income_reduction {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CCB Income Reduction\"\n  description \"Total reduction in CCB based on adjusted family net income\"\n  reference \"ITA 122.61(1)(a)\"\n\n  formula {\n    return ccb_first_zone_reduction + ccb_second_zone_reduction\n  }\n\n  default 0\n}\n\n# Annual CCB amount (before shared custody adjustment)\nvariable ccb_annual_amount_before_shared_custody {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CCB Annual Amount (Before Shared Custody)\"\n  description \"Annual CCB amount after income reduction but before shared custody adjustment\"\n  reference \"ITA 122.61(1)\"\n\n  formula {\n    return max(0, ccb_maximum_amount - ccb_income_reduction)\n  }\n\n  default 0\n}\n\n# Final annual CCB amount\nvariable ccb_amount {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"Canada Child Benefit\"\n  description \"Annual Canada Child Benefit amount payable to the eligible individual\"\n  reference (\n    \"ITA 122.61(1)\",\n    \"https://www.canada.ca/en/revenue-agency/services/child-family-benefits/canada-child-benefit-overview.html\"\n  )\n\n  formula {\n    let base_amount = ccb_annual_amount_before_shared_custody\n\n    # Shared custody results in 50% of the benefit\n    if is_shared_custody then\n      return base_amount * 0.5\n    else\n      return base_amount\n  }\n\n  defined_for {\n    num_qualified_dependants > 0\n  }\n\n  default 0\n}\n\n# Monthly CCB payment\nvariable ccb_monthly {\n  entity TaxUnit\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"CCB Monthly Payment\"\n  description \"Monthly Canada Child Benefit payment (1/12 of annual amount)\"\n  reference \"ITA 122.61(1)\"\n\n  formula {\n    return ccb_amount / 12\n  }\n\n  default 0\n}",
      "path": "cosilico-ca/statute/ITA/122.61/ccb.cosilico"
    },
    {
      "citation": "Income Tax Act Section 122.7 - Canada Workers Benefit",
      "title": "Canada Workers Benefit",
      "text": "",
      "code": "variable is_cwb_family {\n  entity TaxUnit\n  period Year\n  dtype Bool\n  label \"Is CWB Family\"\n  description \"Whether the unit qualifies as a family (has spouse or qualified dependant)\"\n  reference \"ITA 122.7 definition of 'eligible individual'\"\n\n  formula {\n    return is_married_or_common_law or has_dependants\n  }\n\n  default false\n}\n\n# CWB eligibility\nvariable is_cwb_eligible {\n  entity Person\n  period Year\n  dtype Bool\n  label \"CWB Eligible\"\n  description \"Whether the individual is eligible for the Canada Workers Benefit\"\n  reference \"ITA 122.7(1)\"\n\n  formula {\n    let min_age = parameter(gov.cra.cwb.age.minimum)\n    let max_incarceration = parameter(gov.cra.cwb.incarceration.max_days)\n\n    # Must be resident of Canada\n    if not variable(is_canadian_resident) then\n      return false\n\n    # Age requirement (19+) unless have spouse or dependant\n    if age < min_age and not is_cwb_family then\n      return false\n\n    # Cannot be incarcerated 90+ days\n    if variable(days_incarcerated) >= max_incarceration then\n      return false\n\n    # Students have special rules (simplified: eligible if 19+)\n    # Full rule: not enrolled full-time for more than 13 weeks unless have dependant\n\n    return true\n  }\n\n  default false\n}\n\n# Working income for CWB (employment + self-employment income)\nvariable working_income {\n  entity Person\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"Working Income\"\n  description \"Total working income from employment and self-employment for CWB purposes\"\n  reference \"ITA 122.7 definition of 'working income'\"\n\n  formula {\n    # Working income = employment income + self-employment income + amounts from RDSP\n    return variable(employment_income) + variable(self_employment_income)\n  }\n\n  default 0\n}\n\n# CWB basic benefit - phase-in amount\nvariable cwb_phase_in_amount {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CWB Phase-in Amount\"\n  description \"Amount of CWB earned based on working income\"\n  reference \"ITA 122.7(1)\"\n\n  formula {\n    let threshold = parameter(gov.cra.cwb.basic.phase_in_threshold)\n    let rate = parameter(gov.cra.cwb.basic.phase_in_rate)\n    let work_income = tax_unit.members.sum(working_income)\n\n    if work_income <= threshold then\n      return 0\n\n    return (work_income - threshold) * rate\n  }\n\n  default 0\n}\n\n# CWB basic benefit maximum (depends on family status)\nvariable cwb_max_basic {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CWB Maximum Basic\"\n  description \"Maximum basic CWB amount based on family status\"\n  reference \"ITA 122.7(1.1)\"\n\n  formula {\n    let max_single = parameter(gov.cra.cwb.basic.max_single)\n    let max_family = parameter(gov.cra.cwb.basic.max_family)\n\n    if is_cwb_family then\n      return max_family\n    else\n      return max_single\n  }\n\n  default 0\n}\n\n# CWB phase-out threshold (depends on family status)\nvariable cwb_phase_out_threshold {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CWB Phase-out Threshold\"\n  description \"Income threshold above which CWB phases out\"\n  reference \"ITA 122.7(1.1)\"\n\n  formula {\n    let threshold_single = parameter(gov.cra.cwb.basic.phase_out_threshold_single)\n    let threshold_family = parameter(gov.cra.cwb.basic.phase_out_threshold_family)\n\n    if is_cwb_family then\n      return threshold_family\n    else\n      return threshold_single\n  }\n\n  default 0\n}\n\n# CWB basic benefit - phase-out reduction\nvariable cwb_phase_out_reduction {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CWB Phase-out Reduction\"\n  description \"Reduction in CWB based on adjusted net income above threshold\"\n  reference \"ITA 122.7(1.1)\"\n\n  formula {\n    let threshold = cwb_phase_out_threshold\n    let rate = parameter(gov.cra.cwb.basic.phase_out_rate)\n    let income = adjusted_net_income\n\n    if income <= threshold then\n      return 0\n\n    return (income - threshold) * rate\n  }\n\n  default 0\n}\n\n# CWB basic benefit\nvariable cwb_basic {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CWB Basic Benefit\"\n  description \"Canada Workers Benefit basic component\"\n  reference \"ITA 122.7(1)\"\n\n  formula {\n    if not tax_unit.members.any(is_cwb_eligible) then\n      return 0\n\n    # Phase-in amount, capped at maximum\n    let earned = min(cwb_phase_in_amount, cwb_max_basic)\n\n    # Reduce by phase-out\n    let reduced = earned - cwb_phase_out_reduction\n\n    return max(0, reduced)\n  }\n\n  default 0\n}\n\n# CWB disability supplement - phase-in amount\nvariable cwb_disability_phase_in {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CWB Disability Phase-in\"\n  description \"Disability supplement amount earned based on working income\"\n  reference \"ITA 122.7(1.2)\"\n\n  formula {\n    let threshold = parameter(gov.cra.cwb.disability.phase_in_threshold)\n    let rate = parameter(gov.cra.cwb.disability.phase_in_rate)\n    let work_income = tax_unit.members.sum(working_income)\n\n    if work_income <= threshold then\n      return 0\n\n    return (work_income - threshold) * rate\n  }\n\n  default 0\n}\n\n# CWB disability supplement\nvariable cwb_disability {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CWB Disability Supplement\"\n  description \"Canada Workers Benefit disability supplement\"\n  reference \"ITA 122.7(1.2)\"\n\n  formula {\n    # Must have at least one eligible disabled person in the unit\n    if not tax_unit.members.any(is_disabled and is_cwb_eligible) then\n      return 0\n\n    let max_disability = parameter(gov.cra.cwb.disability.max_amount)\n    let phase_out_rate = parameter(gov.cra.cwb.disability.phase_out_rate)\n\n    # Phase-in amount, capped at maximum\n    let earned = min(cwb_disability_phase_in, max_disability)\n\n    # Phase-out uses same thresholds as basic benefit\n    let threshold = cwb_phase_out_threshold\n    let income = adjusted_net_income\n\n    if income <= threshold then\n      return earned\n\n    let reduction = (income - threshold) * phase_out_rate\n    return max(0, earned - reduction)\n  }\n\n  default 0\n}\n\n# Total CWB\nvariable cwb_total {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"Canada Workers Benefit\"\n  description \"Total Canada Workers Benefit (basic + disability supplement)\"\n  reference (\n    \"ITA 122.7\",\n    \"https://www.canada.ca/en/revenue-agency/services/child-family-benefits/cwb.html\"\n  )\n\n  formula {\n    return cwb_basic + cwb_disability\n  }\n\n  default 0\n}",
      "path": "cosilico-ca/statute/ITA/122.7/cwb.cosilico"
    },
    {
      "citation": "Income Tax Act Section 122.8 - Climate Action Incentive Payment",
      "title": "Climate Action Incentive Payment",
      "text": "",
      "code": "variable is_caip_eligible {\n  entity Person\n  period Year\n  dtype Bool\n  label \"CAIP Eligible\"\n  description \"Whether the person is eligible for CAIP (resident of a province using federal carbon pricing)\"\n  reference \"ITA 122.8(2)\"\n\n  formula {\n    # Eligible provinces as of 2024: ON, AB, SK, MB\n    match province {\n      case \"ON\" => true\n      case \"AB\" => true\n      case \"SK\" => true\n      case \"MB\" => true\n      else => false\n    }\n  }\n\n  default false\n}\n\n# Individual CAIP amount (varies by province)\nvariable caip_individual_amount {\n  entity Person\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CAIP Individual Amount\"\n  description \"Base CAIP amount for an individual based on province of residence\"\n  reference \"ITA 122.8 / Schedule 14\"\n\n  formula {\n    match province {\n      case \"ON\" => parameter(gov.cra.caip.ontario.individual)\n      case \"AB\" => parameter(gov.cra.caip.alberta.individual)\n      case \"SK\" => parameter(gov.cra.caip.saskatchewan.individual)\n      case \"MB\" => parameter(gov.cra.caip.manitoba.individual)\n      else => 0\n    }\n  }\n\n  default 0\n}\n\n# Spouse CAIP amount (varies by province)\nvariable caip_spouse_amount {\n  entity Person\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CAIP Spouse Amount\"\n  description \"Additional CAIP amount for a spouse or common-law partner\"\n  reference \"ITA 122.8 / Schedule 14\"\n\n  formula {\n    match province {\n      case \"ON\" => parameter(gov.cra.caip.ontario.spouse)\n      case \"AB\" => parameter(gov.cra.caip.alberta.spouse)\n      case \"SK\" => parameter(gov.cra.caip.saskatchewan.spouse)\n      case \"MB\" => parameter(gov.cra.caip.manitoba.spouse)\n      else => 0\n    }\n  }\n\n  default 0\n}\n\n# Child CAIP amount (varies by province)\nvariable caip_child_amount {\n  entity Person\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CAIP Child Amount\"\n  description \"CAIP amount for each child under 19\"\n  reference \"ITA 122.8 / Schedule 14\"\n\n  formula {\n    match province {\n      case \"ON\" => parameter(gov.cra.caip.ontario.child)\n      case \"AB\" => parameter(gov.cra.caip.alberta.child)\n      case \"SK\" => parameter(gov.cra.caip.saskatchewan.child)\n      case \"MB\" => parameter(gov.cra.caip.manitoba.child)\n      else => 0\n    }\n  }\n\n  default 0\n}\n\n# Base CAIP amount before rural supplement\nvariable caip_base_amount {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CAIP Base Amount\"\n  description \"Total CAIP amount before rural supplement\"\n  reference \"ITA 122.8\"\n\n  formula {\n    if not tax_unit.members.any(is_caip_eligible) then\n      return 0\n\n    let individual = caip_individual_amount\n    let spouse = caip_spouse_amount\n    let child = caip_child_amount\n\n    if is_married_or_common_law then\n      return individual + spouse + (num_children_under_19 * child)\n    else\n      return individual + (num_children_under_19 * child)\n  }\n\n  default 0\n}\n\n# Rural supplement amount\nvariable caip_rural_supplement {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"CAIP Rural Supplement\"\n  description \"Additional CAIP amount for residents of rural or small communities\"\n  reference \"ITA 122.8\"\n\n  formula {\n    if not is_rural then\n      return 0\n\n    let supplement_rate = parameter(gov.cra.caip.rural_supplement.rate)\n    return caip_base_amount * supplement_rate\n  }\n\n  default 0\n}\n\n# Annual CAIP amount\nvariable caip_amount {\n  entity TaxUnit\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"Climate Action Incentive Payment\"\n  description \"Annual Climate Action Incentive Payment for eligible individuals and families\"\n  reference (\n    \"ITA 122.8\",\n    \"https://www.canada.ca/en/revenue-agency/services/child-family-benefits/cai-payment.html\"\n  )\n\n  formula {\n    return caip_base_amount + caip_rural_supplement\n  }\n\n  defined_for {\n    tax_unit.members.any(is_caip_eligible)\n  }\n\n  default 0\n}\n\n# Quarterly CAIP payment\nvariable caip_quarterly {\n  entity TaxUnit\n  period Quarter\n  dtype Money\n  unit \"CAD\"\n  label \"CAIP Quarterly Payment\"\n  description \"Quarterly Climate Action Incentive Payment (April, July, October, January)\"\n  reference \"ITA 122.8\"\n\n  formula {\n    return caip_amount / 4\n  }\n\n  default 0\n}",
      "path": "cosilico-ca/statute/ITA/122.8/caip.cosilico"
    },
    {
      "citation": "Old Age Security Act - OAS Pension and GIS",
      "title": "OAS Pension and GIS",
      "text": "",
      "code": "variable is_oas_eligible {\n  entity Person\n  period Year\n  dtype Bool\n  label \"OAS Eligible\"\n  description \"Whether the person is eligible for the Old Age Security pension\"\n  reference \"OAS Act Section 3\"\n\n  formula {\n    let min_age = parameter(gov.servicecanada.oas.age.minimum)\n    let min_residence = parameter(gov.servicecanada.oas.residence.minimum_years)\n\n    return age >= min_age and years_of_residence_in_canada >= min_residence\n  }\n\n  default false\n}\n\n# OAS partial pension rate (pro-rated by residence years)\nvariable oas_pension_rate {\n  entity Person\n  period Year\n  dtype Rate\n  label \"OAS Pension Rate\"\n  description \"Proportion of full OAS pension based on years of residence\"\n  reference \"OAS Act Section 3\"\n\n  formula {\n    let min_residence = parameter(gov.servicecanada.oas.residence.minimum_years)\n    let full_residence = parameter(gov.servicecanada.oas.residence.full_pension_years)\n\n    if years_of_residence_in_canada < min_residence then\n      return 0\n\n    let years = min(years_of_residence_in_canada, full_residence)\n    return years / full_residence\n  }\n\n  default 0\n}\n\n# Maximum OAS monthly amount (depends on age)\nvariable oas_max_monthly {\n  entity Person\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"OAS Maximum Monthly\"\n  description \"Maximum monthly OAS based on age (higher for 75+)\"\n  reference \"OAS Act Section 3\"\n\n  formula {\n    let bonus_age = parameter(gov.servicecanada.oas.age.bonus_threshold)\n    let max_65_74 = parameter(gov.servicecanada.oas.oas.max_monthly_65_74)\n    let max_75_plus = parameter(gov.servicecanada.oas.oas.max_monthly_75_plus)\n\n    if age >= bonus_age then\n      return max_75_plus\n    else\n      return max_65_74\n  }\n\n  default 0\n}\n\n# Gross OAS monthly (before recovery tax)\nvariable oas_gross_monthly {\n  entity Person\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"OAS Gross Monthly\"\n  description \"Monthly OAS amount before recovery tax (clawback)\"\n  reference \"OAS Act Section 3\"\n\n  formula {\n    if not is_oas_eligible then\n      return 0\n\n    return oas_max_monthly * oas_pension_rate\n  }\n\n  default 0\n}\n\n# OAS Recovery Tax (clawback)\nvariable oas_recovery_tax {\n  entity Person\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"OAS Recovery Tax\"\n  description \"Amount of OAS pension clawed back due to high income\"\n  reference \"ITA 180.2\"\n\n  formula {\n    let threshold = parameter(gov.servicecanada.oas.recovery_tax.threshold)\n    let rate = parameter(gov.servicecanada.oas.recovery_tax.rate)\n\n    if individual_net_income <= threshold then\n      return 0\n\n    let excess = individual_net_income - threshold\n    let clawback = excess * rate\n\n    # Cannot exceed gross OAS amount\n    let gross_annual = oas_gross_monthly * 12\n    return min(clawback, gross_annual)\n  }\n\n  default 0\n}\n\n# Net OAS monthly (after recovery tax)\nvariable oas_monthly {\n  entity Person\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"OAS Pension\"\n  description \"Monthly Old Age Security pension after recovery tax\"\n  reference \"OAS Act Section 3, ITA 180.2\"\n\n  formula {\n    let gross = oas_gross_monthly\n    let clawback_monthly = oas_recovery_tax / 12\n    return max(0, gross - clawback_monthly)\n  }\n\n  default 0\n}\n\n# Annual OAS amount\nvariable oas_annual {\n  entity Person\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"OAS Annual\"\n  description \"Annual Old Age Security pension\"\n  reference \"OAS Act Section 3\"\n\n  formula {\n    return oas_monthly * 12\n  }\n\n  default 0\n}\n\n# ==========================================================================\n# GUARANTEED INCOME SUPPLEMENT\n# ==========================================================================\n\n# GIS eligibility\nvariable is_gis_eligible {\n  entity Person\n  period Year\n  dtype Bool\n  label \"GIS Eligible\"\n  description \"Whether the person is eligible for the Guaranteed Income Supplement\"\n  reference \"OAS Act Section 12\"\n\n  formula {\n    # Must be receiving OAS\n    return is_oas_eligible and oas_gross_monthly > 0\n  }\n\n  default false\n}\n\n# Is single pensioner for GIS purposes\nvariable is_single_pensioner {\n  entity Person\n  period Year\n  dtype Bool\n  label \"Is Single Pensioner\"\n  description \"Whether the person is single, widowed, divorced, or separated for GIS\"\n  reference \"OAS Act Section 2 definitions\"\n\n  formula {\n    return not is_married_or_common_law\n  }\n\n  default false\n}\n\n# GIS income (excludes OAS, has employment exemptions)\nvariable gis_countable_income {\n  entity Person\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"GIS Countable Income\"\n  description \"Income used for GIS calculation (excludes OAS, applies employment exemptions)\"\n  reference \"OAS Regulations\"\n\n  formula {\n    let employment_exempt = parameter(gov.servicecanada.oas.gis.employment_income_exemption)\n    let employment_partial = parameter(gov.servicecanada.oas.gis.employment_income_partial_exemption)\n\n    # Start with net income excluding OAS\n    let base_income = individual_net_income - oas_annual\n\n    # Employment income exemptions\n    let employment_income = variable(employment_income)\n    let exempt = min(employment_income, employment_exempt)\n    let partial_exempt_eligible = min(max(0, employment_income - employment_exempt), employment_partial)\n    let partial_exempt = partial_exempt_eligible * 0.50\n\n    return max(0, base_income - exempt - partial_exempt)\n  }\n\n  default 0\n}\n\n# Maximum GIS monthly (depends on marital status)\nvariable gis_max_monthly {\n  entity Person\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"GIS Maximum Monthly\"\n  description \"Maximum monthly GIS based on marital/pension status\"\n  reference \"OAS Act Section 12\"\n\n  formula {\n    let max_single = parameter(gov.servicecanada.oas.gis.max_monthly_single)\n    let max_couple = parameter(gov.servicecanada.oas.gis.max_monthly_couple)\n\n    if is_single_pensioner then\n      return max_single\n    else if spouse_receives_oas then\n      return max_couple\n    else\n      # Spouse not receiving OAS - different rate applies\n      return max_single\n  }\n\n  default 0\n}\n\n# GIS reduction\nvariable gis_reduction {\n  entity Person\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"GIS Reduction\"\n  description \"Annual reduction in GIS based on income\"\n  reference \"OAS Act Section 12\"\n\n  formula {\n    let rate = parameter(gov.servicecanada.oas.gis.reduction_rate)\n    return gis_countable_income * rate\n  }\n\n  default 0\n}\n\n# GIS monthly amount\nvariable gis_monthly {\n  entity Person\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"Guaranteed Income Supplement\"\n  description \"Monthly Guaranteed Income Supplement payment\"\n  reference (\n    \"OAS Act Section 12\",\n    \"https://www.canada.ca/en/services/benefits/publicpensions/cpp/old-age-security/guaranteed-income-supplement.html\"\n  )\n\n  formula {\n    if not is_gis_eligible then\n      return 0\n\n    let max_monthly = gis_max_monthly\n    let reduction_monthly = gis_reduction / 12\n\n    return max(0, max_monthly - reduction_monthly)\n  }\n\n  default 0\n}\n\n# GIS annual amount\nvariable gis_annual {\n  entity Person\n  period Year\n  dtype Money\n  unit \"CAD\"\n  label \"GIS Annual\"\n  description \"Annual Guaranteed Income Supplement\"\n  reference \"OAS Act Section 12\"\n\n  formula {\n    return gis_monthly * 12\n  }\n\n  default 0\n}\n\n# ==========================================================================\n# ALLOWANCE\n# ==========================================================================\n\n# Allowance eligibility\nvariable is_allowance_eligible {\n  entity Person\n  period Year\n  dtype Bool\n  label \"Allowance Eligible\"\n  description \"Whether eligible for Allowance (spouse of OAS/GIS recipient aged 60-64)\"\n  reference \"OAS Act Section 19\"\n\n  formula {\n    let min_age = parameter(gov.servicecanada.oas.allowance.age_minimum)\n    let max_age = parameter(gov.servicecanada.oas.allowance.age_maximum)\n\n    return age >= min_age and age <= max_age and spouse_receives_oas and variable(spouse_receives_gis)\n  }\n\n  default false\n}\n\n# Allowance monthly amount\nvariable allowance_monthly {\n  entity Person\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"Allowance\"\n  description \"Monthly Allowance for spouse of OAS/GIS recipient\"\n  reference \"OAS Act Section 19\"\n\n  formula {\n    if not is_allowance_eligible then\n      return 0\n\n    let max_allowance = parameter(gov.servicecanada.oas.allowance.max_monthly)\n    # Similar income test to GIS applies\n    let reduction_rate = parameter(gov.servicecanada.oas.gis.reduction_rate)\n    let reduction = (combined_income * reduction_rate) / 12\n\n    return max(0, max_allowance - reduction)\n  }\n\n  default 0\n}\n\n# Survivor Allowance\nvariable survivor_allowance_monthly {\n  entity Person\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"Survivor Allowance\"\n  description \"Monthly Allowance for the Survivor (widowed persons aged 60-64)\"\n  reference \"OAS Act Section 21\"\n\n  formula {\n    let min_age = parameter(gov.servicecanada.oas.allowance.age_minimum)\n    let max_age = parameter(gov.servicecanada.oas.allowance.age_maximum)\n\n    if age < min_age or age > max_age then\n      return 0\n\n    if not variable(is_survivor) then\n      return 0\n\n    let max_survivor = parameter(gov.servicecanada.oas.allowance.survivor_max_monthly)\n    let reduction_rate = parameter(gov.servicecanada.oas.gis.reduction_rate)\n    let reduction = (gis_countable_income * reduction_rate) / 12\n\n    return max(0, max_survivor - reduction)\n  }\n\n  default 0\n}\n\n# ==========================================================================\n# TOTAL OAS BENEFITS\n# ==========================================================================\n\n# Total monthly OAS benefits\nvariable total_oas_benefits_monthly {\n  entity Person\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"Total OAS Benefits\"\n  description \"Total monthly Old Age Security program benefits (OAS + GIS + Allowance)\"\n  reference \"OAS Act\"\n\n  formula {\n    return oas_monthly + gis_monthly + allowance_monthly + survivor_allowance_monthly\n  }\n\n  default 0\n}",
      "path": "cosilico-ca/statute/OAS/oas.cosilico"
    },
    {
      "citation": "Ontario Works Act, 1997 - Ontario Works Benefit",
      "title": "Ontario Works Benefit",
      "text": "",
      "code": "variable household_size {\n  entity Household\n  period Month\n  dtype Count\n  label \"Household Size\"\n  description \"Total number of persons in the benefit unit\"\n  reference \"O. Reg. 134/98\"\n\n  formula {\n    return num_adults + num_children\n  }\n\n  default 1\n}\n\nvariable is_single {\n  entity Household\n  period Month\n  dtype Bool\n  label \"Is Single\"\n  description \"Whether the benefit unit is a single person without dependants\"\n  reference \"O. Reg. 134/98\"\n\n  formula {\n    return num_adults == 1 and num_children == 0\n  }\n\n  default false\n}\n\nvariable is_couple {\n  entity Household\n  period Month\n  dtype Bool\n  label \"Is Couple\"\n  description \"Whether the benefit unit is a couple without dependants\"\n  reference \"O. Reg. 134/98\"\n\n  formula {\n    return num_adults == 2 and num_children == 0\n  }\n\n  default false\n}\n\n# ==========================================================================\n# ASSET ELIGIBILITY\n# ==========================================================================\n\nvariable ow_asset_limit {\n  entity Household\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"OW Asset Limit\"\n  description \"Maximum liquid assets allowed for OW eligibility\"\n  reference \"O. Reg. 134/98, Section 39\"\n\n  formula {\n    let size = household_size\n\n    if size == 1 then\n      return parameter(gov.ontario.ow.asset_limit.single)\n    else if size == 2 and num_children == 0 then\n      return parameter(gov.ontario.ow.asset_limit.couple)\n    else\n      return parameter(gov.ontario.ow.asset_limit.family_3_plus)\n  }\n\n  default 10000\n}\n\nvariable is_ow_asset_eligible {\n  entity Household\n  period Month\n  dtype Bool\n  label \"OW Asset Eligible\"\n  description \"Whether assets are below the limit for OW eligibility\"\n  reference \"O. Reg. 134/98, Section 39\"\n\n  formula {\n    return liquid_assets <= ow_asset_limit\n  }\n\n  default true\n}\n\n# ==========================================================================\n# BASIC NEEDS CALCULATION\n# ==========================================================================\n\nvariable ow_basic_needs {\n  entity Household\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"OW Basic Needs\"\n  description \"Monthly basic needs allowance based on household composition\"\n  reference \"O. Reg. 134/98, Schedule 1\"\n\n  formula {\n    let p = parameter(gov.ontario.ow.basic_needs)\n\n    # Start with adult(s) base amount\n    if num_adults == 1 then\n      let base = p.single\n    else\n      let base = p.couple\n\n    # Add amounts for children\n    let child_amount = 0\n    let child_count = num_children\n\n    # First child gets higher amount\n    if child_count >= 1 then\n      let first_child_age = child_ages[0]\n      if first_child_age <= 12 then\n        child_amount = child_amount + p.first_child_0_12\n      else\n        child_amount = child_amount + p.first_child_13_17\n\n    # Additional children get lower amount\n    if child_count >= 2 then\n      for i in 1..(child_count - 1) do\n        let age = child_ages[i]\n        if age <= 12 then\n          child_amount = child_amount + p.additional_child_0_12\n        else\n          child_amount = child_amount + p.additional_child_13_17\n\n    return base + child_amount\n  }\n\n  default 390\n}\n\n# ==========================================================================\n# SHELTER CALCULATION\n# ==========================================================================\n\nvariable ow_max_shelter {\n  entity Household\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"OW Max Shelter\"\n  description \"Maximum shelter allowance based on household size\"\n  reference \"O. Reg. 134/98, Schedule 2\"\n\n  formula {\n    let size = household_size\n    let p = parameter(gov.ontario.ow.max_shelter)\n\n    match size {\n      case 1 => p.single\n      case 2 if num_children == 0 => p.couple\n      case 3 => p.family_3\n      case 4 => p.family_4\n      case 5 => p.family_5\n      else => p.family_6_plus\n    }\n  }\n\n  default 390\n}\n\nvariable ow_shelter {\n  entity Household\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"OW Shelter Allowance\"\n  description \"Actual shelter allowance (lesser of actual costs or maximum)\"\n  reference \"O. Reg. 134/98, Schedule 2\"\n\n  formula {\n    let max_shelter = ow_max_shelter\n    return min(shelter_costs, max_shelter)\n  }\n\n  default 0\n}\n\n# ==========================================================================\n# INCOME CALCULATION\n# ==========================================================================\n\nvariable ow_countable_employment_income {\n  entity Household\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"OW Countable Employment Income\"\n  description \"Employment income counted against OW after exemptions\"\n  reference \"O. Reg. 134/98, Section 49\"\n\n  formula {\n    let flat_exempt = parameter(gov.ontario.ow.earnings_exemption.flat_exemption)\n    let rate = parameter(gov.ontario.ow.earnings_exemption.rate)\n\n    # First $200 fully exempt, then 50% of remainder\n    let after_flat = max(0, employment_income - flat_exempt)\n    let countable = after_flat * (1 - rate)\n\n    return countable\n  }\n\n  default 0\n}\n\nvariable ow_total_countable_income {\n  entity Household\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"OW Total Countable Income\"\n  description \"Total income counted against OW benefits\"\n  reference \"O. Reg. 134/98\"\n\n  formula {\n    # Employment income has exemptions\n    let employment = ow_countable_employment_income\n\n    # Other income fully counted (no exemption)\n    let other = other_income\n\n    return employment + other\n  }\n\n  default 0\n}\n\n# ==========================================================================\n# TOTAL BENEFIT CALCULATION\n# ==========================================================================\n\nvariable ow_maximum_entitlement {\n  entity Household\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"OW Maximum Entitlement\"\n  description \"Maximum OW benefit before income deduction\"\n  reference \"O. Reg. 134/98\"\n\n  formula {\n    return ow_basic_needs + ow_shelter\n  }\n\n  default 0\n}\n\nvariable ow_remote_supplement {\n  entity Household\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"OW Remote Supplement\"\n  description \"Additional amount for remote community residents\"\n  reference \"O. Reg. 134/98\"\n\n  formula {\n    if not variable(is_remote_community) then\n      return 0\n\n    return parameter(gov.ontario.ow.remote_supplement.amount)\n  }\n\n  default 0\n}\n\nvariable ow_pregnancy_benefit {\n  entity Household\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"OW Pregnancy Benefit\"\n  description \"Additional nutritional benefit during pregnancy\"\n  reference \"O. Reg. 134/98\"\n\n  formula {\n    if not variable(is_pregnant) then\n      return 0\n\n    return parameter(gov.ontario.ow.pregnancy_benefit.amount)\n  }\n\n  default 0\n}\n\nvariable ow_total {\n  entity Household\n  period Month\n  dtype Money\n  unit \"CAD\"\n  label \"Ontario Works\"\n  description \"Total monthly Ontario Works benefit\"\n  reference (\n    \"Ontario Works Act, 1997\",\n    \"O. Reg. 134/98\",\n    \"https://www.ontario.ca/page/ontario-works\"\n  )\n\n  formula {\n    # Check asset eligibility first\n    if not is_ow_asset_eligible then\n      return 0\n\n    let maximum = ow_maximum_entitlement\n    let supplements = ow_remote_supplement + ow_pregnancy_benefit\n    let income = ow_total_countable_income\n\n    let benefit = max(0, maximum + supplements - income)\n    return benefit\n  }\n\n  defined_for {\n    # Only for Ontario residents\n    variable(province_of_residence) == \"ON\"\n  }\n\n  default 0\n}",
      "path": "cosilico-ca/statute/provincial/ON/ow/ontario_works.cosilico"
    },
    {
      "citation": "Title 7 - SNAP (Supplemental Nutrition Assistance Program)",
      "title": "SNAP (Supplemental Nutrition Assistance Program)",
      "text": "",
      "code": "variable snap:\n  entity: Household\n  period: Month\n  dtype: Money\n  unit: \"USD\"\n  label: \"SNAP Benefits\"\n  description: \"Monthly SNAP (food stamps) benefit amount\"\n  formula: return snap_allotment\n  default: 0",
      "path": "cosilico-us/statute/7/51.rac"
    }
  ]
}